
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Cœur en Action - Restos du cœur</title>

    <link href=/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css rel="stylesheet">
    <link href=/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css rel="stylesheet">

    <link href=/do-it/assets/stylesheets/main.css rel="stylesheet">
  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script type="text/javascript" id="MathJax-script" 
  src=/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1000px] mx-auto px-4">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/do-it/">Home</a>
          <a class="mx-2" href="/do-it/about">About</a>
        </div>
      </div>
    </header>

    <main class="max-w-[1000px] mx-auto px-4">

      
<article>
  <h1  class="mb-1">Cœur en Action - Restos du cœur</h1>
  <div class="mb-4">
    
      <div class=" px-4 flex items-center">
        
          <div class="font-bold">Tag : </div>
        
        <ul class="flex not-prose list-none my-0 last:after:content-['•'] last:after:px-1 mx-0 px-1">
          
            <li class="before:content-['•'] before:px-1">projet</li>
          
        </ul>
      </div>
    

    
      <div class=" px-4 flex items-center">
        
          <div class="font-bold">Auteurs : </div>
        
        <ul class="flex not-prose list-none my-0 last:after:content-['•'] last:after:px-1 mx-0 px-1">
          
            <li class="before:content-['•'] before:px-1">Killian ROYANT</li>
          
            <li class="before:content-['•'] before:px-1">Louise GACOIN</li>
          
            <li class="before:content-['•'] before:px-1">Ossama ABDANE</li>
          
            <li class="before:content-['•'] before:px-1">Sarah HONORÉ</li>
          
        </ul>
      </div>
    
  </div>

  

  <!-- début résumé -->
<p>Le projet est réalisé avec le centre des <strong>Restos du Cœur</strong> de la rue Granoux à Marseille, <strong>4 étudiants</strong> du parcours DO-IT. Laetitia Piet encadre ce projet. Ce projet est en collaboration avec le centre des restos du cœur des 4° et 5° arrondissements de Marseille. Notre <strong>objectif</strong> est d’<strong>optimiser et de simplifier certaines tâches des bénévoles du centre</strong>.</p>
<!-- fin résumé -->
<h2>Nos immersions</h2>
<p>Afin de <strong>mieux comprendre les bénévoles et leur environnement</strong>, nous avons participé à leurs tâches quotidiennes lors de différentes <strong>immersions</strong>.</p>
<p><img src="./photos/legumes.jpg" alt="legumes"></p>
<p>Parmi ces immersions, on retrouve :</p>
<ul>
<li>Une immersion lors des distributions</li>
<li>Une immersion lors des inscriptions</li>
<li>Une immersion lors de la réception des denrées alimentaires</li>
<li>Des interviews de 3 bénévoles</li>
<li>Un atelier créatif avec des bénévoles</li>
</ul>
<h2>Nos solutions</h2>
<p>Nous avons identifié <strong>3 problèmes</strong> et avons proposé des solutions pour chacun d’entre eux.</p>
<h3>Problème 1 : Les inscriptions</h3>
<p>Avant chaque période de distribution (deux fois par an), une phase d’inscription des bénéficiaires a lieu.</p>
<p><strong>Problème identifié :</strong> Il faut remplir manuellement une fiche d’inscription pour chaque famille bénéficiaire. Cela rend le processus long et fastidieux.</p>
<p><strong>Notre solution :</strong> numériser la phase d’inscription en automatisant le remplissage de ce document.</p>
<h3>Problème 2 : Le calendrier des bénévoles</h3>
<p>Chaque semaine, des bénévoles sont présents pour <strong>distribuer les denrées alimentaires</strong> aux familles bénéficiaires. Actuellement, ces bénévoles viennent <strong>sans prévenir</strong> quand ils sont disponibles.</p>
<p><img src="./photos/surgeles.jpg" alt="surgeles"></p>
<p><strong>Problèmes identifiés :</strong></p>
<ul>
<li>Il est difficile de savoir quel bénévole sera présent les jours de distribution.</li>
<li>Trop de bénévoles sont présents le vendredi</li>
<li>Il manque des bénévoles le jeudi</li>
</ul>
<p><strong>Notre solution :</strong> créer un calendrier des bénévoles pour faciliter la gestion des bénévoles.</p>
<h3>Problème 3 : La répartition des denrées alimentaires</h3>
<p>Après chaque livraison de denrées alimentaires, il faut <strong>répartir les denrées entre les différentes familles</strong>. Actuellement, la responsable de centre fait les calculs <strong>à la main</strong>.</p>
<p><img src="./photos/conserves.jpg" alt="conserves"></p>
<p><strong>Problèmes identifiés :</strong></p>
<ul>
<li>Les familles qui viennent en début et en fin de distribution n’ont pas la même quantité de nourriture</li>
<li>Les bénévoles ne font pas confiance aux calculs de la responsable de centre</li>
</ul>
<p><strong>Notre solution :</strong> automatiser le répartition alimentaire en fonction des stocks et de paramètres spécifiques.</p>
<h2>Notre poster</h2>
<p>Afin de présenter notre projet, nous avons réalisé un poster.</p>
<p><img src="./photos/poster.png" alt="poster"></p>
<h2>Nos résultats</h2>
<p>Nous avons donc essayé de développer et mettre en place nos différentes solutions. On va détailler ci-dessous la démarche et les résultats obtenu.</p>
<h3><strong>Problème 1 : Les inscriptions</strong></h3>
<p>Avant chaque période de distribution (deux fois par an), une phase d’inscription des bénéficiaires a lieu. Il fallait remplir manuellement une fiche d’inscription pour chaque famille bénéficiaire ce qui rendait le processus long et fastidieux.</p>
<p><img src="./photos/inscriptions1.png" alt="Feuille de template d'inscription"></p>
<p>Néanmoins, toutes les informations necessaires au remplissage de ces fiches était déjà renseigné sur le logiciel interne des restos du cœur. Nous avons ainsi réfléchis à une solution permettant d’automatiser le remplissage des fiches d’inscription aux campagnes des bénéficiaires.</p>
<p>Pour cela, nous avons travaillé via Excel et une macro codée en VBA. La macro utilise un fichier Excel contenant une feuille de template à remplir, une feuille de mode d'emploi avec un bouton pour lancer la macro, et une feuille Data qui définit les portions à distribuer en fonction du nombre de personnes. La macro demande à l'utilisateur de sélectionner les fichiers Excel des familles et des personnes, et permet de générer automatiquement les fiches d'inscription pour chaque famille bénéficiaire.</p>
<p><img src="./photos/inscriptions2.png" alt="Interface du Excel"></p>
<p>Voici le code de la macro développée :</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
</svg>
<div class="pl-8 font-bold inline-block">
<p>Code de la macro</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg"  fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
</svg>
</summary>
<div class="mx-8 pb-2">
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">Sub</span> GenererFeuilles<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> wbFamilles <span class="token keyword">As</span> Workbook<span class="token punctuation">,</span> wbPersonnes <span class="token keyword">As</span> Workbook
    <span class="token keyword">Dim</span> numCarteMin <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> wsTemplate <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> wsTemplateTemp <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> wsFiches <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> wsData <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> famille <span class="token keyword">As</span> Range

    <span class="token keyword">Dim</span> familleFile <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> personnesFile <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> fd <span class="token keyword">As</span> FileDialog

    <span class="token keyword">Set</span> fd <span class="token operator">=</span> Application<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>msoFileDialogFilePicker<span class="token punctuation">)</span>
    fd<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">"Sélectionner le fichier Excel des familles"</span>
    fd<span class="token punctuation">.</span>Filters<span class="token punctuation">.</span>Clear
    fd<span class="token punctuation">.</span>Filters<span class="token punctuation">.</span>Add <span class="token string">"Fichiers Excel"</span><span class="token punctuation">,</span> <span class="token string">"*.xlsx"</span>
    fd<span class="token punctuation">.</span>AllowMultiSelect <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">If</span> fd<span class="token punctuation">.</span>Show <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">Then</span>
        familleFile <span class="token operator">=</span> fd<span class="token punctuation">.</span>SelectedItems<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">Else</span>
        MsgBox <span class="token string">"La sélection de fichier a été annulée. Veuillez sélectionner un fichier Excel à traiter."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

        <span class="token keyword">Set</span> fd <span class="token operator">=</span> Application<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>msoFileDialogFilePicker<span class="token punctuation">)</span>
    fd<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">"Sélectionner le fichier Excel des personnes"</span>
    fd<span class="token punctuation">.</span>Filters<span class="token punctuation">.</span>Clear
    fd<span class="token punctuation">.</span>Filters<span class="token punctuation">.</span>Add <span class="token string">"Fichiers Excel"</span><span class="token punctuation">,</span> <span class="token string">"*.xlsx"</span>
    fd<span class="token punctuation">.</span>AllowMultiSelect <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">If</span> fd<span class="token punctuation">.</span>Show <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">Then</span>
        personnesFile <span class="token operator">=</span> fd<span class="token punctuation">.</span>SelectedItems<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">Else</span>
        MsgBox <span class="token string">"La sélection de fichier a été annulée. Veuillez sélectionner un fichier Excel à traiter."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    <span class="token comment">' Vérification de la sélection des fichiers Excel</span>
    <span class="token keyword">If</span> familleFile <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token keyword">Or</span> personnesFile <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token keyword">Then</span>
        MsgBox <span class="token string">"Veuillez sélectionner les fichiers Excel à traiter."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    <span class="token keyword">Set</span> wbFamilles <span class="token operator">=</span> Workbooks<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>familleFile<span class="token punctuation">)</span>
    <span class="token keyword">Set</span> wbPersonnes <span class="token operator">=</span> Workbooks<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>personnesFile<span class="token punctuation">)</span>

    <span class="token comment">' Vérification des fichiers Excel</span>
    <span class="token keyword">If</span> wbPersonnes<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"Q1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">></span> <span class="token string">"Contact"</span> <span class="token keyword">Or</span> wbFamilles<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"U1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">></span> <span class="token string">"Derniere Activite"</span> <span class="token keyword">Then</span>
        MsgBox <span class="token string">"Veuillez vérifier les fichiers Excel sélectionnés."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    <span class="token comment">'numCarteMin = 0</span>
    numInput <span class="token operator">=</span> InputBox<span class="token punctuation">(</span><span class="token string">"Indiquer le numéro de la premire carte à traiter"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">Do</span> <span class="token keyword">While</span> <span class="token keyword">Not</span> IsNumeric<span class="token punctuation">(</span>numInput<span class="token punctuation">)</span>
        numInput <span class="token operator">=</span> InputBox<span class="token punctuation">(</span><span class="token string">"Entrez un nombre valide. Indiquer le numéro de la premire carte à traiter : "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">If</span> numInput <span class="token operator">=</span> <span class="token string">""</span> <span class="token keyword">Then</span>
            <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Loop</span>
    numCarteMin <span class="token operator">=</span> numInput
    <span class="token keyword">Set</span> wsTemplate <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">"Template"</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> wsTemplateTemp <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">"Temp"</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> wsFiches <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">"Fiches"</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> wsData <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">"Data"</span><span class="token punctuation">)</span>

    <span class="token comment">' Suppression du contenu des feuilles TemplateTemp et Fiches</span>
    wsTemplateTemp<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"1:"</span> <span class="token operator">&amp;</span> wsTemplateTemp<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlUp
    wsFiches<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"1:"</span> <span class="token operator">&amp;</span> wsFiches<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlUp
    
    wsTemplate<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"30:30"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Copy
    wsFiches<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"1:1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PasteSpecial Paste<span class="token punctuation">:</span><span class="token operator">=</span>xlPasteColumnWidths<span class="token punctuation">,</span> Operation<span class="token punctuation">:</span><span class="token operator">=</span>xlNone<span class="token punctuation">,</span> <span class="token operator">_</span>
        SkipBlanks<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> Transpose<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>

    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> famille <span class="token keyword">In</span> wbFamilles<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A2"</span><span class="token punctuation">,</span> wbFamilles<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A"</span> <span class="token operator">&amp;</span> wbFamilles<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">If</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">></span><span class="token operator">=</span> numCarteMin <span class="token keyword">Then</span>
            
            <span class="token comment">' Copie du template</span>
            wsTemplate<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"1:28"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Copy
            ThisWorkbook<span class="token punctuation">.</span>Activate
            Sheets<span class="token punctuation">(</span><span class="token string">"Temp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
            Rows<span class="token punctuation">(</span><span class="token string">"1:1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
            Selection<span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlDown
            Selection<span class="token punctuation">.</span>PasteSpecial Paste<span class="token punctuation">:</span><span class="token operator">=</span>xlPasteColumnWidths<span class="token punctuation">,</span> Operation<span class="token punctuation">:</span><span class="token operator">=</span>xlNone<span class="token punctuation">,</span> <span class="token operator">_</span>
                SkipBlanks<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> Transpose<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>

            <span class="token keyword">If</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">+</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">+</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">Then</span>
                BoucleBabies famille<span class="token punctuation">,</span> wbPersonnes<span class="token punctuation">,</span> wsTemplateTemp
            <span class="token keyword">End</span> <span class="token keyword">If</span>

            CopieInfos famille<span class="token punctuation">,</span> wsTemplateTemp
            AjoutPortions famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">,</span> wsTemplateTemp<span class="token punctuation">,</span> wsData

            <span class="token comment">' Coupe du template rempli</span>
            wsTemplateTemp<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">"1:28"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Cut

            <span class="token comment">' Collage à la suite des autres feuilles</span>
            wsFiches<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">28</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token string">":"</span> <span class="token operator">&amp;</span> i <span class="token operator">*</span> <span class="token number">28</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlDown
            i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> famille

    wbFamilles<span class="token punctuation">.</span>Close SaveChanges<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>
    wbPersonnes<span class="token punctuation">.</span>Close SaveChanges<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>

    <span class="token comment">' Ouvrir la fentre d'impression pour imprimer les pages généréess</span>
    wsFiches<span class="token punctuation">.</span>Activate
    Application<span class="token punctuation">.</span>Dialogs<span class="token punctuation">(</span>xlDialogPrint<span class="token punctuation">)</span><span class="token punctuation">.</span>Show
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> BoucleBabies<span class="token punctuation">(</span>famille <span class="token keyword">As</span> Range<span class="token punctuation">,</span> wbPersonnes <span class="token keyword">As</span> Workbook<span class="token punctuation">,</span> wsTemplateTemp <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> nbBabies <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> person <span class="token keyword">As</span> Range

    nbBabies <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> person <span class="token keyword">In</span> wbPersonnes<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A2"</span><span class="token punctuation">,</span> wbPersonnes<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A"</span> <span class="token operator">&amp;</span> wbPersonnes<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">If</span> person<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token keyword">And</span> person<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">=</span> <span class="token number">18</span> <span class="token keyword">Then</span>
            <span class="token keyword">If</span> nbBabies <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"R3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> person<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">ElseIf</span> nbBabies <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"Z3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> person<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">ElseIf</span> nbBabies <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
                wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"AH3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> person<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">End</span> <span class="token keyword">If</span>
            nbBabies <span class="token operator">=</span> nbBabies <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">If</span> nbBabies <span class="token operator">></span> <span class="token number">2</span> <span class="token keyword">Then</span>
                <span class="token keyword">Exit</span> <span class="token keyword">For</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> person

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> CopieInfos<span class="token punctuation">(</span>famille <span class="token keyword">As</span> Range<span class="token punctuation">,</span> wsTemplateTemp <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span>

    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"AD1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Value <span class="token comment">' Campagne</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"G2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token comment">' Nom</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"AB2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token comment">' Prénom</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"B3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token comment">' Numéro de carte</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"L4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token comment">' Nb de personnes à servir</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"L5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Max<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">' Nombre de points</span>
    wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"AF4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Famille de "</span> <span class="token operator">&amp;</span> famille<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&amp;</span> <span class="token string">" personnes"</span> <span class="token comment">' 'Famille de {nb de personnes} personnes'</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> AjoutPortions<span class="token punctuation">(</span>nbPersonnes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> wsTemplateTemp <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> wsData <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> product <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> nbPortions <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> startCell <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    
    <span class="token keyword">If</span> nbPersonnes <span class="token operator">></span> <span class="token number">6</span> <span class="token keyword">Then</span> nbPersonnes <span class="token operator">=</span> <span class="token number">6</span>

    <span class="token keyword">For</span> <span class="token keyword">Each</span> product <span class="token keyword">In</span> wsData<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A2"</span><span class="token punctuation">,</span> wsData<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A"</span> <span class="token operator">&amp;</span> wsData<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        nbPortions <span class="token operator">=</span> product<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nbPersonnes<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">Set</span> startCell <span class="token operator">=</span> wsTemplateTemp<span class="token punctuation">.</span>Range<span class="token punctuation">(</span>product<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span>
        startCell<span class="token punctuation">.</span>Value <span class="token operator">=</span> nbPortions
        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> nbPortions
            startCell<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>LineStyle <span class="token operator">=</span> xlContinuous
        <span class="token keyword">Next</span> i
    <span class="token keyword">Next</span> product

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre>
</div>
</details>     
</div>
<p>La macro importe les fichiers Excel des familles et des personnes, recherche les bénéficiaires, récupère les informations relatives aux dates de naissance des bébés, remplit les fiches d'inscription, ajoute les données relatives aux nombre de portions, copie le template et ouvre la page d'impression pour imprimer les fiches générées.</p>
<p><img src="./photos/inscriptions3.png" alt="Interface de sortie"></p>
<p>Cela permet aux bénévoles de gagner du temps et de réduire le risque d'erreurs lors du remplissage des fiches d'inscription. Cette solution a donc permis de résoudre efficacement le problème d'inscription pour les Restos du Cœur.</p>
<p><strong>Avantages</strong></p>
<p>Les bénévoles n'ont plus besoin de remplir manuellement les fiches d'inscription pour chaque famille bénéficiaire, ce qui leur fait gagner un temps considérable. De plus, l'automatisation de ce processus permet de réduire le risque d'erreurs lors du remplissage des fiches d'inscription.</p>
<p><strong>Difficultés rencontrées</strong></p>
<p>Comme on peut le voir dans le code fourni, la solution pour numériser la phase d'inscription a nécessité une expertise technique assez avancée en VBA (Visual Basic for Applications), ainsi que la création d'un fichier Excel contenant une feuille de template à remplir, une feuille de mode d'emploi avec un bouton pour lancer la macro, et une feuille Data qui définit les portions à distribuer en fonction du nombre de personnes.</p>
<p>La création de cette macro a donc été assez complexe et demande une connaissance approfondie du langage VBA. De plus, cette solution n'est pas compatible avec les ordinateurs Mac, car la macro utilise des fonctionnalités spécifiques à Excel pour Windows.</p>
<p>Malgré ces difficultés, la solution mise en place a permis de résoudre efficacement le problème d'inscription et a apporté un gain de temps considérable aux bénévoles, ainsi qu'une réduction du risque d'erreurs lors du remplissage des fiches d'inscription.</p>
<h3>Problème 2 : Le calendrier des bénévoles</h3>
<p>Au sein de l'association, il était difficile de suivre la présence des bénévoles lors des jours de distribution, faute de planning. C'est alors que nous avons proposé une solution pratique et simple : Framadate. Il s'agit d'un calendrier en ligne, facile à créer et à compléter par tous les bénévoles, quel que soit leur âge. Cette application offre de nombreux avantages :</p>
<ul>
<li><strong>Gratuit et open source</strong> : Framadate est un logiciel libre et gratuit.</li>
<li><strong>Facilité d'utilisation</strong> : L'interface de Framadate est simple et intuitive.</li>
<li><strong>Accessibilité</strong> : Framadate est accessible depuis n'importe quel navigateur web, sans qu'il soit nécessaire de télécharger ou d'installer un logiciel supplémentaire.</li>
<li><strong>Inscription non obligatoire</strong> : Les utilisateurs peuvent créer et participer à des sondages sans avoir besoin de s'inscrire ou de créer un compte utilisateur.</li>
<li><strong>Flexibilité</strong> : Il est possible de modifier ses réponses à tout instant</li>
<li>On peut indiquer les <strong>disponibilités d'autres bénévoles</strong> : ceux qui ne disposent pas de smartphone par exemple.</li>
<li>Vision sur le long terme : possibilité de générer un fichier mensuellement.</li>
</ul>
<p>Problèmes rencontrés :</p>
<ul>
<li>Beaucoup d'application de planning disponible</li>
<li>Réticence des bénévoles vis à vis la technologie</li>
<li></li>
</ul>
<h3>Problème 3 : Solution de distribution</h3>
<p>Pour aider la responsable de centre à faire sa distribution, nous avions besoin d’un outil simple d'utilisation et quasi incassable.</p>
<p>Voici le résultat:</p>
<p>(mettre imgs)</p>
<p>C’est un classeur Excel composés de 5 feuilles :</p>
<ul>
<li>Une feuille pour mettre à jour le nombre de bénéficiaires à servir, en fonction des familles présentes la semaine passées</li>
<li>Une feuille permettant de mettre à jour le stock</li>
<li>Deux feuilles de calculs, donnant chacune un répartition différente</li>
<li>Une feuille permettant de générer les fiches qui sont imprimées chaque semaine et qui guident les bénévoles pour la distribution. Cette feuille fonctionne avec une macro</li>
</ul>
<p>Les 2 méthodes de calculs:</p>
<p>La première fait une répartition strictement équitable par personne (on divise le nombre d’unité par personne et on donne le même nombre d’aliments pour chaque personne, on a alors beaucoup de restes). La seconde méthode minimise les stocks restants en  donnant plus de denrées aux familles les plus nombreuses.</p>
<p>Avantages:</p>
<ul>
<li>Document qui suit les étapes logiques d’une semaine de travail au resto du coeur, simplifié au maximum</li>
<li>L’utilisateur n’a besoin de rentrer que des informations dans les  feuilles “data_bénéficiares” et “data_stock”. Tout le reste se remplit automatiquement évitant les répétitions.</li>
<li>Les cellules contenant les calculs sont uniquement présentes dans les feuilles de répartition et sont verrouillées.</li>
</ul>
<p>Problèmes rencontrés:</p>
<ul>
<li>Le choix d’une méthode de calcul s’est avéré difficile. Aucune des méthodes que nous avons testées n’est parfaite.</li>
<li>Aussi, il faut conserver un regard critique sur ces calculs car notre Excel ne prend pas en compte les spécificités individuelles de chaque produit. La responsable est libre de modifier les chiffres de la répartition et nous avons constaté qu’elle le fait quasiment systématiquement. On peut penser qu’un bénévole nouveau venu ne pourrait pas effectuer une distribution efficace rien qu’avec notre outil. (Notre outil fonctionne bien pour les bénévoles expérimentés mais reste discutable pour les autres)</li>
<li>La prise en main peut paraître compliquée car remplir la liste du stock prend du temps. Pour fluidifier cela nous avons effectué 3 répartitions avec la responsable, en l’accompagnant sur l’outil</li>
</ul>


</article>

    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1000px] mx-auto px-4">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            do-it : option de troisième année à l'école centrale Marseille
          </p>
        </div>
      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>
