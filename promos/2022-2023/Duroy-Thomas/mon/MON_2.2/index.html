
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MON 2.2 : Back-end avec Node.js et Express</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">MON 2.2 : Back-end avec Node.js et Express</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2022-2023</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 2</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">back</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Express</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Thomas Duroy</li>
                
            </ul>
        </div>
    

    
</div>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2022-2023/">2022-2023</a><span class="px-1">/</span><a href="/do-it/promos/2022-2023/Duroy-Thomas/">Thomas Duroy</a><span class="px-1">/</span><a href="/do-it/promos/2022-2023/Duroy-Thomas/mon/">MON de Thomas </a><span class="px-1">/</span><a href="/do-it/promos/2022-2023/Duroy-Thomas/mon/MON_2.2/">MON 2.2 : Back-end avec Node.js et Express</a>

</div></div>




<p>Durant ce MON, j'ai pu en apprendre davantage sur le back-end. Dans un premier temps, j'ai appris ce qu'était Node.js, son architecture et son fonctionnement.</p>
<p>Puis je me suis initié au codage d'une API RESTful basique en suivant les tutoriels de <a href="https://www.youtube.com/@programmingwithmosh">Programming with Mosh</a>.</p>
<p>Enfin, j'ai complété une <a href="https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/6466206-configurez-votre-environnement-de-developpement">openclassroom</a> où le but était de développer un middleware plus complexe en y connectant une base de données.</p>
<h2>Qu'est ce que le back-end ?</h2>
<p>Le back-end est la partie invisible de l'iceberg. Concrètement, il s'agit de l'ensemble des rouages côté serveur permettant de faire fonctionner un site web quand le client envoie une requête.</p>
<p><img src="back-end%20illustration.jpg" alt="Back-end illustration"></p>
<p>Pour s'occuper de toute ces taches, il nous faut donc un serveur. Ce sera le rôle de Node.js que d'utiliser notre machine comme support pour lancer un serveur local.</p>
<h2>Qu'est ce que Node.js ?</h2>
<h3>Description et utilisation de Node.js</h3>
<p>Node.js est un environnement d'exécution basé sur le même moteur javascript que Google à savoir &quot;V8&quot;.</p>
<p>Il fonctionne de manière asynchrone. C'est-à-dire qu'il envoie au moteur les commandes à exécuter  en permanence sans attendre que ce dernier ait terminé la commande précédente pour s'attaquer à la suivante. Cela lui permet de fonctionner de manière fluide et d'enchaîner les commandes peu voraces, parfait pour du dev web.</p>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Attention, il est nécessaire de <a href="https://nodejs.org/en/download/">télécharger</a> Node.js pour pouvoir l'utiliser !</p>
</div></div>
<p>Pour utiliser Node.js, il faut d'abord initialiser un projet node. Pour ce faire, avec un powershell/une interface de commande, il faut se rendre dans le dossier de votre projet puis lancer la commande:</p>
<pre class="language-powershell " style="counter-reset: linenumber 0"><code class="language-powershell">npm init
</code></pre>
<p>De nombreux paramètres seront réglables. Faîtes simplement attention à nommer (server.js par exemple) comme vous le désirez votre point d'accès serveur (entry pont).</p>
<p>Puis vous pouvez démarrer votre serveur avec la commande suivante (on conserve le nom server.js pour l'exemple mais il faudra prendre le nom de votre point d'accès).</p>
<pre class="language-powershell " style="counter-reset: linenumber 0"><code class="language-powershell">nodejs server<span class="token punctuation">.</span>js
</code></pre>
<p>Bon, on n'a pas vraiment créé de serveur, parce que Node.js se contente de lire le contenu de &quot;server.js&quot;. Cette fonctionnalité se trouve dans le module http.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Un outil précieux: <a href="https://www.npmjs.com/package/nodemon">Nodemon</a> permet aux changements apportés à votre fichier js de s'afficher directement, sans avoir à redémarrer votre serveur à chaque fois.</p>
</div></div>
<p>Pour une explication plus détaillée : <a href="https://www.youtube.com/watch?v=TlB_eWDSMt4&amp;ab_channel=ProgrammingwithMosh">l'avis de l'expert</a>.</p>
<h3>Les modules de Node.js</h3>
<p>À l'instar des librairies python, les modules sont des éléments js avec de nombreuses fonctionnalités que l'on peut importer avec la commande require:</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Les <a href="https://www.w3schools.com/nodejs/nodejs_modules.asp">basiques</a> sont: &quot;http&quot; pour s'occuper de tout ce qui est création et communication avec un serveur, &quot;File System&quot; pour manipuler fichier et dossiers, &quot;URL&quot; pour manipuler des URL ou bien &quot;Event&quot; pour ajouter de l'intéractivité à son js.</p>
<p>Mais les modules peuvent très bien être votre propre fichier js. C'est d'ailleurs la base des API. Dans ce cas, dans &quot;require&quot; on remplacera le nom du module par sa localisation sur votre machine.</p>
<p>À des niveaux plus complexes, nous avons les package et les framework (dont Express fait partie) qui sont installés et géré par le &quot;Node Package Manager&quot; (npm). L'installation se fait dans le powershell comme suit:</p>
<pre class="language-powershell " style="counter-reset: linenumber 0"><code class="language-powershell">npm i nom_package
</code></pre>
<p>Pour revenir à l'histoire du serveur, en utilisant le package http, il suffit d'écrire dans notre fichier js la chose suivante :</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>3 choses à retenir ici :</p>
<ul>
<li>Un serveur prend en charge deux éléments: la requête (req) et la réponse (res).</li>
<li>Des messages et des status (ex: erreur code 404) sont usuellements intégrés à la réponse pour des soucis de compréhension.</li>
<li>On définit un port d'écoute pour le serveur. Ici le port 3000. Pour y accéder, il suffit de taper &quot;<a href="http://localhost:3000">http://localhost:3000</a>&quot; dans son navigateur.</li>
</ul>
<p>Cette structure étant simpliste. Elle n'est jamais réellement utilisée. On préférera créer le serveur à partir d'un autre fichier js qui sera l'application s'occupant du routage et des requêtes.</p>
<p>Une implémentation plus complexe que l'on verra est celle de l'API RESTful. On la mettra en place grâce au framework &quot;Express&quot;</p>
<h2>Express et RESTful API</h2>
<p>Express est un framework de Node.js donnant accès à de nombreuses fonctionnalités pour développer une appli web. Un avantage majeur est qu'il permet de structurer le routage et donc de s'affranchir des inconvénients de tester les routes.</p>
<p>Pour l'utiliser:</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Où &quot;app&quot; sera notre application à laquelle on va ajouter des fonctionnalités REST.</p>
<p>Une API RESTful (REpresentative State Transfer) est une application mettant en pratique la logique CRUD (Create Read Updata Delete) d'une base de donnée à travers 4 méthodes fondamentales: get/post/put/delete.</p>
<p>Un outil intéressant pour tester si les fonctions marchents correctement est l'application google &quot;Postman&quot; permettant de créer des requêtes HTTP à destination de son serveur.</p>
<p>Par la suite, je vais vous montrer une API &quot;répertoire&quot; qui s'occuper de données avec le schéma suivant:</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> répertoire <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Thomas'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Duroy'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Mama'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Dize'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Nutse'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3>Fonction GET et exemple</h3>
<p>La fonction GET est la plus basique. Elle permet d'avoir accès à n'importe quel URL définit dans le routage et d'y consulter les éléments.</p>
<p>Ici, deux exemples:</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/repertoire'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=></span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>répertoire<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/repertoire/:id'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">//Vérifier que la personne existe</span>
    <span class="token keyword">const</span> personne <span class="token operator">=</span> répertoire<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=></span> p<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>personne<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"La personne n'existe pas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Remarques:
- Une fonction REST prend 2 arguments, la route et le binôme requête/réponse.
- Si dans la route, un élément est précédé de &quot;:&quot; alors il est utilisable dans la fonction avec l'appel &quot;params.élément&quot;.</p>
<h3>Fonction POST et exemple</h3>
<p>POST permet de créer une nouvelle entité, qui sera réutilisable pour le routage.</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/repertoire'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=></span><span class="token punctuation">{</span>
    <span class="token comment">//checker si la requête est valide</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>prénom <span class="token operator">||</span> <span class="token operator">!</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>nom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Incomplete input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ajouter la nouvelle personne</span>
    <span class="token keyword">const</span> personne <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> répertoire<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">prénom</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>prénom<span class="token punctuation">,</span>
        <span class="token literal-property property">nom</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>nom
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    répertoire<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3>Fonction PUT et exemple</h3>
<p>La fonction PUT permet de mettre à jour un item (à condition qu'il soit présent) ou de le créer s'il est absent. Ici j'ai voulu faire la distinction entre post et put en testant l'existance.</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> répertoire <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Thomas'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Duroy'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Mama'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token literal-property property">prénom</span><span class="token operator">:</span> <span class="token string">'Dize'</span><span class="token punctuation">,</span> <span class="token literal-property property">nom</span><span class="token operator">:</span> <span class="token string">'Nutse'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/api/répertoire/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span>
    <span class="token comment">//Vérifier que la personne existe</span>
    <span class="token keyword">const</span> personne <span class="token operator">=</span> répertoire<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=></span> p<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>personne<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"La personne n'existe pas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//checker si la requête est valide</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>prénom <span class="token operator">||</span> <span class="token operator">!</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>nom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Incomplete input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    personne<span class="token punctuation">.</span>prénom <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>prénom<span class="token punctuation">;</span>
    personne<span class="token punctuation">.</span>nom <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>nom<span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3>Fonction DELETE et exemple</h3>
<p>DELETE est assez évocateur comme nom.</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/api/repertoire/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">//Vérifier que la personne existe</span>
    <span class="token keyword">const</span> personne <span class="token operator">=</span> répertoire<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=></span> p<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>personne<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"La personne n'existe pas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Supprimer la personne</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> répertoire<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    répertoire<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>personne<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3>Créer un serveur avec Express</h3>
<p>L'avantage d'Express est qu'il utilise les fonctionnalités de HTTP d'où le fait de pouvoir créer le server directement:</p>
<pre class="language-js " style="counter-reset: linenumber 0"><code class="language-js"><span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span> <span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">listening on port 3000</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Il suffit alors de lire avec Node.js le fichier de l'application directement.</p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
