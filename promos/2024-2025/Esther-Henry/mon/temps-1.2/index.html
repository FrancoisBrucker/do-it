
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Python pour l’Analyse de Données Textuelles - Partie 2 : Analyser</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Python pour l’Analyse de Données Textuelles - Partie 2 : Analyser</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 1</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">“vert”</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">”python”</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Esther Henry</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Ce MON fait suite au MON1.1, son objectif est donc de continuer l’apprentissage de python pour les SHS et de passer cette fois à l’étape de manipulation de données, et de traiter un exemple simple d’analyse de données textuelles avec python.

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Esther-Henry/">Esther Henry</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Esther-Henry/mon/">MON de Esther Henry</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Esther-Henry/mon/temps-1.2/">Python pour l’Analyse de Données Textuelles - Partie 2 : Analyser</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mr-8">
<p>Maîtriser les bases de python et l’utilisation des bibliothèques (ou lire mon MON 1.1).</p>
</div></div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<p><a href="https://francoisbrucker.github.io/do-it/promos/2024-2025/Esther-Henry/mon/temps-1.1/">Mon MON 1.1</a></p>
</div></div>

<h2>Objectifs</h2>
<ol>
<li>Apprendre les bases de l’analyse de données sous Python</li>
<li>Apprendre les fonctions de base spécifiques à l’analyse de données textuelles</li>
<li>Réaliser une analyse de données textuelles pour pratiquer sur un exemple</li>
</ol>
<h2>Introduction</h2>
<p>Python est de plus en plus utilisé en sciences humaines et sociales pour son efficacité dans le traitement et l'analyse de données massives et variées. Grâce à ses nombreuses bibliothèques dédiées à l'analyse textuelle, il permet d'extraire des informations pertinentes de grands corpus de textes, d'automatiser des tâches répétitives, et de visualiser des données de manière claire et compréhensible. Sa simplicité de syntaxe et sa large communauté d'utilisateurs en font un outil accessible, même pour les chercheurs n'ayant pas de formation technique poussée, tout en offrant une grande flexibilité pour mener des analyses complexes. C'est donc un langage idéal pour se former à l'analyse de données textuelles, ce qui sera à terme le but de ces MON.</p>
<h2>Manipuler des données</h2>
<h3>Manipuler des données : pourquoi ?</h3>
<p>L’objectif est d’être capable de créer un script afin de passer de données brutes (que l’on a, par exemple, appris à récupérer en ligne dans le MON1.1) à des données utilisables. Il s’agit donc de pouvoir <strong>ouvrir</strong> un fichier, <strong>lire</strong> les informations qu’il contient, les mettre dans un <strong>format</strong> adapté à la <strong>visualisation</strong> et à la <strong>modification</strong>, puis de les <strong>sauvegarder</strong> dans un fichier plus facile à utiliser.</p>
<h3>Catégories de données</h3>
<p>Il existe deux catégories de données dans un programme :</p>
<ul>
<li><strong>Données externes</strong> : celles qui nous intéressent et que nous voulons traiter</li>
<li><strong>Données internes</strong> : celles nécessaires au bon fonctionnement du programme</li>
</ul>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Lorsque l’on manipule des données, il peut être tentant d’effectuer des modifications à la main sur les données brutes. Cependant, cela est fortement déconseillé ; il est préférable de le faire directement dans le code, car cela permet :</p>
<ul>
<li>De garder une trace des modifications effectuées</li>
<li>Si les données d’entrée changent, il n’y aura pas besoin de tout refaire</li>
</ul>
</div></div>
<h3>Charger et sauvegarder un fichier</h3>
<p>Avant de pouvoir manipuler les données, il est essentiel de savoir accéder aux fichiers contenus dans votre ordinateur, afin que votre code puisse ensuite lire les informations et stocker les résultats correspondants. Ainsi, nous allons voir comment lire l’information puis la stocker, selon l’organisation d’un fichier : son format.</p>
<p>Le format d’un fichier est défini par la manière dont est organisée l’information à l’intérieur de celui-ci, et il est essentiel de savoir reconnaître le format d’un fichier afin de pouvoir récupérer ses informations.</p>
<h4>Les formats de fichier</h4>
<p>Il est en effet nécessaire de connaître le format d’un fichier afin de passer d’un fichier binaire (composé de 0 et de 1) à un fichier lisible. On reconnaît généralement le format à l’extension du fichier :</p>
<ul>
<li><strong>.txt</strong> : informations textuelles de base</li>
<li><strong>.csv</strong> : tableaux de données brutes</li>
<li><strong>.png</strong> : images</li>
<li><strong>.docx</strong> : textes mis en forme par Word ou LibreOffice</li>
<li><strong>.xlsx</strong> : tableur Excel ou LibreOffice</li>
<li><strong>.html</strong> : pages internet</li>
<li><strong>.md</strong> : textes en format markdown</li>
</ul>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Le format de fichier <strong>.pdf</strong> est très compliqué à utiliser pour le traitement des données, car ce n’est pas un format conçu pour l’ordinateur afin de stocker des informations temporairement. Il s’agit d’un format plutôt destiné à l’homme pour réaliser une présentation finale des informations.</p>
</div></div>
<h4>Ouvrir un fichier</h4>
<p>Lorsque les fichiers sont directement contenus dans l’ordinateur, le programme doit aller récupérer ce contenu afin de pouvoir l’utiliser, c’est ce que l’on appelle <strong>lire</strong> le fichier.</p>
<p>Par ailleurs, <strong>écrire</strong> dans un fichier permet de conserver l’information. Si l’information n’est pas écrite, elle disparaît après l'exécution du code.</p>
<p>Pour ouvrir un fichier, il faut alors :</p>
<ul>
<li>Créer un lien vers le fichier correspondant à l’aide de la fonction <strong>open( )</strong>. Cette fonction indique que le fichier est actuellement utilisé et interdit son utilisation par d'autres programmes.</li>
<li>Réaliser les actions de lecture et d’écriture détaillées par la suite.</li>
<li>Une fois nos actions terminées, il faut fermer le fichier avec la fonction <strong>close( )</strong>.</li>
</ul>
<h5>Lire un fichier</h5>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Afin de pouvoir reproduire les exercices qui vont être présentés tout au long de ce NOM, je vous conseille de télécharger une base de données. Il en existe énormément en libre accès, notamment sur le site de l’Insee, mais il existe aussi plein d'autres sites avec des bases de données en tout genre.</p>
<p>Ici, je vais travailler avec une base de données fictive que je vais nommer <strong>ma-base-de-donnees</strong>, qui devra être située dans un dossier appelé <strong>data</strong> et qui est stockée dans le même dossier que mon fichier Python sur lequel j’exécute mon script.</p>
</div></div>
<p>Ainsi, pour lire notre fichier, nous allons utiliser :</p>
<ul>
<li>La fonction <strong>open</strong> en donnant le chemin du fichier ainsi que le mode de lecture <strong>“r”</strong>, que nous stockerons dans la variable <code>fichier</code>.</li>
<li>La méthode <strong>.read( )</strong> nous permet de lire tout le contenu du fichier, que nous allons stocker dans la variable <code>contenu</code>.</li>
<li>La méthode <strong>close</strong> nous permet de fermer le fichier.</li>
<li>Nous affichons les 50 premiers éléments de <code>contenu</code> (afin de vérifier que l’opération a bien fonctionné).</li>
</ul>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Ouvrir, lire et fermer un fichier</span>
fichier <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>
contenu <span class="token operator">=</span> fichier<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
fichier<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>contenu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>Pour un code plus compact, il est aussi possible d’utiliser le bloc <strong>with</strong> pour obtenir le même résultat et automatiser la fermeture du fichier :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Ouverture, lecture et fermeture avec le block with</span>
<span class="token comment">##Permet la fermeture automatique du fichier en sortant de with</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    contenu <span class="token operator">=</span> fichier<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>contenu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>La fonction <strong>readlines( )</strong> est aussi intéressante, car elle permet de lire en séparant les lignes. En théorie, les lignes sont séparées par le caractère spécial <strong>\n</strong>. Si l’on utilise simplement la fonction <strong>read</strong>, on risque de voir apparaître plein de ‘\n’ dans notre texte.</p>
<p>Ainsi, si l’on veut par exemple afficher les cinq premières lignes de ma base de données :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Afficher les 5 premieres lignes d'un fichier</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    lignes <span class="token operator">=</span> fichier<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lignes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
</div></div>
<h5>Écrire dans un fichier texte</h5>
<p>Afin d’écrire dans un fichier texte, il suffit de préciser dans la fonction <strong>open</strong>, le mode d’écriture <strong>“w”</strong> ou <strong>“a”</strong>.</p>
<ul>
<li><strong>“w”</strong> (write) : pour remplacer ou créer. Le mode <strong>“w”</strong> crée un fichier s'il n’existe pas et supprime l’existant pour le remplacer sinon.</li>
<li><strong>“a”</strong> (append) : pour ajouter. Le mode <strong>“a”</strong> ajoute l’information à la fin du fichier s'il existe déjà, ou le crée sinon.</li>
</ul>
<p>De plus, la fonction <strong>write( )</strong> permet d’écrire dans notre fichier.</p>
<p>Ainsi, si l’on veut sauvegarder un fichier texte dans lequel on veut écrire le nombre d’élèves présents en Do-It, par exemple :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Faire la sauvegarde d'un résultat</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./eleves.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    fichier<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Élèves en Do-It : 25\n"</span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Ajouter <strong>“\n”</strong> à la fin du texte permet de générer un saut de ligne à la fin (ce n’est pas fait automatiquement sinon).</p>
</div></div>
<h4>Bibliothèques utiles pour écrire dans un fichier</h4>
<p>La bibliothèque <strong>os</strong> contient la majorité des outils permettant de manipuler des fichiers et des dossiers. On peut par exemple créer un nouveau répertoire avec la fonction <strong>mkdir( )</strong> :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Créer un nouveau répertoire dans lequel on crée un fichier texte</span>
<span class="token keyword">import</span> os 
os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"Eleves"</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"Eleves/effectif.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    fichier<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"L’effectif d’élèves en Do-It est : 25"</span><span class="token punctuation">)</span>
</code></pre>
<p>La fonction <strong>glob( )</strong> de la bibliothèque <strong>Glob</strong> permet de trouver tous les fichiers d’un dossier qui contiennent un motif donné, par exemple :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Rechercher tous les fichiers excel d'un dossier</span>
<span class="token keyword">import</span> glob
fichiers_excel <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'*.xls'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fichiers_excel<span class="token punctuation">)</span>
</code></pre>
<p>Ici <strong>”*”</strong> signifie “tous”.</p>
<p>Par ailleurs, pour des fichiers non texte, il faut utiliser des bibliothèques spécifiques pour garder une mise en forme adaptée au format (ex : Excel, image).</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Pour information, une des bibliothèques les plus utilisées pour les fichiers Excel est <strong>Pandas</strong>.</p>
</div></div>
<h4>Un petit exercice pour pratiquer</h4>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-orange-500 bg-orange-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-orange-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
<div class="pl-8 mr-8">
<p>Télécharger la page d'accueil de votre journal favori et la sauvegarder dans un fichier texte.</p>
</div></div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block">
<p>corrigé</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2">
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">import</span> requests <span class="token keyword">as</span> req
url <span class="token operator">=</span><span class="token string">"https://www.lequipe.fr"</span>
info <span class="token operator">=</span> req<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./lemonde.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    fichier<span class="token punctuation">.</span>write<span class="token punctuation">(</span>info<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre>
</div>
</details>     
</div>
<h3>Manipuler des ensembles d'éléments</h3>
<p>Afin de pouvoir manipuler des données plus complexes, il est essentiel d’approfondir les notions de listes et de bibliothèques.</p>
<h4>Rappel des fonctions importantes</h4>
<p>Avant de travailler sur les listes, il est essentiel de maîtriser ces fonctions de base :</p>
<ul>
<li><strong>len(liste)</strong> : longueur de la liste</li>
<li><strong>liste[x]</strong> : valeur de l’élément de rang x</li>
<li><strong>liste.index(v)</strong> : premier indice de la valeur v</li>
<li><strong>liste[x:y]</strong> : valeur entre les indices x et y (y non inclus)</li>
<li><strong>liste[-1]</strong> : dernier élément de la liste</li>
</ul>
<p>Une autre fonction un peu moins connue, mais aussi très utile, est la méthode <strong>.sort( )</strong> qui permet de trier une liste par ordre alphabétique ou numérique.</p>
<h4>Les listes emboîtées</h4>
<p>Maîtriser la notion de liste emboîtée est essentiel si l’on veut traiter des tableaux de données.</p>
<p>Une <strong>liste emboîtée</strong> (ou liste imbriquée) est une structure de données qui consiste en une liste contenant d'autres listes comme éléments. Cela permet de créer des structures hiérarchiques ou multidimensionnelles, par exemple :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Une liste emboîtée représentant des coordonnées (x, y)</span>
coordonnees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment"># Accéder à un élément spécifique : le premier élément de la deuxième liste</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>coordonnees<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># Affiche 3</span>
</code></pre>
<p>Nous allons donc voir ici comment utiliser les listes emboîtées non pas comme un bloc, mais sous la forme d’un tableau qui sépare les informations :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Lire les lignes du fichier</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f <span class="token punctuation">:</span>
    contenu <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>contenu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>On commence par lire les lignes du fichier, comme vu précédemment.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Dans le cas d’un tableau de données classique, la première ligne du fichier va alors contenir les en-têtes des colonnes.</p>
</div></div>
<p>Ensuite, nous allons chercher à identifier le nombre de lignes composant notre tableau :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Connaître le nombre de ligne hors entête</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"La taillle avant pop est"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>contenu<span class="token punctuation">)</span><span class="token punctuation">)</span>
premier_element <span class="token operator">=</span> contenu<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"La taille de la liste est maintennant"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>contenu<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Ce script va alors nous permettre, grâce à la fonction <strong>len</strong>, de mesurer la longueur de notre liste avec l'en-tête. Puis, avec la méthode <strong>pop(0)</strong>, nous allons venir supprimer la première ligne de notre tableau (celle qui contient les en-têtes), tout en stockant cette information dans <code>premier_element</code>, afin d’avoir le nombre de lignes contenant des valeurs.</p>
<p>Ensuite, notre fichier étant un tableau dans lequel chaque ligne comprend des valeurs séparées par des <strong>”;”</strong>, nous allons séparer ces lignes afin de pouvoir récupérer nos données de manière indépendante.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Transformer chaque entrée en une liste</span>
donnees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> ligne <span class="token keyword">in</span> contenu <span class="token punctuation">:</span>
    ligne_decoupe <span class="token operator">=</span> ligne<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span>
    donnees<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ligne_decoupe<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>donnees<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>Ici, nous avons donc séparé chaque élément grâce à la méthode <strong>split(“;”)</strong> qui permet de couper entre chaque point-virgule. Ensuite, nous choisissons d’afficher les 5 premiers éléments du premier élément de cette liste.</p>
<p>La liste que l’on a créée permet maintenant d’accéder à nos données comme dans un tableau à deux entrées. Ainsi, si l’on veut par exemple afficher le troisième élément de la septième ligne :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Afficher le 3eme élement de la 7eme ligne</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>donnees<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>La septième ligne est à l’indice 6, et le troisième élément de notre tableau est dans la colonne 3, donc à l’indice 2.</p>
<h3>Manipuler du texte</h3>
<h4>Notion d’encodage</h4>
<p>Nous n’allons pas beaucoup rentrer dans les détails de l’encodage ici, mais l’idée à retenir est que si, à l’ouverture de votre fichier, l’affichage comporte des caractères spéciaux un peu partout, c’est que votre fichier ne s’est pas ouvert avec le bon encodage.</p>
<p>Ainsi, si vous connaissez l’encodage qui a été choisi, vous pouvez ouvrir un fichier en le spécifiant (comme nous allons le voir ci-dessous). Dans le cas où, malheureusement, vous n’avez pas cette information, le mieux est de procéder par essais-erreurs avec les encodages les plus usuels.</p>
<p>Imaginons que l’on veuille ouvrir notre base de données et que le texte de celle-ci soit encodé en <strong>“latin1”</strong> (un des plus classiques) :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Encodage</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"latin1"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier <span class="token punctuation">:</span>
    contenu <span class="token operator">=</span> fichier<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Ici, <strong>encoding=&quot;latin1&quot;</strong> permet d’ouvrir le fichier avec le mode d’encodage choisi, le latin1.</p>
<h4>Mise en forme de texte</h4>
<p>Pour rappel, un texte est un ensemble de symboles (lettres, chiffres, ponctuations), ainsi pour accéder à une lettre d’un texte, cela revient à accéder à un élément de la liste à l’aide de son index.</p>
<p><strong>Fonctions utiles</strong>
Il existe des méthodes permettant de mettre le texte en majuscule, minuscule, ou uniquement avec la première lettre en majuscule :</p>
<ul>
<li><strong>lower( )</strong> : permet de mettre en minuscule</li>
<li><strong>upper( )</strong> : permet de mettre en majuscule</li>
<li><strong>capitalize( )</strong> : permet de mettre une majuscule uniquement à la première lettre</li>
</ul>
<p>Par exemple :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">texte <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> texte<span class="token punctuation">]</span>
</code></pre>
<p>La méthode <strong>replace( )</strong> permet de remplacer un ensemble de lettres par un autre.</p>
<p>Par exemple, si l’on veut remplacer tous les points-virgules par des espaces :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">texte <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>“<span class="token punctuation">;</span>”<span class="token punctuation">,</span>” “<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> texte<span class="token punctuation">]</span>
</code></pre>
<h4>Intégrer des variables au texte</h4>
<p>On s'intéresse ici à comment intégrer une variable, par exemple un nombre, dans un texte. Une méthode est la méthode de formatage : <strong>format( )</strong>, que nous allons détailler ici, mais il est bon de savoir qu’il en existe d’autres.</p>
<p>L’intérêt de la méthode de formatage est que l’on peut insérer dans le texte une sorte d’espace vide dans lequel on pourra venir intégrer notre variable sans avoir forcément besoin de la définir au préalable :</p>
<p>Par exemple :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Intégrer des variables</span>
nb_eleves_do_it <span class="token operator">=</span> <span class="token number">25</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Il y a {} élèves en Do_It"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nb_eleves_do_it<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>La variable que l’on va ajouter se rajoutera donc à l’endroit où nous avons mis les <strong>{}</strong>, et la valeur de la variable est ajoutée grâce au <strong>.format(variable)</strong>. On retournera donc : <strong>Il y a 25 élèves enDo_It</strong>
Cette fonction peut notamment être utile pour faire de la restitution de données et donc intégrer vos résultats d’analyse à du texte.</p>
<h4>Traitement de données réelles</h4>
<p>Dans cette partie, nous allons apprendre à faire une analyse sur du texte réel. Il faudra donc le formater avant de pouvoir extraire l’information recherchée.</p>
<p>Ici, nous allons créer un programme permettant de compter le <strong>nombre de mots composés</strong> dans une base de données. Si vous voulez le tester aussi assurez vous que votre base de données en comprenne (par exemple des noms de communes ou des prénoms).</p>
<p>Nous allons commencer par ouvrir notre base de données contenant du texte,comme précédement :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Ouvrir le fichier en séparant les lignes</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./data/ma-base-de-donnees.csv"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    contenu <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
donnees <span class="token operator">=</span> <span class="token punctuation">[</span>ligne<span class="token punctuation">.</span>split <span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span> <span class="token keyword">for</span> ligne <span class="token keyword">in</span> contenu<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>donnees<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>L’objectif ici est d’ouvrir notre fichier et de le séparer par ligne, puis d’afficher une partie des éléments afin d’identifier les éléments à nettoyer. Dans ce cas, nous devons nettoyer des <strong>”</strong> et des <strong>\n</strong> qui apparaîtront dans nos résultats.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Une infinité d’autres erreurs peut survenir selon l’encodage de votre fichier. Classiquement, il peut y avoir des signes parasites comme des guillemets ou encore des virgules, mais d’autres suites de caractères peuvent apparaître, comme par exemple :</p>
<p><strong>\u202f</strong> : C'est le code Unicode pour le caractère d'espacement insécable (narrow no-break space). Ce caractère est souvent utilisé pour ajouter un espace entre des chiffres, en particulier dans les nombres, sans qu'il soit possible de les séparer à la fin d'une ligne.</p>
<p>Lorsque l’on veut faire apparaître notre chiffre en entier, il peut donc être utile de nettoyer ce code en le remplaçant, par exemple, par rien.</p>
</div></div>
<p>Une fois le fichier ouvert, nous allons créer une fonction de nettoyage afin de remplacer les caractères indésirables identifiés par rien (c’est une façon de les supprimer).</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Définir une fonction de nettoyage</span>
<span class="token keyword">def</span> <span class="token function">nettoyage</span> <span class="token punctuation">(</span>ligne<span class="token punctuation">)</span> <span class="token punctuation">:</span>
    nouvelle_ligne <span class="token operator">=</span> ligne<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
    nouvelle_ligne <span class="token operator">=</span> nouvelle_ligne<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> nouvelle_ligne
</code></pre>
<p>Cette fonction nous permet donc de supprimer les guillemets et les indicateurs de saut de ligne, et nous retourne notre texte sans. Pour s’en assurer, nous pouvons l’appliquer à notre base de données et retourner la même portion que précédemment. Nous constatons donc que les caractères qui nous dérangeaient ne sont plus là.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Nettoyer et afficher</span>
donnees <span class="token operator">=</span> <span class="token punctuation">[</span>nettoyage<span class="token punctuation">(</span>ligne<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span> <span class="token keyword">for</span> ligne <span class="token keyword">in</span> contenu<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>donnees<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>Une fois notre base de données textuelles nettoyée, nous allons pouvoir passer au comptage.</p>
<p>Pour ce faire, nous avons besoin d’une nouvelle fonction, la fonction <strong>.count()</strong>, qui permet de compter l’occurrence d’un élément.</p>
<p>Comme nous cherchons à compter les mots composés, nous allons compter le nombre de fois où apparaissent un tiret ou un espace (ces éléments sont caractéristiques des mots composés).</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Compter le nombre de nom composé</span>
nb_compose <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> ligne <span class="token keyword">in</span> donnees <span class="token punctuation">:</span>
    nom <span class="token operator">=</span> ligne<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nom<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span> <span class="token punctuation">)</span><span class="token keyword">or</span> <span class="token punctuation">(</span>nom<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
        nb_compose<span class="token operator">+=</span><span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Il y a {} nom(s) composé(s)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nb_compose<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Ainsi, tout cela nous permet d’appliquer les fonctions vues jusqu'ici dans un cas concret sur des données réelles.</p>
<h3>Les expressions régulières</h3>
<p>Les <strong>expressions régulières</strong> (ou regex) sont des séquences de caractères qui définissent un motif de recherche dans une chaîne de caractères. Elles sont largement utilisées en analyse de données textuelles pour effectuer des opérations telles que la recherche, la validation, la substitution ou le découpage de chaînes.</p>
<p>Les expressions régulières possèdent une syntaxe spécifique, ce qui rend leur utilisation nécessaire dès que l’on sort de cas basiques pour des cas plutôt complexes. Par exemple, elles utilisent une syntaxe particulière pour décrire des motifs, incluant des métacaractères (comme <strong>”.”</strong> pour n'importe quel caractère, <strong>”*”</strong> pour zéro ou plusieurs répétitions, ou <strong>”^”</strong> pour indiquer le début d'une chaîne).</p>
<p>Ainsi, nous ne rentrerons pas plus dans le détail ici, mais il est toutefois essentiel de savoir que cela existe afin de pouvoir chercher des fonctions spécifiques à nos besoins dans la littérature.</p>
<p>Aussi, la bibliothèque <strong>re</strong> est le module intégré de Python pour travailler avec les expressions régulières. Elle permet d'effectuer des opérations de recherche, de correspondance, de substitution et de découpage sur des chaînes de caractères en utilisant des motifs définis par des expressions régulières.</p>
<p>On peut notamment citer la fonction <strong>re.findall(pattern, string)</strong> : renvoie une liste de toutes les occurrences du motif trouvé dans la chaîne.</p>
<h2>Faire une analyse</h2>
<p>L’objectif ici est de pratiquer un petit peu en autonomie sur les notions abordées, et pourquoi pas d’en découvrir d’autres. L’idée est de trouver une base de données contenant du texte que l’on va pouvoir analyser.</p>
<h3>Trouver une base de données à analyser</h3>
<p>En m’inspirant du MON de Lola sur les Pokémon <a href="https://francoisbrucker.github.io/do-it/promos/2024-2025/Lola-Perdrix/pok/temps-1/">Étude statistique des Pokémons avec les outils Excel</a>, j’ai décidé de me rendre sur <a href="https://www.kaggle.com/datasets">Kaggle</a> afin de trouver une base de données à analyser.</p>
<p>Afin d’avoir une base de données qui contient du texte, l’idée était de trouver une base de données contenant des avis ou des critiques, car ce seront bien des données textuelles.</p>
<p>J’ai alors choisi de traiter la base de données des reviews des restaurants de Lima, au Pérou : Peruvian Food Reviews. Elle contient notamment les avis des utilisateurs ainsi que d’autres critères comme la note du commentaire, un identifiant d’utilisateur et du restaurant.</p>
<h3>Faire l’analyse</h3>
<p>La première étape va être d’ouvrir le fichier dans Python (comme vu précédemment) afin d’en extraire les colonnes qui nous intéressent et que l’on va nettoyer par la suite.</p>
<h4>Extraction des colonnes “review” et “score”</h4>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Ouvrir le fichier en séparant les lignes</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">".data/reviews.csv"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    lignes <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Création de ma nouvelle base de données comprenant les colonnes de “review” et de “score”</span>
<span class="token comment">## Récupéreration des colonnes 2 (review) et 4 (score)</span>
colonnes_deux <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
colonnes_quatre <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> ligne <span class="token keyword">in</span> lignes<span class="token punctuation">:</span> 
    colonnes <span class="token operator">=</span> ligne<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>  
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>colonnes<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">:</span>  
        colonnes_deux<span class="token punctuation">.</span>append<span class="token punctuation">(</span>colonnes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
        colonnes_quatre<span class="token punctuation">.</span>append<span class="token punctuation">(</span>colonnes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  

<span class="token comment">## Fonction pour créer une nouvelle base de données à partir de deux colonnes</span>
<span class="token keyword">def</span> <span class="token function">creation_bdd</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bdd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
            bdd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> c1<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  
        <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
            bdd<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> c2<span class="token punctuation">[</span>l<span class="token punctuation">]</span>  
    <span class="token keyword">return</span> bdd

<span class="token comment">## Appel de la fonction pour créer la base de données</span>
base_de_donnees <span class="token operator">=</span> creation_bdd<span class="token punctuation">(</span>colonnes_deux<span class="token punctuation">,</span> colonnes_quatre<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>base_de_donnees<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>La fonction <strong>.strip ( )</strong> en Python est utilisée pour supprimer les espaces (ou tout autre caractère spécifié) au début et à la fin d'une chaîne de caractères. Sans argument, .strip() supprime les espaces, les tabulations (\t) et les retours à la ligne (\n) au début et à la fin de la chaîne.</p>
</div></div>
<h4>Nettoyage des données</h4>
<p>Une fois nos données correctement extraites de notre base de données, nous allons les nettoyer, comme vu précédemment. Ici, après avoir affiché nos 100 premières chaînes de caractères, nous observons des guillemets au début de chaque commentaire, mais qui ne sont jamais fermés. Nous allons donc les remplacer par rien pour nettoyer nos valeurs.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Création de la fonction de nettoyage adaptée</span>
<span class="token keyword">def</span> <span class="token function">nettoyage</span><span class="token punctuation">(</span>ligne<span class="token punctuation">)</span><span class="token punctuation">:</span>
    nouvelle_ligne <span class="token operator">=</span> <span class="token punctuation">[</span>colonne<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">for</span> colonne <span class="token keyword">in</span> ligne<span class="token punctuation">]</span>
    <span class="token keyword">return</span> nouvelle_ligne

<span class="token comment"># Appliquer nettoyage à chaque ligne dans base_de_donnees</span>
base_de_donnees_propre <span class="token operator">=</span> <span class="token punctuation">[</span>nettoyage<span class="token punctuation">(</span>ligne<span class="token punctuation">)</span> <span class="token keyword">for</span> ligne <span class="token keyword">in</span> base_de_donnees<span class="token punctuation">]</span>

</code></pre>
<h4>Créer des fichiers texte contenant les avis regroupés par score</h4>
<p>Notre base de données regroupe maintenant une note correspondant à un avis. L’idée est donc de rassembler, pour chaque note (de 0 à 5), chaque avis correspondant dans un fichier texte. Ainsi, nous pourrons rechercher, pour chaque score, le mot qui ressort le plus et voir s'ils diffèrent.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Créer la fonction pour créer des fichiers textes contenant les avis par score</span>
<span class="token keyword">def</span> <span class="token function">texte_par_note</span><span class="token punctuation">(</span>b_d_d<span class="token punctuation">,</span> score<span class="token punctuation">,</span> nom_fichier_texte<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>nom_fichier_texte<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier<span class="token punctuation">:</span>
        <span class="token keyword">for</span> ligne <span class="token keyword">in</span> b_d_d<span class="token punctuation">:</span>
            <span class="token keyword">if</span> ligne<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">str</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">:</span>
                fichier<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ligne<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

<span class="token comment"># Appliquer la fonction pour chaque score</span>
texte_score_0 <span class="token operator">=</span> <span class="token string">"avis_score_0.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> texte_score_0<span class="token punctuation">)</span>

texte_score_1 <span class="token operator">=</span> <span class="token string">"avis_score_1.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> texte_score_1<span class="token punctuation">)</span>

texte_score_2 <span class="token operator">=</span> <span class="token string">"avis_score_2.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> texte_score_2<span class="token punctuation">)</span>

texte_score_3 <span class="token operator">=</span> <span class="token string">"avis_score_3.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> texte_score_3<span class="token punctuation">)</span>

texte_score_4 <span class="token operator">=</span> <span class="token string">"avis_score_4.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> texte_score_4<span class="token punctuation">)</span>

texte_score_5 <span class="token operator">=</span> <span class="token string">"avis_score_5.txt"</span>  
texte_par_note<span class="token punctuation">(</span>base_de_donnees_propre<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> texte_score_5<span class="token punctuation">)</span>
</code></pre>
<h4>Supprimer du texte les “stop words”</h4>
<p>Une fois nos fichiers textes créés, nous allons chercher le mot le plus utilisé dans les avis d’un score donné. Cependant, si nous effectuons cette opération directement sur nos commentaires, le mot qui ressortira sera probablement ce que l’on appelle un <strong>stop word</strong>. Nous allons donc supprimer tous les stop words de nos textes afin de pouvoir effectuer notre comptage des mots par la suite. Étant donné que les commentaires sont en espagnol, nous allons récupérer en ligne une liste de stop words en espagnol.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Un <strong>stop word</strong> est un mot courant qui est souvent ignoré dans le traitement du langage naturel et l'analyse de texte. Ces mots, comme &quot;et&quot;, &quot;ou&quot;, &quot;le&quot;, &quot;la&quot;, et &quot;de&quot; en français, n'apportent généralement pas d'information significative au sens du texte et peuvent être filtrés pour simplifier l'analyse. L'élimination des stop words permet de se concentrer sur les mots qui portent plus de sens et d'améliorer l'efficacité des algorithmes d'analyse.</p>
</div></div>
<p>Nous en profitons aussi pour venir supprimer les signes de <strong>poncuation</strong> car ils sont inutiles et risquent de venir perturber notre analyse.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment">#Créer une liste de short word en espagnol à partir d'un fichier texte</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"stop_words_spanish.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> lexique <span class="token punctuation">:</span>
    stop_word <span class="token operator">=</span> <span class="token punctuation">[</span>ligne<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> ligne <span class="token keyword">in</span> lexique<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># Créer une fonction qui permet à partir d'un fichier texte de retirer la ponctuation, puis les stop words</span>
<span class="token keyword">def</span> <span class="token function">sans_stop_word</span><span class="token punctuation">(</span>texte<span class="token punctuation">,</span> mot_inutile<span class="token punctuation">,</span> texte_filtre<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>texte<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        contenu <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    mots <span class="token operator">=</span> contenu<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    ponctuation <span class="token operator">=</span> <span class="token string">".,;:!¡?¿'\"()[]{}-"</span>
    mots_sans_ponctuation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>char <span class="token keyword">for</span> char <span class="token keyword">in</span> mot <span class="token keyword">if</span> char <span class="token keyword">not</span> <span class="token keyword">in</span> ponctuation<span class="token punctuation">)</span> <span class="token keyword">for</span> mot <span class="token keyword">in</span> mots<span class="token punctuation">]</span>
    mots_filtres <span class="token operator">=</span> <span class="token punctuation">[</span>mot <span class="token keyword">for</span> mot <span class="token keyword">in</span> mots_sans_ponctuation <span class="token keyword">if</span> mot <span class="token keyword">not</span> <span class="token keyword">in</span> mot_inutile<span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>texte_filtre<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fichier<span class="token punctuation">:</span>
        fichier<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>mots_filtres<span class="token punctuation">)</span><span class="token punctuation">)</span>  
    <span class="token keyword">return</span> texte_filtre

<span class="token comment"># Appliquer la fonction à chaque fichier</span>
texte_ssw_score_0 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_0.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_0<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_0<span class="token punctuation">)</span>

texte_ssw_score_1 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_1.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_1<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_1<span class="token punctuation">)</span>

texte_ssw_score_2 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_2.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_2<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_2<span class="token punctuation">)</span>

texte_ssw_score_3 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_3.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_3<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_3<span class="token punctuation">)</span>

texte_ssw_score_4 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_4.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_4<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_4<span class="token punctuation">)</span>

texte_ssw_score_5 <span class="token operator">=</span> <span class="token string">"avis_ssw_score_5.txt"</span>
sans_stop_word<span class="token punctuation">(</span>texte_score_5<span class="token punctuation">,</span> stop_word<span class="token punctuation">,</span> texte_ssw_score_5<span class="token punctuation">)</span>
</code></pre>
<h4>Compter les mots les plus fréquents dans le texte en fonction de la note</h4>
<p>On va venir ici, compter pour chaque fichier texte regroupant les avis par note, les 1O mots les plus utilisés ainsi que leur occurrence dans le texte. On va ensuite venir regrouper ces résultats dans un unique fichier texte.</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token comment"># Créer une fonction comptant les occurrences des mots dans le texte et renvoie les 10 plus fréquents</span>
<span class="token keyword">def</span> <span class="token function">compter_mots</span><span class="token punctuation">(</span>fichier<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fichier<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        contenu <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    mots <span class="token operator">=</span> contenu<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    compteur <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> mot <span class="token keyword">in</span> mots<span class="token punctuation">:</span>
        compteur<span class="token punctuation">[</span>mot<span class="token punctuation">]</span> <span class="token operator">=</span> compteur<span class="token punctuation">.</span>get<span class="token punctuation">(</span>mot<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    mots_frequents <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>compteur<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> mots_frequents

<span class="token comment"># Créer un fichier pour enregistrer les résultats</span>
fichier_resultats <span class="token operator">=</span> <span class="token string">"resultats_des_scores.txt"</span>

<span class="token keyword">def</span> <span class="token function">resultat</span><span class="token punctuation">(</span>fichier_texte<span class="token punctuation">,</span> score<span class="token punctuation">,</span> fichier_avis<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mots_frequents <span class="token operator">=</span> compter_mots<span class="token punctuation">(</span>fichier_avis<span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fichier_texte<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Les mots les plus utilisés dans les avis de note </span><span class="token interpolation"><span class="token punctuation">{</span>score<span class="token punctuation">}</span></span><span class="token string"> sont : </span><span class="token interpolation"><span class="token punctuation">{</span>mots_frequents<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Appeler la fonction pour chaque score</span>
<span class="token keyword">for</span> score <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    resultat<span class="token punctuation">(</span>fichier_resultats<span class="token punctuation">,</span> score<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"avis_ssw_score_</span><span class="token interpolation"><span class="token punctuation">{</span>score<span class="token punctuation">}</span></span><span class="token string">.txt"</span></span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>On utilise ici la notion de dictionnaire pour stocker les résultats de notre comptage. Cette notion est abordée plus en détail dans mon <a href="https://francoisbrucker.github.io/do-it/promos/2024-2025/Esther-Henry/mon/temps-1.1/">MON 1.1</a>.</p>
</div></div>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li>La fonction <strong>sorted( )</strong> permet de trier des itérables, comme des listes ou des tuples. Elle prend en entrée un itérable et retourne une nouvelle liste contenant les éléments triés. La syntaxe de sorted() est <strong>sorted(iterable, key=None, reverse=False)</strong>. Le paramètre <strong>key</strong> permet de spécifier une fonction qui détermine l'ordre de tri (par exemple, tri par une certaine valeur dans des tuples), tandis que le paramètre <strong>reverse</strong> permet de trier en ordre décroissant si défini à True.</li>
<li>La fonction <strong>lambda</strong> est une manière de créer des fonctions anonymes, c'est-à-dire des fonctions sans nom, en une seule ligne. Elle est souvent utilisée pour des opérations simples où une fonction temporaire est requise. La syntaxe générale est <strong>lambda arguments: expression</strong>, où <strong>arguments</strong> sont les paramètres que la fonction prend et <strong>expression</strong> est le résultat retourné.</li>
</ul>
</div></div>
<p>Qui nous retourne :</p>
<ul>
<li><strong>Les mots les plus utilisés dans les avis de note 0 sont</strong> : [('comida', 647), ('excelente', 436), ('lima', 262), ('servicio', 205), ('experiencia', 171), ('restaurante', 165), ('almuerzo', 126), ('atención', 112), ('rico', 112), ('delicioso', 109)]</li>
<li><strong>Les mots les plus utilisés dans les avis de note 1 sont</strong> : [('atención', 3523), ('comida', 2405), ('mala', 2278), ('pollo', 1293), ('mal', 1222), ('pésima', 1219), ('servicio', 1152), ('pésimo', 963), ('atencion', 917), ('sabor', 779)]</li>
<li><strong>Les mots les plus utilisés dans les avis de note 2 sont</strong> : [('atención', 2146), ('comida', 1831), ('mala', 829), ('pollo', 810), ('sabor', 775), ('calidad', 732), ('regular', 646), ('falta', 618), ('servicio', 549), ('atencion', 500)]</li>
<li><strong>Les mots les plus utilisés dans les avis de note 3 sont</strong> : [('comida', 6872), ('atención', 6500), ('rico', 3501), ('agradable', 2664), ('pollo', 2249), ('falta', 1833), ('mejorar', 1809), ('sabor', 1741), ('regular', 1738), ('platos', 1653)]</li>
<li><strong>Les mots les plus utilisés dans les avis de note 4 sont</strong> : [('comida', 19386), ('atención', 16686), ('rico', 12214), ('excelente', 7719), ('agradable', 7038), ('pollo', 5532), ('platos', 4694), ('ambiente', 4379), ('sabor', 3871), ('atencion', 3762)]</li>
<li><strong>Les mots les plus utilisés dans les avis de note 5 sont</strong> : [('excelente', 42239), ('comida', 36600), ('atención', 35102), ('rico', 25955), ('pollo', 9649), ('delicioso', 9075), ('servicio', 9035), ('agradable', 7800), ('atencion', 7617), ('platos', 7531)]</li>
</ul>
<h4>Conclusion</h4>
<ul>
<li>Première conclusion : ici, nous voyons que <strong>l’orthographe</strong> joue un rôle important dans ce genre d’analyse, car nous avons plusieurs fois “atencion” et “atención” qui ressortent comme deux mots différents, alors qu’il s’agit du même mot mal orthographié, ce qui vient un peu fausser les résultats.</li>
<li>En vue du résultat, nous pouvons présupposer que <strong>les avis de note 0</strong> ne sont pas réellement des avis de notes 0, car les mots qui ressortent sont plutôt très positifs, comme “excelente”, “rico” et “delicioso”.</li>
<li>Pour le reste, <strong>certains mots ressortent pour chaque note</strong> comme “atención”, “servicio”, ou encore “comida” et “pollo” (ce qui n’est pas étonnant au Pérou, car le “pollo” fait partie des plats les plus consommés). Nous pouvons alors nous demander si, dans le cadre de notre analyse, il n’aurait pas fallu les rajouter à notre liste de stop-words afin de n’avoir que des mots faisant sens du point de vue de l’avis des consommateurs.</li>
<li>Sinon, nous constatons quand même que pour <strong>les avis de note 1</strong>, les mots utilisés sont <strong>plutôt négatifs</strong>, tels que “mala”, “mal”, “pesima” et “pesimo”, alors que pour <strong>les avis de note 5</strong>, les mots sont plutôt connotés <strong>positivement</strong>, comme “excelente”, “rico”, “delicioso” et “agradable”, ce qui est ce que nous aurions pu présupposer.</li>
</ul>
<p><img src="images/comida_lima.png" alt="Comida Lima"></p>
<p>PS : Le choix de ce sujet a été motivé par mon amour pour le lomo saltado, et notamment les meilleurs que j'ai mangés à Lima.</p>
<h3>Horodatage</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Heures passées</th>
<th>Indications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jeudi 19/09</td>
<td>2H</td>
<td>Gérer les fichiers</td>
</tr>
<tr>
<td>Vendredi 20/09</td>
<td>1H</td>
<td>Ensemble d'élément</td>
</tr>
<tr>
<td>Mercredi 02/10</td>
<td>2H</td>
<td>Manipuler du texte</td>
</tr>
<tr>
<td>Jeudi 03/10</td>
<td>2H</td>
<td>Choix base de données &amp; Début analyse</td>
</tr>
<tr>
<td>Vendredi 04/10</td>
<td>2H</td>
<td>Analyse suite</td>
</tr>
<tr>
<td>Dimanche 06/10</td>
<td>2H</td>
<td>Analyse fin</td>
</tr>
</tbody>
</table>
<h3>Bibliographie</h3>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li><a href="https://pur-editions.fr/product/7857/python-pour-les-shs">Python pour les SHS</a></li>
<li><a href="https://countwordsfree.com/stopwords/french">Stop Words</a></li>
<li><a href="https://www.kaggle.com/datasets/lazaro97/peruvian-food-reviews">Peruvian Food Reviews</a></li>
<li><a href="https://www.quennec.fr/trucs-astuces/langages/python/python-trier-le-contenu-dun-dictionnaire-dict#:~:text=Pour%20trier%20un%20objet%20dict,valeurs%20sont%20converties%20en%20tuple.&amp;text=On%20voit%20que%20l'ordre,n'a%20pas%20%C3%A9t%C3%A9%20conserv%C3%A9.">Python: Trier le contenu d'un dictionnaire</a></li>
</ul>
</div></div>



</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
