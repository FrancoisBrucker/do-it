
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MON 2.2 -Docker</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">MON 2.2 -Docker</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 2</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">vert</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Docker</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Emma Gonin</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                MON sur Docker, dockerisation d'un projet

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Gonin-Emma/">Emma Gonin</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Gonin-Emma/mon/">MON de Emma Gonin</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Gonin-Emma/mon/temps-2.2/">MON 2.2 -Docker</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mr-8">
<p>Novice</p>
</div></div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<p>Les lien utiles pour la compréhension de celui-ci.
<a href="https://francoisbrucker.github.io/do-it/promos/2022-2023/Bilgi-Tuncay/mon/Docker/">MON de Tuncay Bilgi</a>, le
<a href="https://francoisbrucker.github.io/do-it/promos/2023-2024/Victor-Ory/mon/Docker/">MON de Victor Ory</a> et le
<a href="https://francoisbrucker.github.io/do-it/promos/2023-2024/Louradou-Arthur/mon/temps-2.1/">MON d'Arthur Louradou</a></p>
</div></div>

<p>Un MON pour se familiariser avec Docker. J'ai déjà utilisé un peu Docker pendant mon stage mais je souhaite approfondir mes connaissances pour monter en compétences DevOps.</p>
<h2>Contenu</h2>
<p>Dans un premier temps, j'installe <a href="https://docs.docker.com/desktop/setup/install/windows-install/">Docker Desktop</a> sur mon Windows, ce qui me servira à orchestrer mes conteneurs. Je manque de stockage sur ma machine et j'ai eu des problèmes avec WSL mais j'ai réussi à lancer Docker Desktop pour travailler dessus. J'ai lu le <a href="https://francoisbrucker.github.io/do-it/promos/2022-2023/Bilgi-Tuncay/mon/Docker/">MON de Tuncay</a> pour me familiariser avec Docker puis je me suis lancée le défi de dockeriser mon application web de mon portefolio qui consiste à un frontend React et un backend Fastapi avec un script NodeJs pour orchestrer le tout. Je vais créer seulement deux conteneurs : un pour le frontend et un pour le backend.</p>
<h4>a. Structure de mon projet</h4>
<p>Voici la structure de mon projet :</p>
<pre><code>/portfolio
    /frontend (ReactJS)
    /frontend/Dockerfile
    /backend (FastAPI)
    /backend/Dockerfile
  package.json (Scripts Node.js pour démarrer les serveurs)
  docker-compose.yml
  .dockerignore
  Dockerfile
</code></pre>
<h4>b. Dockeriser le frontend (ReactJS)</h4>
<p>Je crée un <code>Dockerfile</code> dans le dossier <code>frontend</code> :</p>
<pre class="language-dockerfile"><code class="language-dockerfile"><span class="token comment"># Utilisation de l'image Node.js officielle pour construire l'application</span>
<span class="token instruction"><span class="token keyword">FROM</span> node:18</span>

<span class="token comment"># Définir le répertoire de travail</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token comment"># Copier les fichiers package.json et package-lock.json</span>
<span class="token instruction"><span class="token keyword">COPY</span> package.json package-lock.json ./</span>

<span class="token comment"># Installer les dépendances</span>
<span class="token instruction"><span class="token keyword">RUN</span> npm install</span>

<span class="token comment"># Copier le reste des fichiers de l'application React</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>

<span class="token comment"># Exposer le port utilisé par le serveur React (généralement 3000)</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 3000</span>

<span class="token comment"># Lancer le serveur de développement React</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"npm"</span>, <span class="token string">"start"</span>]</span>
</code></pre>
<h4>c. Dockeriser le backend (FastAPI)</h4>
<p>Je crée un <code>Dockerfile</code> dans le dossier <code>backend</code> :</p>
<pre class="language-dockerfile"><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> python:3.10-slim</span>

<span class="token comment"># Crée un répertoire pour l'application</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token comment"># Copie les fichiers de l'application dans le conteneur</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /app</span>

<span class="token comment"># Installe les dépendances</span>
<span class="token instruction"><span class="token keyword">RUN</span> pip install --no-cache-dir -r requirements.txt</span>

<span class="token comment"># Expose le port</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 8000</span>

<span class="token comment"># Démarrer Uvicorn en utilisant l'environnement virtuel</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"uvicorn"</span>, <span class="token string">"api.main:app"</span>, <span class="token string">"--reload"</span>]</span>
</code></pre>
<p>Je n'ai pas besoin de créer de venv car Docker installe directement les dépendances dans le conteneur.</p>
<h4>d. Créer le fichier <code>.dockerignore</code></h4>
<p>Dans chaque dossier, je crée un fichier <code>.dockerignore</code> pour éviter de copier des fichiers inutiles dans l'image Docker. Exemple pour <code>frontend/.dockerignore</code> :</p>
<pre><code>node_modules
build
</code></pre>
<h3>e. Créer le fichier <code>docker-compose.yml</code></h3>
<p>À la racine du projet, je crée un fichier <code>docker-compose.yml</code> pour orchestrer les conteneurs du projet :</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.8'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">frontend</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./frontend
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> app<span class="token punctuation">-</span>network

  <span class="token key atrule">backend</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./backend
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> app<span class="token punctuation">-</span>network
  <span class="token key atrule">networks</span><span class="token punctuation">:</span>
    <span class="token key atrule">app-network</span><span class="token punctuation">:</span>
      <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge</code></pre>
<p>J'ai lancé <code>docker-compose build</code> dans mon terminal et dans un premier temps ça prenait beaucoup trop de temps tout simplement car j'ai oublié le .dockerignore donc j'étais en train de créer des images Docker des modules Node... Dans un second temps j'ai donc créé ce fichier là et relancé ma commande.</p>
<p>Docker va alors construire les images pour chaque service. L'image pour le frontend s'appelle &quot;nom-du-projet-frontend&quot; et est très lourde (3,5 Go), ça doit être parce qu'elle contient tous les modules Node qu'on a installé précédemment.</p>
<p><img src="image-3.png" alt="alt text"></p>
<p>Pour démarrer les conteneurs pour ces services, je lance <code>docker-compose up</code>.</p>
<p><img src="image.png" alt="alt text"></p>
<p>On voit dans Docker Desktop que 2 conteneurs sont créés : un pour le frontend et un pour le backend. On peut aussi voir les logs en temps réel pour chaque service.</p>
<p><img src="image-1.png" alt="alt text">
<img src="image-5.png" alt="alt text"></p>
<p>J'accède à <code>http://localhost:3000</code> dans mon navigateur pour voir l'application React puis à <code>http://localhost:8000</code> pour tester l'API FastAPI. J'ai eu quelques problèmes avec mon conteneur backend mais le frontend fonctionne.</p>
<p><img src="image-2.png" alt="alt text"></p>
<p>J'utilise l'interface de <strong>Docker Desktop</strong> pour :</p>
<ul>
<li><strong>Voir les conteneurs</strong> : Sur l'interface Docker Desktop, on peut voir l'état de tous nos conteneurs (en cours d'exécution, arrêtés, etc.).</li>
<li><strong>Gérer les conteneurs</strong> : on peut démarrer, arrêter ou redémarrer nos conteneurs directement depuis l'interface graphique.</li>
<li><strong>Consulter les logs</strong> : Docker Desktop permet de visualiser les logs de chaque conteneur. Cela peut être utile pour le débogage.</li>
<li><strong>Supprimer des conteneurs</strong> : Si on souhaite supprimer les conteneurs ou les images, on peut également le faire via l'interface.</li>
</ul>
<p>On peut arrêter vos conteneurs avec :</p>
<pre><code>docker-compose down
</code></pre>
<p>Cela arrêtera les conteneurs et les supprimera, mais gardera les images intactes.</p>
<h3>Conclusion</h3>
<p>Docker Desktop est un outil facile à prendre en main, malgré mes soucis avec WSL, tout s'est bien déroulé et j'ai désormais 2 conteneurs pour mon application et je pourrais utiliser cet outil dans ma vie professionnelle.</p>
<h3>Ressources</h3>
<ul>
<li>Documentation Docker : <a href="https://docs.docker.com/">https://docs.docker.com/</a></li>
<li><a href="https://lightcode.fr/article/introduction-docker-serveur/">https://lightcode.fr/article/introduction-docker-serveur/</a></li>
</ul>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développement et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>
        <script src="/do-it/assets/node_modules/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    </body>
</html>
