
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>GoAuth2.0</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">GoAuth2.0</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">POK</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 1</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">vert</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">avancé</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Go</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Authentification</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">OAuth2</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Valentin Billa</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Création d'un serveur d'authentification OAuth2.0 en Go.

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Billa-Valentin/">Valentin Billa</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Billa-Valentin/pok/">POKs Valentin Billa</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Billa-Valentin/pok/temps-1/">GoAuth2.0</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li>Bases relativement solides en programmation</li>
<li>Une idée des différences entre utilisateur, client, serveur</li>
<li>Quelques concepts d'authentification peuvent aider (token, hash...)</li>
</ul>
</div></div>
<h2>Objectifs</h2>
<p>Je n'ai jamais codé en Go, mais le langage m'intrigue depuis un moment, c'est pourquoi j'ai envie de tenter de coder un
projet concret pour m'initier aux bases. En l'occurence, ce sera un serveur d'authentification OAuth2, mes connaissances
sur le sujet sont relativement superficielles, c'est pourquoi je souhaite les approfondir au long de ce POK.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Les objectifs sont volontairement très (trop) optimistes, pour être certain de ne pas manquer de contenu !</p>
</div></div>
<h2>À propos de OAuth et Go</h2>
<p>OAuth est un protocole d'autorisation utilisé pour permettre à des applications tierces d'accéder aux ressources d'un
utilisateur sans divulguer les identifiants de celui-ci. Il est couramment utilisé pour permettre des connexions via des
services comme Google, Facebook, etc.</p>
<p>Go (ou Golang) est un langage de programmation développé par Google, connu pour sa simplicité, ses performances élevées,
et son support solide pour la concurrence grâce aux goroutines.</p>
<h2>Sprint 1</h2>
<h3>Planning Prévisionnel</h3>
<h4>1.1 Introduction à Go</h4>
<ul>
<li>[X] Configurer l'environnement de développement Go.</li>
<li>[X] Parcourir les tutoriels de base sur Go.</li>
<li>[X] Écrire quelques programmes simples pour se familiariser avec la syntaxe et les concepts de Go.</li>
</ul>
<h4>1.2 Concepts de base d'OAuth2</h4>
<ul>
<li>[X] Étudier le protocole OAuth2 (RFC 6749).</li>
<li>[X] Comprendre les différents rôles (Client, Ressource Owner, Authorization Server, Resource Server).</li>
<li>[X] Examiner les types de flux (Authorization Code, Implicit, Resource Owner Password Credentials, Client Credentials).</li>
</ul>
<h4>1.3 Développement initial</h4>
<ul>
<li>[X] Créer un projet Go pour le serveur OAuth2.</li>
<li>[X] Implémenter une première version du serveur OAuth2 avec les routes de base pour l'autorisation et les tokens.</li>
<li>[X] Tester les premières implémentations avec des clients simples.</li>
</ul>
<p><em>Propositions pour le Sprint 2</em></p>
<h4>2.1 Tests et Client</h4>
<ul>
<li>[ ] Écrire des tests unitaires pour quelques fonctions internes.</li>
<li>[ ] Écrire des tests d'intégration pour les routes principales.</li>
<li>[ ] Créer une page de connection avec Java Spring Boot Oauth.</li>
</ul>
<h4>2.2 Persistence des données</h4>
<ul>
<li>[ ] Choisir et configurer une base de données (ex. MySQL).</li>
<li>[ ] Mettre en place les schémas de base pour stocker les utilisateurs, les clients OAuth2, et les tokens.</li>
</ul>
<h3>Horodatage</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Heures passées</th>
<th>Indications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Samedi 07/09</td>
<td>2H</td>
<td>Introduction à Go</td>
</tr>
<tr>
<td>Lundi 10/09</td>
<td>4H</td>
<td>Concepts d'OAuth2</td>
</tr>
<tr>
<td>Mardi 11/09</td>
<td>4H</td>
<td>Serveur Basique</td>
</tr>
<tr>
<td>Mercredi 12/09</td>
<td>5H</td>
<td>Intégration à Redis</td>
</tr>
<tr>
<td>Samedi 13/09</td>
<td>4H</td>
<td>Token Rotation</td>
</tr>
<tr>
<td>Dimanche 13/09</td>
<td>2H</td>
<td>Fausse Routes Protégées</td>
</tr>
<tr>
<td>Lundi 13/09</td>
<td>4H</td>
<td>OAuth2.1 &amp; GitHub</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td><strong>25H</strong></td>
<td><strong>Petit Overtime...</strong></td>
</tr>
</tbody>
</table>
<h3>Rétro</h3>
<p>J'ai un peu abusé... le sujet m'intéresse beaucoup et j'avais envie de bien travailler sur un projet pour
avoir des choses à mettre sur mon GitHub. Étant donné que j'ai tendance à hyper-focus, il va falloir que
je me fixe des limites dures pour le prochain sprint pour éviter d'en faire trop.</p>
<p>Néanmoins, j'ai pu faire le gros du travail de prototypage les 10 premières heures. Travail que j'ai
ensuite raffiné les heures suivantes dont je parlerais dans des parties supplémentaires.</p>
<p>Mon plan pour le sprint 2 ne change que très peu (encore très fourni) car je n'ai volontairement pas
beaucoup touché à ce qui était prévu pour le second sprint.</p>
<p>Pour mieux respecter les objectifs de temps, je vais utiliser un minuteur plutôt qu'un chronomètre
pour l'horodatage et apposer des estimations de temps aux étapes prévues pour le sprint.</p>
<h3>Introduction à Go</h3>
<p>Quel meilleur endroit pour faire connaissance avec un langage que la doc ?!
J'ai commencé par me balader sur un <a href="https://go.dev/tour/">tutoriel interfactif</a> disponible sur le site du langage.</p>
<p>On y constate en effet la grande simplicité du langage</p>
<ul>
<li>2 structures de données disponibles par défault (dictionnaires <code>map[T]T</code> et arrays <code>[]T</code>)</li>
<li>seules les boucles <code>for</code> existent</li>
<li>pas d'héritage (le type embedding permet une fonctionnalité similaire.)</li>
<li>seulement deux types de visibilités (public et package private) choisies en fonction de la casse du premier caractère</li>
<li>les erreurs sont des valeurs</li>
</ul>
<p>Les channels sont au cœur du langage, mais je n'ai pas trop eu l'occasion d'y toucher.
Elles permettent une grande flexibilité et aisance dans la gestion de l'asynchrone.</p>
<p>Une fois le tutoriel complété, j'ai directement décidé de me mettre les mains à la patte
pour me mettre en conditions réelles.</p>
<p>Pour plus d'informations n'hésitez pas à aller voir les POK&amp;MON existants sur Go</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">
<p><a href="../../../Gonin-Emma/mon/temps-1.1">MON d'Emma</a></p>
</div></div>
<h3>Concepts de base d'OAuth2</h3>
<p>OAuth (Open Authorization) est un protocole d'autorisation standardisé permettant à des applications tierces d'accéder
aux ressources d'un utilisateur sans divulguer les identifiants de celui-ci.
OAuth est souvent utilisé pour permettre des connexions via des services comme Google, Facebook, etc.,
tout en renforçant la sécurité.</p>
<p>Voici une image pour illustrer rapidement le rôle du serveur d'authentification (Dropbox dans le cas ci-dessous)
<img src="basic-auth-flow.png" alt="Illustration de l'authentification"></p>
<p>L'objectif premier du protocole OAuth est simple : transmettre un token (~équivalent à une clé numérique)
à une application tierce pour que celle-ci puisse faire des actions en tant que l'utilisateur qui
a consenti à lui donner certains droits. Par exemple, sur l'image d'au-dessus, l'application à le
droit d'accéder aux fichiers dropbox de l'utilisateur.</p>
<p>Comme pour beaucoup de processus de sécurité ou d'authentification, la communication s'établie
en plusieurs étapes, car elle a pour objectif de vérifier tout un tas de choses sur les parties prenantes
que l'on détaillera lors de l'explication du flow authorization code avec PKCE.</p>
<p>Pour mieux comprendre les concepts clés, j'ai passé un long moment à lire la <a href="https://datatracker.ietf.org/doc/html/rfc6749">spécification OAuth2</a>,
suite à quoi j'ai utilisé le <a href="https://www.oauth.com/playground/">playground OAuth</a> pour tester les différents flows d'authentification.</p>
<p>Plusieurs protocoles sont proposés dans la spécification pour récupérer le token cependant nous
allons nous concentrer sur un seul, principalement, car c'est le plus recommandé et sécurisé,
mais aussi puisque c'est d'après moi le plus intéressant.</p>
<h4>Protocole avec code autorisation et PKCE</h4>
<p>Ce <a href="https://www.oauth.com/playground/authorization-code.html">playground</a> est une petite merveille pour mieux comprendre
le protocole utilisé, je conseille de faire une tour dessus avant la lecture des paragraphes suivants.</p>
<p><img src="authorization-code-flow.png" alt="Authorization Code Flow">
Ici, okta est le serveur d'authentification et le 'resource server' peut être utilisé pour récupérer des données à partir des tokens fournis par okta.
<em>Tout à l'heure Dropbox était responsable à la fois de l'authentification et de ressources, ce n'est pas toujours le cas.</em></p>
<h4>Développement Initial</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Le code que j'ai écrit lors de ce POK est disponible sur un <a href="https://github.com/ValentinBilla/GoAuth2.0">répository GitHub</a>.</p>
</div></div>
<h2>Sprint 2</h2>
<h3>Planning Prévisionnel</h3>
<h4>2.1 Tests et Client</h4>
<ul>
<li>[ ] Écrire des tests unitaires pour quelques fonctions internes.</li>
<li>[ ] Écrire des tests d'intégration pour les routes principales.</li>
</ul>
<h4>2.2 Persistence des données</h4>
<ul>
<li>[ ] Choisir et configurer une base de données (ex. MySQL).</li>
<li>[ ] Mettre en place les schémas de base pour stocker les utilisateurs, les clients OAuth2, et les tokens.</li>
</ul>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li><a href="https://go.dev">Site officiel de Go</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc6749">Spécification OAuth2.0</a></li>
<li><a href="https://www.oauth.com/playground/">Playground OAuth2.0</a></li>
</ul>
</div></div>



</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
