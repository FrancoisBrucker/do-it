
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Redécouvrir Excel et VBA</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Redécouvrir Excel et VBA</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 2</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Excel</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">VBA</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Informatique</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Juliette Kocupyr</li>
                
            </ul>
        </div>
    

    
</div>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Juliette-Kocupyr/">Juliette Kocupyr</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Juliette-Kocupyr/mon/">MON de Juliette Kocupyr</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Juliette-Kocupyr/mon/temps-2.2/">Redécouvrir Excel et VBA</a>

</div></div>




<ul>
<li>Niveau : débutant</li>
<li>Prérequis : Aucun</li>
</ul>
<p>Étant un outil du quotidien en entreprise, j’y ai souvent été confrontée lors de mes stages et j'ai eu du mal à l'exploiter au mieux. J’ai donc voulu, avec ce MON, reprendre les bases d’Excel et apprendre les fondamentaux de VBA.</p>
<h2>Les bases d'excel</h2>
<p>Pour réaliser ce travail, j’ai suivi les vidéos de la formation <a href="https://www.youtube.com/playlist?list=PL8sQnj6qF1Lv6ejdklq25MGfPJFxThMw6">Microsoft Excel 365</a>, car ce sont des vidéos de 3 à 10 minutes, qui peuvent être regardées en accéléré. C’est assez pratique et cela reprend pas à pas les bases d’Excel et les fonctions utiles. Cela peut paraître très basique, mais ça ne fait pas de mal de repartir du début, car je me suis aperçu qu’il me manquait certaines notions. J’ai appliqué de petits exercices simples pour travailler chaque notion. Étant assez rapide, j’ai regardé en complément la formation <a href="https://excel-pratique.com/fr/formation-excel">Excel-pratique</a>, car de nombreux MON existants sur le sujet ont suivi cette formation. Cela m’a permis de refaire des exercices pour compléter les notions des vidéos.</p>
<p>Parmis les notions abordées dans ces vidéos, on retrouve notamment :</p>
<ul>
<li>Les notions de bases (ajouter, copier, déplacer, agrandir, ajuster, fusionner …) des feuilles, lignes, colonnes et cellules</li>
<li>Gérer l'affichage et l'impression des feuilles Excel</li>
<li>La création de tableaux, graphiques et graphiques sparklines esthétiques</li>
<li>Les formules et calculs de base (+,-,x,/) et la notion de pourcentages</li>
<li>L'utilisation de la mise en forme conditionnelle</li>
<li>Trier et filtrer des listes et trouver le maximum et le minimum automatiquement</li>
<li>Le comptage automatique avec ou sans condition avec les fonctions NBVAL et <a href="http://NB.SI">NB.SI</a></li>
<li>L'utilisation des fonction SI, SI imbriqués, ET et OU</li>
<li>L'utilisation des fonctions ALEA, ALEA.ENTRE.BORNES et TABLEAU.ALEA pour générer des nombres aléatoires</li>
<li>Créer des listes déroulantes</li>
<li>La validation de données, la recherche de données et l'utilisation de la fonction RANG</li>
<li>Créer et gérer des tableaux et graphiques croisés dynamiques</li>
<li>Générer une carte géographique (statistique par pays) et convertir des devises automatiquement</li>
</ul>
<h2>Découvrir VBA</h2>
<p>Après avoir repris les bases d’Excel, j’ai voulu approfondir avec VBA, que je ne connaissais pas du tout. J’ai également suivi la formation <a href="https://excel-pratique.com/fr/vba">Excel-pratique</a>, car c’est celle qu’ont suivie une majorité de personnes ayant fait un MON VBA. Tout n’étant pas toujours très clair, j’ai pris le temps de regarder également la formation <a href="https://openclassrooms.com/fr/courses/8039296-decouvrez-les-fondamentaux-vba">Découvrez les fondamentaux de VBA</a> d’OpenClassrooms. Cette dernière reprend de manière plus simplifiée le VBA, ce qui permet une introduction plus claire, en particulier lorsqu’on ne maîtrise pas bien ce sujet. Elle propose des exercices simples pour mieux appréhender ces notions.</p>
<p><strong>VBA (Visual Basic for Applications)</strong> est un langage de programmation intégré dans Microsoft Excel qui permet d'<strong>automatiser des tâches</strong>, de <strong>personnaliser des fonctions</strong> et d'<strong>interagir avec des données</strong> dans des feuilles de calcul. Grâce à VBA, vous pouvez <strong>créer des macros</strong> qui exécutent des séries d'instructions, gérer des objets Excel (comme des feuilles de calcul, des cellules, des graphiques, etc.) et ajouter de la logique conditionnelle pour des traitements complexes.</p>
<h3>Les notions clés</h3>
<p><strong>L’enregistreur de macro</strong> est un outil qui va retranscrire tout ce que vous allez faire sur Excel en code VBA automatiquement. Ainsi, vous n’avez pas besoin d’écrire du code, le logiciel le fait pour vous.
Mais il y a quand même une limitation à cela, le code n’est pas optimisé et il ne permet pas d’utiliser des variables, des boucles, des tests, etc.</p>
<p>Il est important de comprendre que le VBA est une programmation qu’on appelle <strong>programmation orientée objet (POO)</strong>. Les principaux objets pour Excel sont : Workbook, Sheets, Range, Windows, Chart. Un objet en VBA peut contenir un autre objet, des caractéristiques, des méthodes ou des événements.</p>
<ul>
<li><strong>une caractéristique</strong> est une propriété de notre objet:
police : Times, couleur : bleu, gras : non, etc.</li>
<li><strong>une méthode</strong> est un verbe, une action que nous allons faire:
les différentes méthodes peuvent être remplacer, ajouter, trier, couper, coller, etc. ce sont des actions que nous allons faire sur une cellule (avec l’objet range)</li>
<li><strong>un événement</strong> est une action qui va se produire quand une condition va être remplie:
par exemple l'événement “newsheet” de l’objet “application” permet de déclencher le lancement d’un sous-programme à chaque fois qu’on ajoute une feuille</li>
</ul>
<p>Dans la fenêtre de code, certains mots sont écrits en bleu, en noir ou en vert.</p>
<ul>
<li>Bleu : Ce sont les mots-clés.</li>
<li>Vert : Ce sont les commentaires.</li>
<li>Noir : C'est le code classique.</li>
</ul>
<img src="image22/code.png" width="40%">
<p>En cas d'erreur de code, une fenêtre d’erreur apparaît lors de l'execution. Objectivement, l’erreur décrite n’est pas vraiment parlante mais vous pouvez par contre appuyer sur <strong>“Débogage”</strong> pour voir la ligne avec l’erreur surlignée.</p>
<p><strong>Le format de base d’Excel</strong>, le XLSX, ne prend pas en charge les macros. C'est-à-dire que si vous créez une macro et que vous enregistrez le fichier en classeur Excel (.xlsx), votre macro ne sera pas sauvegardée dans le fichier Excel. C’est une mesure de sécurité pour excel. Pour enregistrer une macro, <strong>il faut passer en XLSM.</strong></p>
<p>Voici la liste des différentes extensions Excel :</p>
<ul>
<li>classeur Excel (.xlsx)</li>
<li>classeur Excel prenant en charge les macros (.xlsm)</li>
<li>classeur Excel binaire (.xlsb)</li>
<li>classeur Excel 93 - 2003 (.xls)</li>
</ul>
<p>Une bonne pratique en VBA est de mettre <strong>un mot de passe</strong> aux macros pour être le seul à pouvoir les éditer.</p>
<h3>Les variables</h3>
<p>Le VBA ne fait pas exception à la règle : comme tous les langages de programmation, il utilise des variables. Prenons une définition simple : une variable, c’est un élément auquel on affecte une valeur.</p>
<p>Déclarer une variable :</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">Dim</span> [NomVariable] <span class="token keyword">As</span> [TypeDeDonnée]</code></pre>
<h3>Les opérateurs conditionnels</h3>
<p>Parmis les opérateurs conditionnels, on retrouve des opérateurs arithmétiques, de comparaison, de logiques et de concaténation.</p>
<p><strong>Les opérateurs arithmétiques :</strong></p>
<p>Toutes les opérations arithmétiques classiques s’utilisent avec des nombres (integer, float, etc.)</p>
<img src="image22/operateur1.png" width="40%">
<p><strong>Les opérateurs de comparaison :</strong></p>
<img src="image22/operateur2.png" width="40%">
<p><strong>Les opérateurs logiques :</strong></p>
<img src="image22/operateur3.png" width="40%">
<p><strong>Les opérateurs de concaténation :</strong></p>
<p>La concaténation se fait généralement sur du <strong>texte</strong> (donc des strings). On peut utiliser l’opérateur <strong>+</strong> ou <strong>&amp;</strong> . L’opérateur  +  s’utilise pour additionner des nombres, donc par convention on va plutôt utiliser le  &amp;  et laisser le  +  aux nombres, même si les deux versions fonctionnent.</p>
<h3>Quelques fonctions de base</h3>
<br>
<h5>Les conditions</h5>
<p><strong>If...Then...Else :</strong> Permet de tester une ou plusieurs conditions et d'exécuter des actions en fonction de ces conditions.</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">If</span> [Condition] <span class="token keyword">Then</span>
    [Instructions si la condition est vraie]
<span class="token keyword">ElseIf</span> [AutreCondition] <span class="token keyword">Then</span>
    [Instructions si la deuxiè<span class="token keyword">me</span> condition est vraie]
<span class="token keyword">Else</span>
    [Instructions si aucune des conditions n<span class="token comment">'est vraie]</span>
<span class="token keyword">End</span> <span class="token keyword">If</span></code></pre>
<p><strong>Select Case :</strong> Alternative plus lisible à plusieurs If...ElseIf pour couvrir toutes les valeurs d'une variable.</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">Select</span> <span class="token keyword">Case</span> [Variable]
    <span class="token keyword">Case</span> [Valeur <span class="token number">1</span>]
        [Instructions pour la valeur <span class="token number">1</span>]
    <span class="token keyword">Case</span> [Valeur <span class="token number">2</span>]<span class="token punctuation">,</span> [Valeur <span class="token number">3</span>]
        [Instructions pour la valeur <span class="token number">2</span> et <span class="token number">3</span>]
    <span class="token keyword">Case</span> <span class="token keyword">Else</span>
        [Instructions si aucune des valeurs ne correspond]
<span class="token keyword">End</span> <span class="token keyword">Select</span></code></pre>
<h5>Les boucles</h5>
<p><strong>For...Next :</strong> Utilisé pour répéter un bloc d'instructions un nombre spécifique de fois.</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">For</span> [Compteur] <span class="token operator">=</span> [ValeurInitiale] <span class="token keyword">To</span> [ValeurFinale] [<span class="token keyword">Step</span> [Incrément]]
    [Instructions]
<span class="token keyword">Next</span> [Compteur]</code></pre>
<p><strong>For...Each :</strong>  Permet d'itérer à travers une collection d'objets ou une plage de données, sans avoir à se soucier de l'index (numéro de ligne ou de colonne).</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">For</span> <span class="token keyword">Each</span> [Élément] <span class="token keyword">In</span> [Collection] [Instructions]
<span class="token keyword">Next</span> [Élément]</code></pre>
<p><strong>Do...Loop  :</strong> Boucles qui exécutent un bloc d'instructions tant qu'une condition est vraie. Le  Do  a un fonctionnement assez similaire au  For, à la nuance près qu’il n’y a pas d’incrémentation automatique.</p>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">Do</span> <span class="token keyword">While</span> [Condition]
    [Instructions]
<span class="token keyword">Loop</span></code></pre>
<pre class="language-vba"><code class="language-vba"><span class="token keyword">Do</span> <span class="token keyword">Until</span> [Condition]
    [Instructions]
<span class="token keyword">Loop</span></code></pre>
<p>Il existe des instructions pour sortir des boucles en cas de blocage notamment : <strong>Exit For</strong> pour les boucles For et <strong>Exit Do</strong> pour les boucles Do.</p>
<h5>Les boîtes de dialogue</h5>
<p><strong>MsgBox :</strong> Affiche une boîte de message dans Excel pour informer l'utilisateur ou récupérer une réponse.</p>
<pre class="language-vba"><code class="language-vba">MsgBox <span class="token punctuation">(</span>[Message]<span class="token punctuation">,</span> [Bouton]<span class="token punctuation">,</span> [Titre]<span class="token punctuation">)</span></code></pre>
<p>Voici les différents boutons existant :</p>
<img src="image22/bouton.png" width="50%">
<h2>Conclusion</h2>
<p>Revoir les bases d’excel s'est avéré très utile mais découvrir VBA m’a pris beaucoup de temps je n’ai pas pu réellement appliquer toutes les notions parcourues. Ce travail sera donc l'objectif d’un prochain projet.</p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développement et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>
        <script src="/do-it/assets/node_modules/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    </body>
</html>
