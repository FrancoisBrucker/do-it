
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MON 1.2 : à la conquête d’excel</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">MON 1.2 : à la conquête d’excel</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 1</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Ménager Jeanne</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Au cours de mon stage, j’ai remarqué que des étudiants d’école de commerce avait une grande maitrise de fonctionnalités que je ne soupçonnais pas d’exister sur Excel, je souhaite donc monter en compétence sur ce sujet

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Menager-Jeanne/">Jeanne MENAGER</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Menager-Jeanne/mon/">MON de Jeanne Ménager</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Menager-Jeanne/mon/temps-1.2/">MON 1.2 : à la conquête d’excel</a>

</div></div>




<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<p><a href="https://excel-pratique.com/fr/vba/introduction">Introduction au langage VBA</a></p>
</div></div>

<h2>Revoir les bases de Excel</h2>
<p>Comme je n'avais pas utilisé excel depuis très longtemps, j'ai commencé par revoir les bases comme par exemple, étendre le contenu d'une cellule mais aussi faire en sorte qu'un élément ne change pas lorsque qu'on étend la cellule en écrivant <code>$B$9</code> à la place de <code>B9</code>, j'ai aussi réappris à séléctionner une plage de cellule grâce à <code>B2:C5</code>. J'ai ensuite appris à utiliser le fonction <code>SI</code> afin de conditionner la valeur d'une cellule et appris à faire des listes de choix pour préremplir un excel.</p>
<h2>Qu'est-ce que le VBA</h2>
<p>Une fois ces bases de nouveau aquise, j'ai voulu apprendre le VBA. <br>
Le VBA est un langage de programation qui sert notamment à automatiser certaines taches pénibles sur Excel qu'on effectue régulièrement, par exemple tous les matins ou tous les mois. On peut aussi créer un bouton pour que l'automatisation se lance à ce moment là. Les taches que l'on peut automatiser sont par exemple de renplir un tableau à partir d'une base de données, en séléctionnant les informations qui nous intéressent, on peut aussi changer les noms de feuilles ou les colonnes.</p>
<h2>Ma première VBA</h2>
<p>J'ai tout d'abords appris à générer une VBA grâce au bouton d'enregistrement : avec cette méthode, il n'y a pas besoin de savoir coder car nos actions sont directement enregistrées créant ainsi une macro.</p>
<p>Dans l'éditeur, la VBA se présente ainsi :</p>
<p><img src="Exemple_macro.png" alt="Capture d'écran d'un exemple de macro"></p>
<p>On y retrouve la structure d'une macro qui commence par <code>Sub nomDeLaMacro()</code> et qui fini par <code>End Sub()</code>. <br>
Les commentaires sont écrit entre appostrophes et sont repérables par leur couleur verte. \</p>
<p>On peut voir sur la capture d'écran que j'ai selectionné puis supprimé la colonne A puis la C et mis la colonne B à la place de la A et la D à la place de la C. \</p>
<p>J'ai ensuite fait un bouton pour qu'à chaque fois qu'on clique dessus, cette action se refasse :</p>
<video controls="" autoplay="" loop="">
  <source src="macro1.mp4" type="video/mp4">
</video>
<h2>Identifier une cellule ou un ensemble de cellules</h2>
<p><strong>Range(&quot;A8&quot;)</strong> désigne la cellule A8, en remplaçant A8 par <strong>&quot;A8,C5&quot;</strong> on parle des deux cellules et <strong>&quot;A1:A8&quot;</strong> signifie les cellules de A1 à A8. <br>
Il est aussi possible de désigner des lignes grâce à <strong>Range(&quot;2:6&quot;)</strong> ou <strong>Rows(&quot;2:6&quot;)</strong> pour les lignes de 2 à 6. De même avec les colonnes : <strong>Range(&quot;B:G&quot;)</strong> et <strong>Columns(&quot;B:G&quot;)</strong> désignent les colonnes de B à G.<br>
Enfin, avec <strong>Cells(8,1)</strong> on parle de la case dans la première colonne, à la huitième ligne.</p>
<p>Pour désigner une cellule sur une autre feuille, il faut ajouter avant le Range, <strong>Sheets(&quot;nom_de_la_feuille&quot;).</strong><br>
Et si cette feuille est sur un autre classeur ouvert, il faut en plus ajouter <strong>Workbooks(&quot;nom_du_classeur.xlsx&quot;).</strong>\</p>
<h2>Action sur les cellules</h2>
<p>Maintenant que nous savons identifier une cellule, nous allons pouvoir lui faire subir des transformations grâce à notre macro :</p>
<ol>
<li>Séléctionner : en ajoutant <code>.Select</code></li>
<li>Modifier la valeur : en ajoutant <code>.Value</code>et en choisissant la nouvelle valeur avec un signe égal</li>
<li>Modifier le style de texte : grâce à <code>.Font</code> et ses options : <code>.Size</code>, <code>.Bold</code>, <code>.Italic</code>, <code>.Underline</code>,<code>.Name</code> ou encore <code>.Color = RGB(..., ..., ...)</code></li>
<li>Modifier les contours : en écrivant <code>.Borders.Value</code> pour définir l'épaisseur ou <code>.Borders.Color</code> pour choisir la couleur</li>
<li>Modifier le fond : avec <code>.Interior.Color</code></li>
</ol>
<h2>Les variables</h2>
<p>Pour déclarer une variable, on écrit :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Dim</span> maVariable <span class="token keyword">As</span> <span class="token keyword">Type</span>
  maVariable <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>Cette variable est utilisable uniquement dans la procédure où elle est déclarée.
Il existe de nombreux types de variables :</p>
<p><img src="type.png" alt="Types de variables"></p>
<p>Et si l'utilisateur veut créer son propre type, il peut :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Type</span> Utilisateur
  Nom <span class="token keyword">As</span> <span class="token keyword">String</span>
  Prenom <span class="token keyword">As</span> <span class="token keyword">String</span>
<span class="token keyword">End</span> <span class="token keyword">Type</span>

<span class="token keyword">Dim</span> user <span class="token keyword">As</span> Utilisateur
  user<span class="token punctuation">.</span>nom <span class="token operator">=</span> Menager
  user<span class="token punctuation">.</span>prenom <span class="token operator">=</span> Jeanne
</code></pre>
<p>En remplaçant <code>Dim</code> par <code>Const</code>, on définit cette fois une constante dont la valeur ne pourra pas changer. Ceci est utile lorsque qu'on utilise plusieurs fois une même valeur fixée comme le taux de TVA par exemple.</p>
<h2>Les tableaux</h2>
<p>Lorsqu'on a beaucoup de variables, il est plus intéréssant de les rentrer dans un grand tableau, pour les créer, on écrit :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Dim</span> tab1<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
  tab1<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab1<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab1<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab1<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>On a ici créé un tableau avec 1 colonne et 4 lignes et on l'a remplit de valeur de type String</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Dim</span> tab2<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
  tab2<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab2<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab2<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  tab2<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>Cette fois, le tableau a 7 lignes et 5 colonnes, il est donc très long à remplir, c'est pourquoi, en VBA, il existe aussi des boucles</p>
<h2>Les Boucles et tests</h2>
<h3>Boucle For</h3>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">5</span>
  <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">Next</span>
</code></pre>
<p>Le pas est par défault à 1 mais on peut le changer en écrivant <code>For i = 5 To 1 Step -1</code></p>
<p>Dans une boucle for, les instuctions vont s'effectuer un nombre définit de fois car i va changer de valeur à chaque itération en fonction du pas définit par Step.</p>
<h3>Le test If</h3>
<p>Le test if permet de vérifier une condition avant d'effectuer un instruction. Il permet aussi de traiter les cas non conformes à la condition grâce aux else if et else.</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">If</span> condition <span class="token keyword">Then</span> 
  <span class="token comment">'Instructions à effectuer'</span>
  <span class="token keyword">ElseIf</span> condition2 
    <span class="token comment">'Instructions à effectuer'</span>
  <span class="token keyword">Else</span> 
    <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">End</span> <span class="token keyword">If</span>
</code></pre>
<p>On peut avoir autant de ElseIf que l'on souhaite mais à partir du moment où une première condition est remplie, les instructions associées seront effectuées, mais pas les autre, même si d'autres conditions sont remplies.</p>
<h3>Case</h3>
<p>Case permet de simplifier des If trop compliqués :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Select</span> <span class="token keyword">case</span> variable
  <span class="token keyword">Case</span> <span class="token keyword">Is</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">Case</span> <span class="token keyword">Is</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">Case</span> <span class="token keyword">Else</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">End</span> <span class="token keyword">Select</span>
</code></pre>
<p>On va ici comparer la variable <em>variable</em> aux valeurs associées aux Case Is.</p>
<h3>Boucle Do</h3>
<p>Cette boucle permet d'efféctuer des instructions tant qu'une condition est vraie :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Do</span> <span class="token keyword">while</span> condition
  <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">Loop</span>
</code></pre>
<p>Dans cette situation, si la condition n'est pas vraie, les instructions ne vont jamais être exécutées. À la place, on peut utiliser cette écriture pour s'assurer que l'on passe au moins une fois dans la boucle.</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Do</span> 
  <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">Loop</span> <span class="token keyword">while</span> condition
</code></pre>
<p>Enfin, on peut avoir besoin d'effectuer une action tant qu'une condition n'a pas été remplie, on écrira donc :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">Do</span> <span class="token keyword">until</span> condition
  <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">Loop</span> 
</code></pre>
<h3>Boucle For Each</h3>
<p>Le For Each fonctionnne comme un for sauf qu'il ne dépend pas d'une variable qui s'incrémente mais de la présence ou nous d'éléments dans un ensemble donné</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba"><span class="token keyword">For</span> <span class="token keyword">Each</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">In</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token comment">'Instructions à effectuer'</span>
<span class="token keyword">Next</span>
</code></pre>
<h2>Fonctions utiles</h2>
<p><strong>IsNumeric(...)</strong> permet de vérifier que l'argument est un nombre, renvoie True ou False <br>
<strong>IsDate(...)</strong> permet de vérifier que l'argument est une date, renvoie True ou False <br>
<strong>Day(...)</strong> renvoit le numéro du jour (si on lui donne le 16 octobre 2024, on obtient 16) <br>
<strong>Year(...)</strong> renvoit l'année de la date passée en argument <br>
<strong>Weekday(...)</strong> renvoit un nombre en 1 et 7 en fonction du jour de la semaine <br>
<strong>Date</strong> renvoit la Date du jour <br>
<strong>&quot;expression&quot; Like &quot;...&quot;</strong> vérifie si l'ensemble de caratère est présent dans l'expression <br>
Voici un exemple de test que l'on peut effectuer avec la fonction Like :</p>
<p><img src="Like.png" alt="Correspondance avec Like"></p>
<h2>Boites de dialogue</h2>
<p>Avec le VBA, on peut afficher des boites de dialogue pour interragir avec l'utilisateur:</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba">MsgBox<span class="token punctuation">(</span>[Texte]<span class="token punctuation">,</span> [Boutons]<span class="token punctuation">,</span> [Titre]<span class="token punctuation">)</span>
</code></pre>
<p>Les choix de boutons sont les suivants :
<img src="option.png" alt="Option de boutons">
Lorsque l'utilisateur clique sur un bouton, une valeur et renvoyée et nous pouvons filtrer celle-ci:
<img src="response.png" alt="Réponse de boutons"></p>
<p>Il est aussi possible d'afficher des boites de dialogue dans lesquelles l'utilisateur peut écrire :</p>
<pre class="language-vba " style="counter-reset: linenumber 0"><code class="language-vba">InputBox<span class="token punctuation">(</span>[Texte]<span class="token punctuation">,</span> [Titre]<span class="token punctuation">,</span> [Valeur par défaut]<span class="token punctuation">)</span>
</code></pre>
<h2>Conclusion</h2>
<p>Le VBA peut être très utile pour automatiser des tâches longues car c'est un outils très complet</p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
