
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>VBA, découverte du langage et automatisation de tâches</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">VBA, découverte du langage et automatisation de tâches</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">VBA</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Charles Cook</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Introduction au VBA et utilisation des macro pour des tâches chronophages.

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Charles-Cook/">Charles Cook</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Charles-Cook/mon/">MON de Charles Cook</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Charles-Cook/mon/temps-1.1/">VBA, découverte du langage et automatisation de tâches</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mr-8">
<p>Aucun prérequis</p>
</div></div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<p>Les lien utiles pour la compréhension de celui-ci.</p>
</div></div>

<p>Ce premier MON fait suite à une problématique rencontrée lors de chacun de mes stages de césure, au cours desquels j'ai été confronté a des &quot;macros&quot; à corriger ou compléter. Ces &quot;macros&quot; permettaient d'automatiser des tâches pouvant être longues et chronophages sur Excel.</p>
<ul>
<li>le niveau et les prérequis nécessaires en utilisant la balise <a href="/do-it/cs/contribuer-au-site/#prerequis"><code>prerequis</code></a></li>
<li>les autres POK &amp; MON en rapport en utilisant la balise <a href="/do-it/cs/contribuer-au-site/#lien"><code>lien</code></a></li>
</ul>
<h2>Table des matières</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#cas-demploi-du-langage-vba">Cas d'emploi du langage VBA</a>
<ul>
<li><a href="#interaction-avec-lutilisateur-par-la-cr%C3%A9ation-de-bo%C3%AEtes-de-dialogue">Interaction avec l'utilisateur par la création de boîtes de dialogue</a></li>
<li><a href="#utilisation-de-variables">Utilisation de variables</a></li>
<li><a href="#les-conditions">Les conditions</a></li>
<li><a href="#les-boucles">Les boucles</a></li>
<li><a href="#les-tableaux">Les tableaux</a></li>
</ul>
</li>
<li><a href="#application-simple">Application simple</a>
<ul>
<li><a href="#inputs">Inputs</a></li>
<li><a href="#objectif">Objectif</a></li>
<li><a href="#code">Code</a></li>
<li><a href="#r%C3%A9sultats">Résultats </a></li>
<li><a href="#pistes-dam%C3%A9lioration">Pistes d'amélioration</a></li>
</ul>
</li>
<li><a href="#sources">Sources</a></li>
</ul>
<h2>Introduction</h2>
<p>Le VBA (Visual Basic for Application) est un langage de programmation commun à toutes les applications de la suite Microsoft Office, qui permet d'automatiser des traitements et d'ajouter de nouvelles fonctions afin de répondre à des besoins spécifiques. Cela permet également de personnaliser les documents de travail afin de faciliter la gestion ou le reporting. Dans ce MON, nous nous intéresserons à l'utilisation du langage VBA dans le cadre d'Excel.</p>
<h2>Cas d'emploi du langage VBA</h2>
<p>Le langage VBA permet de réaliser un certain nombre d'actions :</p>
<h3>Interaction avec l'utilisateur par la création de boîtes de dialogue</h3>
<h4>MsgBox (Texte, Boutons, Titre)</h4>
<p>Cette fonction permet simplement d'afficher un message à l'utilisateur lors de l'exécution de la Macro :</p>
<pre><code>Sub exemple()
    MsgBox &quot;Welcome in this Worksheet!&quot;
End Sub
</code></pre>
<p>Elle peut également être utilisée pour demander confirmation de réalisation de la Macro :</p>
<pre><code>Sub exemple()
    If MsgBox(&quot;Confirmation de suppression de la colonne A ?&quot;, vbYesNo, &quot;Demande de confirmation&quot;) = vbYes Then
        Columns(&quot;A&quot;).ClearContents
    End If
End Sub
</code></pre>
<p>La boîte de dialogue de confirmation qui s'affiche est alors la suivante :</p>
<p><img src="Images/BoiteDeDialogue.png" alt="alt text"></p>
<h4>InputBox (Texte, Titre, Valeur par défaut)</h4>
<p>Cette fonction permet de demander à l'utilisateur de rentrer une valeur dans la boîte de dialogue. Ainsi, le code suivant demande à l'utilisateur de rentrer son nom, avec comme valeur par défaut &quot;NOM&quot;, puis affiche le message &quot;Welcome Nom!&quot; :</p>
<pre><code>Sub exemple()
    Dim NomUtilisateur As String

    resultat = InputBox(&quot;Entrez votre nom&quot;, &quot;Demande renseignement&quot;, &quot;NOM&quot;)

    MsgBox &quot;Welcome &quot; &amp; resultat &amp; &quot;!&quot;
End Sub
</code></pre>
<p><img src="Images/DemandeEntree.png" alt="alt text"></p>
<h3>Utilisation de variables</h3>
<p>Les variables sont utilisées en VBA pour stocker et manipuler des données. Il faut pour cela les déclarer au préalable en précisant leur type.
Le code suivant stock les différents composants de l'adresse de Centrale Méditerranée sous forme de variables pour afficher celle-ci dans une boîte de dialogue :</p>
<pre><code>Sub exemple()
    Dim Numero As Integer, Rue As String, Code_Postal As Integer, Ville As String

    Numero = 38
    Rue = Frédéric Joliot Curie
    Code_Postal = 13013
    Ville = Marseille

    MsgBox Numero &amp; &quot;Rue&quot; &amp; Rue &amp; Code_Postal &amp; Ville
End Sub
</code></pre>
<h3>Les conditions</h3>
<p>Les conditions sont utilisées pour vérifier une caractéritsique avant la réalisation d'une Macro, ou alors réaliser une action différente en fonction du type ou de la valeur d'une donnée.</p>
<p>Penons l'exemple d'une feuille excel comprenant respectivement dans les cellule A1, B1 et C1 le prénom, nom et ville de l'école d'un étudiant centralien. Le code suivant permet donc de vérfier que toutes les informations sont bien renseignées (il n'y a pas de case vide), puis de donner l'adresse mail associée dans la celulle D1. Un message d'erreur s'affiche si la ville renseignée ne correspond pas à une école du groupe <em>Centrale</em> :</p>
<pre><code>Sub exemple()
    Dim nom As String, prenom As String, ville As String, ecole As String

    If IsEmpty(Range(&quot;A1&quot;)) Or IsEmpty(Range(&quot;B1&quot;)) Or IsEmpty(Range(&quot;C1&quot;)) Then
        MsgBox &quot;Donnée manquante&quot;
    Else
        prenom = Range(&quot;A1&quot;)
        nom = Range(&quot;B1&quot;)
        ville = Range(&quot;C1&quot;)
        Select Case ville
            Case Is = &quot;Marseille&quot;
                ecole = &quot;med&quot;
            Case Is = &quot;Paris&quot;
                ecole = &quot;supelec&quot;
            Case Is = &quot;Lille&quot;
                ecole = &quot;lille&quot;
            Case Is = &quot;Nantes&quot;
                ecole = &quot;nantes&quot;
            Case Is = &quot;Lyon&quot;
                ecole = &quot;lyon&quot;
            Case Else
                MsgBox &quot;Erreur ville&quot;
        End Select
        Range(&quot;D1&quot;) = prenom &amp; &quot;.&quot; &amp; nom &amp; &quot;@centrale-&quot; &amp; ecole &amp; &quot;.fr&quot;
   
    End If
        
End Sub
</code></pre>
<h3>Les boucles</h3>
<p>Les boucles sont utilisées pour répéter des instructions tout en allégant le code, afin de ne pas répéter la même instructions plusieurs fois dans une même macro.</p>
<h4>Do While</h4>
<p>Cette fonction permet de réaliser instruction tant que la condition est vraie :</p>
<pre><code>Sub exemple()
    Do While [CONDITION]
        *Instruction*
    Loop
End Sub
</code></pre>
<h4>Do Until</h4>
<p>Cette fonction permet de réaliser une instruction jusqu'à ce que la condition soit vraie :</p>
<pre><code>Sub exemple()
    Do Until [CONDITION]
        *Instruction*
    Loop
End Sub
</code></pre>
<h4>For Next</h4>
<p>Cette fonction permet de réaliser une instruction pour un indice variant d'une valeur à une autre :</p>
<pre><code>Sub exemple()
    Dim k As Integer
        
    For k = 1 To 10
        *Instruction*
        k=k+1
    Next
End Sub
</code></pre>
<h3>Les tableaux</h3>
<p>Les tableaux sont utilisés en langage VBA afin de stocker un grand nombre de valeur contrairement aux variables qui ne permettent le stockage que d'une unique valeur. De plus, stocker les valeurs d'une base de données sous forme de tableau permet d'accéder et de manipuler les données plus facilement.</p>
<p>La fonction suivante permet de créer un tableau avec i lignes et j colonnes :</p>
<pre><code>Sub exemple()
    Dim tableau(i-1,j-1)
End sub
</code></pre>
<p>On peut ensuite accéder à chaque donnée du tableau en écrivant =</p>
<pre><code>tableau(n,m)
</code></pre>
<p>Avec n le numéro de la ligne et m le numéro de la colonne.</p>
<h2>Application simple</h2>
<p>L'objectif de cette dernière partie est de mettre en pratique dans un exemple simple les différents éléments que nous avons vu ci-dessus. Ainsi, le but est de parvenir, à partir d'une base de données contenant une liste d'élèves centraliens, à créer l'adresse mail associée à chacun et extraire les élèves centraliens de Marseille sur une feuille à part afin de simplifier la consultation de leurs informations.</p>
<h3>Inputs</h3>
<p>La base donnée servant d'imput comprend 4 colonnes, contenant dans l'ordre les informations suivantes :</p>
<ul>
<li>Prénom</li>
<li>Nom</li>
<li>Ville (de l'école centrale)</li>
<li>Année d'étude (1, 2 ou 3)</li>
</ul>
<p>Pour cet exemple, la base de données contient 100 étudiants.</p>
<h3>Objectif</h3>
<p>L'objectif est d'automatiser un certain nombre d'actions :</p>
<ul>
<li>Création de l'adresse mail de chaque étudiant comprenant son nomn son prénom et son école</li>
<li>L'extraction de la liste des élèves centraliens étudiants à Marseille</li>
<li>La création d'une nouvelle feuille affichant ces élèves</li>
</ul>
<h3>Code</h3>
<p>Le code commenté ci-après :</p>
<pre><code>Sub Trie()
    Dim nom As String, prenom As String, ville As String, ecole As String, i As Integer, j As Integer, k As Integer, tableau(99, 3)
    j = 1   'Compteur qui va permettre de créer le tableau des étudiants de centrale Marseille
    k = 1   'Compteur qui va permettre d'afficher les étudiants de centrale Marseille dans une nouvelle feuille
    For i = 1 To 100     'Compteur qui va permettre de passer en revue l'ensemble de la base de données
        prenom = Range(&quot;A&quot; &amp; i + 1)
        nom = Range(&quot;B&quot; &amp; i + 1)
        ville = LCase(Trim(Range(&quot;C&quot; &amp; i + 1)))     'LCase et Trim permettent de comparer lessuites de caractères sans prendre en compte les majuscules ou les espaces
            If ville = &quot;marseille&quot; Then
                ecole = &quot;med&quot;
                
                'Création du tableau pour les élèves de centrale Marseille
                
                tableau(j - 1, 0) = Range(&quot;A&quot; &amp; i + 1)
                tableau(j - 1, 1) = Range(&quot;B&quot; &amp; i + 1)
                tableau(j - 1, 2) = Range(&quot;C&quot; &amp; i + 1)
                tableau(j - 1, 3) = Range(&quot;D&quot; &amp; i + 1) &amp; &quot;A&quot;
                j = j + 1
            ElseIf ville = &quot;paris&quot; Then
                ecole = &quot;supelec&quot;
            ElseIf ville = &quot;lille&quot; Then
                ecole = &quot;lille&quot;
            ElseIf ville = &quot;nantes&quot; Then
                ecole = &quot;nantes&quot;
            Else
                ecole = &quot;lyon&quot;
        End If
    Range(&quot;E&quot; &amp; i + 1) = prenom &amp; &quot;.&quot; &amp; nom &amp; &quot;@centrale-&quot; &amp; ecole &amp; &quot;.fr&quot;  'Création de l'adresse mail
    Next
    
'Affichage du tableau dans une nouvelle feuille &quot;ECM&quot; afin de pouvoir voir les élèves de centrale Marseille

For k = 1 To 100
    Sheets(&quot;ECM&quot;).Range(&quot;A&quot; &amp; k) = tableau(k - 1, 0)
    Sheets(&quot;ECM&quot;).Range(&quot;B&quot; &amp; k) = tableau(k - 1, 1)
    Sheets(&quot;ECM&quot;).Range(&quot;C&quot; &amp; k) = tableau(k - 1, 2)
    Sheets(&quot;ECM&quot;).Range(&quot;D&quot; &amp; k) = tableau(k - 1, 3)
Next
    
End Sub
</code></pre>
<h3>Résultats</h3>
<p>Les résultats obtenus après avoir exécuté la macro sont les suivants :</p>
<p><em>Création des adresses mail</em></p>
<p><img src="Images/AdressesMails.png" alt="alt text"></p>
<p><em>Extraction des centraliens de Marseille</em></p>
<p><img src="Images/ElevesECM.png" alt="alt text"></p>
<h3>Pistes d'amélioration</h3>
<p>Il est possible d'améliorer le code suivant avec les éléments suivants :</p>
<ul>
<li>Trie des élèves par année, ordre alphabétique et école.</li>
<li>Création automatique d'une nouvelle feuille par école pour l'extraction des étudiants.</li>
</ul>
<h2>Sources</h2>
<p>Pour me former au langage VBA, j'ai utilisé les cours <a href="https://excel-pratique.com/fr/vba">Excel Pratique</a></p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
