
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Étude statistique des Pokémons avec les outils Excel</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Étude statistique des Pokémons avec les outils Excel</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">POK</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2024-2025</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 1</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Excel</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">vert</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">données</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Lola Perdrix</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Prise en main des outils d'Excel pour la gestion et l'analyse d'un dataset à travers la réalisation d'un rapport d'analyse statistique complet sur les Pokémons

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/">2024-2025</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Lola-Perdrix/">Lola Perdrix</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Lola-Perdrix/pok/">POK de Lola Perdrix</a><span class="px-1">/</span><a href="/do-it/promos/2024-2025/Lola-Perdrix/pok/temps-1/">Étude statistique des Pokémons avec les outils Excel</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mr-8">
<p>Prérequis : Quelques bases d'Excel</p>
</div></div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li>MON de Lola Bourdon : <a href="https://francoisbrucker.github.io/do-it/promos/2023-2024/Lola-Bourdon/mon/temps-1.2/">Excel - repartir sur de bonnes bases</a></li>
<li>OpenClassrooms : <a href="https://openclassrooms.com/fr/courses/7168336-maitrisez-les-fondamentaux-dexcel">Maîtrisez les fondamentaux d'Excel</a></li>
</ul>
</div></div>

<h2>Objectif</h2>
<p>L'objectif est de prendre en main les outils mis à disposition par Excel pour étudier une base de données, de sa structuration à sa visualisation. Pour cela, je souhaite réaliser une étude statistique complète à partir de datasets sur les Pokémons, l'objectif final étant de produire un rapport descriptif complet sous Excel en utilisant au maximum les outils Excel disponibles.</p>
<h2>Tâches</h2>
<h3>Sprint 1</h3>
<ul>
<li>[x] Téléchargement et import de mon dataset dans Excel (estimé 10min, réalisé 10min)</li>
<li>[x] Recherche documentaire sur les fonctionnalités d'Excel qui vont m'être utiles, choix des sources, apprentissage théorique (estimé 2h, réalisé 1h30)</li>
<li>[x] Mise en forme et nettoyage des données (estimé 1h, réalisation 4h30)</li>
<li>[x] Définition de problématiques / questions cibles (estimé 30min, réalisation 15min)</li>
<li>[x] Analyse de la première génération, réponse à chaque question définie (estimé 4h, réalisation 2h30)</li>
<li>[ ] Visualisation des résultats en comparant les différents outils (estimé 2h30, pas réalisé)</li>
</ul>
<h3>Sprint 2</h3>
<ul>
<li>[ ] Apprentissage VBA</li>
<li>[ ] Macro répétant l'analyse pour les autres générations</li>
<li>[ ] Réaliser le rapport final</li>
<li>[ ] Étudier des techniques avancées pour embellir le tout</li>
<li>[ ] Tester d'autres datasets en étudiant l'adaptabilité</li>
<li>[ ] Comparer avec d'autres logiciels</li>
</ul>
<p>à réajuster à la fin du 1er sprint</p>
<h3>Horodatage</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Heures passées</th>
<th>Indications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jeudi 12/09 matin</td>
<td>15 min</td>
<td>Téléchargement des datasets</td>
</tr>
<tr>
<td>Jeudi 12/09 aprem</td>
<td>1h30</td>
<td>Import des datasets, OpenClassroom, exploration des fonctions Excel</td>
</tr>
<tr>
<td></td>
<td>3h30</td>
<td>Préparation du dataset</td>
</tr>
<tr>
<td>Vendredi 13/09 aprem</td>
<td>1h</td>
<td>Fin de la préparation du dataset</td>
</tr>
<tr>
<td>Dimanche 15/09 aprem</td>
<td>15 min</td>
<td>Définition des questions cibles</td>
</tr>
<tr>
<td>Lundi 16/09 aprem</td>
<td>3h30</td>
<td>Analyse des données</td>
</tr>
</tbody>
</table>
<h2>Premier Sprint</h2>
<h3>Téléchargement des datasets</h3>
<p>J'ai commencé par téléchager mes datasets sur <a href="https://www.kaggle.com/datasets?search=pokemon">Kaggle</a>, qui est une plateforme dédiée à la Data Science et mettant à disposition de nombreux datasets pour apprendre (gratuit).</p>
<p>J'ai choisi deux datasets à étudier pour l'instant, en me basant sur les informations fournies par celles-ci : liste exhaustive des Pokémons, types, attributs de combat...</p>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mr-8">
<ul>
<li><a href="https://www.kaggle.com/code/jonathanbouchet/pokemon-battles/input?select=pokemon.csv">pokemon.csv</a></li>
<li><a href="https://www.kaggle.com/code/jonathanbouchet/pokemon-battles/input?select=combats.csv">combats.csv</a></li>
</ul>
</div></div>

<h3>Import du dataset dans Excel</h3>
<p>J'ai utilisé la fonction &quot;Convertir&quot; de Excel pour mettre en forme les données brutes de mon fichier csv :</p>
<table>
<thead>
<tr>
<th>Avant</th>
<th>Après</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="Conversion_dataset.jpg" alt="image"></td>
<td><img src="Dataset_converti.jpg" alt="image"></td>
</tr>
</tbody>
</table>
<p><em><strong>Je répète l'opération pour les autres datasets au format csv.</strong></em></p>
<h3>Recherche de sources et apprentissage &quot;théorique&quot;</h3>
<p>Lors de mon dernier stage, j'avais pris l'intiative de me former sur les bases d'Excel en suivant la formation d'Open Classrooms <a href="https://openclassrooms.com/fr/courses/7168336-maitrisez-les-fondamentaux-dexcel">Maîtriser les fondamentaux d'Excel</a>, que j'ai alors relue rapidement pour me rafraîchir la mémoire. Je me suis ensuite surtout basée sur la formation suivante <a href="https://openclassrooms.com/fr/courses/7139456-perfectionnez-vous-sur-excel">Perfectionnez-vous sur Excel</a> en passant plus vite sur quelques points qui n'étaient pas utiles à mon POK, ou qui le seront pour le prochain sprint.</p>
<p>Ensuite, j'ai eu la bonne (ou mauvaise) idée d'étudier la liste des fonctions directement sur Excel, parcourant les différents types de fonctions, leurs variables, leur résultat, pour avoir une meilleure idée finalement de ce qui est à ma disposition (car on ne sait jamais vraiment tout ce qui existe).</p>
<p>Puis je n'ai pas voulu perdre trop de temps avec cette partie car j'ai pensé que le meilleur moyen d'apprendre était de commencer à travailler sur mon fichier directement.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Remarque : J'aurais effectivement du passer à cette étape plus rapidement car cela s'est révélé plus efficace et m'aurait fait gagner du temps...</p>
</div></div>
<h3>Préparation du dataset</h3>
<p>Je pensais que le dataset que j'avais choisi serait facile à préparer car il m'avait l'air déjà bien structuré. Finalement, il s'est révélé être un excellent exemple pour m'apprendre à nettoyer / structurer / préparer mes données avec Excel !</p>
<p>Voici les problèmes principaux auxquels j'ai du faire face lors de la préparation des données :</p>
<ul>
<li><strong>Problème n°1 : les méga évolutions</strong></li>
</ul>
<p>Dans un objectif de pouvoir associer les pokémon à leur numéro d'identification unique du pokédex (ce qui n'était pas le cas dans le dataset importé, les pokémon étant dans l'ordre mais les nombres ne correspondant pas forcément à leur numéro de pokédex), j'ai remarqué premièrement qu'il fallait que j'enlève les lignes correspondant à des méga évolutions.</p>
<p>Pour cela, j'ai utilisé la formule :</p>
<p><code>=ESTNUM(CHERCHE(&quot;Méga &quot;;B2))</code></p>
<p>qui me dit alors si oui ou non le nom de mon pokémon contient &quot;Méga &quot;, il ne me reste alors plus qu'à supprimer toutes les lignes où c'est le cas.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Attention à ne pas oublier l'espace après &quot;Méga&quot;, sinon de pauvres pokémon comme Méganium et Yanméga se retrouvent supprimmés et on met du temps à s'en rendre compte et à revenir en arrière...</p>
</div></div>
<ul>
<li><strong>Problème n°2 : La pluricité des formes</strong></li>
</ul>
<p>Certains pokémon possèdent plusieurs formes alternatives ou des formes régionales, qui apparaissent dans mon dataset contre ma volonté. Par exemple : Ratata d'Alola, Kyurem Dark, Kyurem White,...</p>
<p>Pour les enlever, j'ai utilisé les formules :</p>
<p><code>=SIERREUR(GAUCHE(B2;TROUVE(&quot; &quot;;B2;1));B2)</code> + <code>SUPPRESPACE(B2)</code></p>
<p>pour récupérer le premier mot de la cellule, puis je supprime les doublons.</p>
<p>Même problème à droite : Heat Rotom, Wash Rotom, Frost Rotom...</p>
<p><code>=SIERREUR(DROITE(B2;NBCAR(B2)-TROUVE(&quot; &quot;;B2;1));B2)</code> + <code>SUPPRESPACE(B2)</code></p>
<p>Mais je me suis rendue comtpe que certains pokémon pouvaient avoir le même dernier mot dans son nom et ne pas être le même pokémon pour autant... Je ne pouvais également pas prédire les cellules restées vides, ainsi que des pokémon dont le nom était au milieu d'autres mots, bref, ne voulant pas éterniser mon POK sur cette partie difficile, j'ai décidé de finaliser la structure de la colonne &quot;name&quot; à la main en modifiant directement les cellules posant problème (il n'en restait plus beaucoup), jusqu'à ce que j'en ai le bon nombre et qu'ils correspondent tous bien à leur numéro de pokédex.</p>
<ul>
<li><strong>Problème n°3 : et si je veux les noms des Pokémons en français ?</strong></li>
</ul>
<p>Je voulais pouvoir avoir les noms en français car ils me sont plus familiers et je me suis dit que c'était l'occasion d'apprendre à faire une jointure de tables.</p>
<p>J'ai dû faire un copier-coller de <a href="https://www.pokepedia.fr/Liste_des_Pok%C3%A9mon_dans_l%27ordre_du_Pok%C3%A9dex_National">cette page internet</a>  à défaut de trouver un dataset en français, puis ai utilisé la fonction <code>RECHERCHEV</code> pour faire correspondre les noms anglais avec les noms français dans mon tableau principal.</p>
<p><code>=RECHERCHEV(&quot;B2&quot;;'fr-en'!A:B:;2;FAUX)</code></p>
<h4>Dataset prêt pour l'analyse</h4>
<p><img src="Dataset_pret.jpg" alt="image"></p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Remarque : J'ai largement sous-estimé le temps que nécessiterait la préparation du dataset car le texte était plutôt mal formaté et je découvrais toujours une nouvelle source d'erreur, qui n'était pas toujours évidente à régler lors du premier essai...</p>
</div></div>
<h3>Choix des questions cibles</h3>
<ul>
<li>[x] Quelle est la répartition des types ?</li>
<li>[x] Quelle part de pokémon légendaire ?</li>
<li>[x] Est-ce que chaque type présente des forces et des faiblesses caractéristiques ?</li>
<li>[x] Est-ce que les pokémon légendaires sont forcément plus forts ?</li>
<li>[x] Est-ce un avantage de posséder deux types plutôt qu'un seul ?</li>
<li>[x] Quels pokémon détiennent les records pour chaque attribut ?</li>
<li>[ ] Quels sont les pokémon les moins bons et les meilleurs par type ? =&gt; à faire</li>
<li>[ ] Faire une table des types à partir des combats =&gt; à faire si temps</li>
<li>[ ] Les attributs de combat sont-ils bien répartis ? (distributions) =&gt; à faire si temps</li>
</ul>
<p>Ainsi que l'évolution des réponses à ces questions au fil des générations : ces tendances évoluent-elles ? =&gt; Deuxième sprint.</p>
<h3>Analyse du dataset</h3>
<ul>
<li><strong>Répartition des types</strong></li>
</ul>
<p>J'ai utilisé la formule :</p>
<p><code>= NB.SI($D$2:$E$152;C157)</code></p>
<p>avec la liste des types dans la colonne C, le type 1 en colonne D, et le type 2 en colonne E.</p>
<p><img src="Tableau_repartition.jpg" alt="image"></p>
<p>Ce qui donne visuellement :</p>
<p><img src="Graphe_repartition_type.jpg" alt="image"></p>
<p>graphe dans lequel je souhaite intégrer encore la proportion de légendaires ainsi que la proportion de pokémon à un seul type.</p>
<ul>
<li><strong>Caractéristiques par type</strong></li>
</ul>
<p>J'ai calculé pour chaque type la moyenne de chaque attribut de combat avec la formule :</p>
<p><code>=(SOMME.SI($D$2:$D$152;$C172;F$2:F$152)+SOMME.SI($E$2:$E$152;$C172;F$2:F$152))/$D172</code></p>
<p>qui je l'admets n'est pas très compréhensible telle quelle, mais je peux faire néanmoins la remarque que le bon positionnement des dollars dans ma formule m'a permis de l'étirer dans tous les sens pour remplir ce tableau avec seulement celle-ci :</p>
<p><img src="Tableau_carac_type.jpg" alt="image"></p>
<p>Ce qui peut donner visuellement ceci bien que je me concentrerai sur la visualisation au prochain sprint :</p>
<table>
<thead>
<tr>
<th style="text-align:center">Tous les types ensemble</th>
<th style="text-align:center">Filtrage dans la source de données</th>
<th style="text-align:center">Graphique dynamique avec filtre associé</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="Graphe_carac_type.jpg" alt="image"></td>
<td style="text-align:center"><img src="Graphe_carac_type_filtre.jpg" alt="image"></td>
<td style="text-align:center"><img src="Graphe_dynamique.jpg" alt="image"></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Est-ce que les pokémon légendaires sont forcément les plus forts ?</strong></li>
</ul>
<p>Grâce à des méthodes semblables, je mets une condition sur l'attribut légendaire, et je calcule la moyenne de la statistique totale pour la comparer avec celle des non-légendaires.</p>
<ul>
<li><strong>Est-ce un avantage de posséder deux types plutôt qu'un seul ?</strong></li>
</ul>
<p>Je compte le nombre de types, et je calcule la moyenne de la statistique totale pour les pokémon avec 1 type et pour 2 types.</p>
<ul>
<li><strong>Les pokémon détenant les records</strong></li>
</ul>
<p>Pour cette question j'utilise les fonctions <code>INDEX</code>, <code>EQUIV</code>, <code>MIN</code> et <code>MAX</code> combinées, sur chaque attribut.</p>
<p><code>=INDEX(Mes_Pokémons;EQUIV(MIN(F1:F152);F1:F152;0);3)</code>
<code>=INDEX(Mes_Pokémons;EQUIV(MAX(F1:F152);F1:F152;0);3)</code></p>
<p>et j'ai finalement regroupé ces résultats dans ces tableaux.</p>
<p><img src="Tableaux_sup.jpg" alt="image"></p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Remarque : Je n'ai pas vraiment eu le temps que je souhaitais pour optimiser et finir l'analyse des données et il me reste encore des manipulations à faire avant de passer aux autres générations. L'estimation de la durée des tâches a été le principal souci sur ce premier sprint.</p>
</div></div>
<h3>Retour Sprint 1</h3>
<p>Le principal défi de ce premier sprint a été l'estimation de la durée des tâches à effectuer : alors que l'analyse était peut-être faisable plus rapidement, la préparation du dataset m'a pris beaucoup plus de temps que prévu et me retarde sur le prochain sprint que j'ai dû réajuster. De plus, lorsque l'on apprend en tatônnant face aux problèmes rencontrés, la vitesse de résolution est étonnament très variable car on peut passer à côté de réponses évidentes en voulant faire trop complexe...</p>
<h2>Second Sprint</h2>
<h3>Ajustement</h3>
<ul>
<li>[x] <em><strong>Fin de l'analyse</strong></em></li>
<li>[x] <s>Apprentissage VBA</s> -&gt; en même temps que la réalisation</li>
<li>[x] Faire une macro répétant l'analyse pour chaque autre génération</li>
<li>[ ] Réaliser le rapport final avec toutes les données réunies</li>
<li>[ ] <em><strong>si temps : ajoutez les statistiques laissées pour non prioritaire</strong></em></li>
<li>[ ] <s>Étudier des techniques avancées pour embellir le tout</s></li>
<li>[ ] <s>Tester d'autres dataset en étudiant l'adaptabilité</s> -&gt; J'aurais assez de quoi m'occuper...</li>
<li>[ ] <s>Comparer avec d'autres logiciels</s> -&gt; idem</li>
</ul>
<h3>Horodatage Sprint 2</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Heures passées</th>
<th>Indications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mercredi 25/09 matin</td>
<td>30 min</td>
<td>Fin de l'analyse (abandon d'une question)</td>
</tr>
<tr>
<td>Jeudi 26/09 matin</td>
<td>1h</td>
<td>Inititation VBA</td>
</tr>
<tr>
<td>Jeudi 26/09 aprem</td>
<td>3h30</td>
<td>Tests non concluants</td>
</tr>
<tr>
<td>Vendredi 27/09 aprem</td>
<td>2h</td>
<td>Calcul du tableau par type</td>
</tr>
<tr>
<td>Samedi 28/09 aprem</td>
<td>1h30</td>
<td>Quelques fonctions par ci par là</td>
</tr>
<tr>
<td>Dimanche 29/09 aprem</td>
<td>1h30</td>
<td>Réunion de toutes les fonctions</td>
</tr>
</tbody>
</table>
<h3>Fin de l'analyse</h3>
<p>Au début du sprint, j'ai pris le temps de me repencher sur l'analyse que je n'avais pas terminée complètement pour l'affiner avant de passer à la suite.</p>
<p>J'ai uniquement eu le temps de rajouter les meilleurs et les pires pokémon par type dans mon tableau, à l'aide d'une formule plutôt complexe (peut être aurai-je pu faire plus simple ?) que voici :</p>
<p><code>=INDEX(Mes_Pokemons,EQUIV(MIN(SIERREUR(AGREGAT(15,6,1/((R &amp; nb_lignes &amp; C4=RC[-10]))*R2C6:R &amp; nb_lignes &amp; C6,1),1000),IFERROR(AGGREGATE(15,6,1/((R2C5:R &amp; nb_lignes &amp; C5=RC[-10]))*R2C6:R &amp; nb_lignes &amp; C6,1),1000)),R2C6:R &amp; nb_lignes &amp; C6*((R2C5:R &amp; nb_lignes &amp; C5=RC[-10])+(R2C4:R &amp; nb_lignes &amp; C4=RC[-10])),0)+1,3)</code></p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>A noter que si la formule dans la cellule contient des conditions matricielles (ce qui était le cas ici pour inclure un filtre avancé), il faut valider en appuyant sur les touches <code>CTRL + Maj + Entrée</code> pour ne pas avoir d'erreur <code>VALEUR?</code> qui s'affiche (j'aurais aimé trouver cette information plus tôt...).</p>
</div></div>
<p>Ce qui donne ceci pour la génération 1 :</p>
<p><img src="fin_analyse.jpg" alt="records"></p>
<h3>Macro VBA</h3>
<p>Mon idée ici était d'apprendre à coder en VBA tout en créant une automatisation de mon analyse pour chaque génération de pokémon souhaitée.</p>
<p>J'ai conscience que dans mon cas d'étude, ce n'était pas forcément utile car un simple copier-coller des formules aurait rapidement fait l'affaire, mais j'ai appris à travers ce travail les bases du langages et me suis familiarisée avec certaines manipulations donc je pense que ce fut quand même très utile !</p>
<h4>Automatisation 1 : Création d'une nouvelle page pour la génération voulue</h4>
<p>La premire étape du parcours utilisateur que je me suis imaginé serait de pouvoir choisir un numéro de génération en lançant la macro (depuis n'importe quelle page), et que cela me renvoie sur une nouvelle page située à la fin des autres pages contenant la liste des pokémon filtrée sur la génération demandée.</p>
<p>Pour cela j'ai utilisé la fonction AdvancedFilter de Excel.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure FeuillesParGen()</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb">  <span class="token keyword">Sub</span> FeuillesParGen<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
    <span class="token comment">'Je récupère le numéro de la génération que je veux</span>
    <span class="token keyword">Dim</span> gen <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    gen <span class="token operator">=</span> Application<span class="token punctuation">.</span>InputBox<span class="token punctuation">(</span>prompt<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">"Enter a generation number"</span><span class="token punctuation">,</span> <span class="token keyword">Type</span><span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token keyword">Dim</span> name <span class="token keyword">As</span> <span class="token keyword">String</span>
    name <span class="token operator">=</span> <span class="token string">"Gen"</span> <span class="token operator">&amp;</span> gen
    
    <span class="token comment">'Je supprimme l'ancienne feuille SI elle existe</span>
    Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
    Worksheets<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
    Err<span class="token punctuation">.</span>Clear
    
    <span class="token comment">'J'ajoute la nouvelle</span>
    Application<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">True</span>
    Sheets<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>After<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>Sheets<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    
    <span class="token comment">'Je copie dessus mon tableau de pokémon filtré sur la gen en question</span>
    Worksheets<span class="token punctuation">(</span><span class="token string">"pokemon_formaté"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"P2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> gen
    Worksheets<span class="token punctuation">(</span><span class="token string">"pokemon_formaté"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A:N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AdvancedFilter <span class="token operator">_</span>
        Action<span class="token punctuation">:</span><span class="token operator">=</span>xlFilterCopy<span class="token punctuation">,</span> CriteriaRange<span class="token punctuation">:</span><span class="token operator">=</span>Worksheets<span class="token punctuation">(</span><span class="token string">"pokemon_formaté"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"P1:P2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CopyToRange<span class="token punctuation">:</span><span class="token operator">=</span>ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"A1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Unique<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span>
            
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<table>
<thead>
<tr>
<th style="text-align:center">Input côté utilisateur</th>
<th style="text-align:center">Résultat sur une autre feuille</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="inputbox.jpg" alt="image"></td>
<td style="text-align:center"><img src="gen2.jpg" alt="image"></td>
</tr>
</tbody>
</table>
<h4>Automatisation 2 : Ajout de la colonne &quot;NB type&quot;</h4>
<p>J'ai voulu ici rajouter une colonne à mon dataset qui contiendrait le nombre de types que chaque pokémon possède. Pour cette fonction j'ai testé la méthode de l'enregistrement de la macro : on démarre l'enregistrement, on effectue les opérations que l'on souhaite directement sur le classeur, puis on l'arrête et tout s'est transcrit en code automatiquement.</p>
<p>J'ai ensuite remanié légérement le code pour le rendre plus lisible et pour l'adapter à toutes mes générations qui ne font pas la même longueur.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure affiche_nb_type</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb">  <span class="token keyword">Sub</span> affiche_nb_type<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"O1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>FormulaR1C1 <span class="token operator">=</span> <span class="token string">"NB type"</span>
    Range<span class="token punctuation">(</span><span class="token string">"O2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Selection<span class="token punctuation">.</span>FormulaR1C1 <span class="token operator">=</span> <span class="token string">"=IF(ISBLANK(RC[-10]),1,2)"</span>
    Selection<span class="token punctuation">.</span>AutoFill Destination<span class="token punctuation">:</span><span class="token operator">=</span>Range<span class="token punctuation">(</span><span class="token string">"O2:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Cette fonctionnalité s'avère bien pratique dans ce cas précis où je l'ai utilisé, mais je ne pouvais pas l'utiliser partout pour plusieurs soucis d'adaptabilité, donc il fallait quand même savoir coder !</p>
</div></div>
<h4>Automatisation 3 : Initialisation du tableau d'anlyse</h4>
<p>Même si ce n'est pas la représentation optimale, par manque de temps, j'ai choisi de représenter le tableau d'analyse par type tel que je l'avais créé lors du premier sprint. Cela facilitait le code dans un premier temps, puis je verrais d'éventuelles améliorations après le second sprint.</p>
<p>Cette partie a juste nécessité d'apprendre à manipuler les références et les formats des cellules, ainsi que les boucles for et for each en VBA.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure initialisation_tableau</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb">  <span class="token keyword">Sub</span> initialisation_tableau<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> ind <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Style de la 1e ligne</span>
    Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> ind <span class="token operator">&amp;</span> <span class="token string">":L"</span> <span class="token operator">&amp;</span> ind<span class="token punctuation">)</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
    Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> ind <span class="token operator">&amp;</span> <span class="token string">":L"</span> <span class="token operator">&amp;</span> ind<span class="token punctuation">)</span><span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">36</span>
    
    <span class="token comment">'3 premières colonnes manuelles</span>
    Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> ind<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Type"</span>
    Range<span class="token punctuation">(</span><span class="token string">"D"</span> <span class="token operator">&amp;</span> ind<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Nombre"</span>
    Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> ind<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Nombre de légendaires"</span>
    
    <span class="token comment">'Moyennes reprises des attributs de la 1e ligne du dataset</span>
    <span class="token keyword">Dim</span> rg <span class="token keyword">As</span> Range
    <span class="token keyword">For</span> <span class="token keyword">Each</span> rg <span class="token keyword">In</span> Range<span class="token punctuation">(</span><span class="token string">"F1:L1"</span><span class="token punctuation">)</span>
        Cells<span class="token punctuation">(</span>ind<span class="token punctuation">,</span> rg<span class="token punctuation">.</span>Column<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Moyenne de "</span> <span class="token operator">&amp;</span> rg<span class="token punctuation">.</span>Value
    <span class="token keyword">Next</span> rg
    
    <span class="token comment">'Deux dernières lignes que je sais pas faire pour l'instant</span>
        <span class="token comment">'Range("M170").Value = "Pire pokémon"</span>
        <span class="token comment">'Range("N170").Value = "Meilleur pokémon"</span>
    
    <span class="token keyword">Dim</span> types <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    types <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">"Poison"</span><span class="token punctuation">,</span> <span class="token string">"Water"</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span> <span class="token string">"Flying"</span><span class="token punctuation">,</span> <span class="token string">"Grass"</span><span class="token punctuation">,</span> <span class="token string">"Ground"</span><span class="token punctuation">,</span> <span class="token string">"Psychic"</span><span class="token punctuation">,</span> <span class="token string">"Bug"</span><span class="token punctuation">,</span> <span class="token string">"Fire"</span><span class="token punctuation">,</span> <span class="token string">"Rock"</span><span class="token punctuation">,</span> <span class="token string">"Electric"</span><span class="token punctuation">,</span> <span class="token string">"Fighting"</span><span class="token punctuation">,</span> <span class="token string">"Fairy"</span><span class="token punctuation">,</span> <span class="token string">"Ice"</span><span class="token punctuation">,</span> <span class="token string">"Dragon"</span><span class="token punctuation">,</span> <span class="token string">"Ghost"</span><span class="token punctuation">,</span> <span class="token string">"Steel"</span><span class="token punctuation">,</span> <span class="token string">"Dark"</span><span class="token punctuation">)</span>
    
    <span class="token comment">'J'attribue chaque type à une ligne de mon tableau</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">17</span>
        Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> ind <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> types<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> i
        
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<h4>Automatisation 4 : Calcul des valeurs</h4>
<p>Je remplis à présent mon tableau d'anlyse avec les bonnes valeurs : pour cela j'ai repris les formules que j'avais écrites dans le sprint 1 et les ai adaptées en VBA, puis intégrées dans des boucles.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure calcul_valeurs</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> calcul_valeurs<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> ind <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    
    <span class="token comment">'On remplit les nombres</span>
    <span class="token keyword">For</span> l <span class="token operator">=</span> ind <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">To</span> ind <span class="token operator">+</span> <span class="token number">18</span>
        Range<span class="token punctuation">(</span><span class="token string">"D"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span> <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>CountIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"D2:E"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">)</span>
        Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span> <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>CountIfs<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"D2:D"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"N2:N"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"VRAI"</span><span class="token punctuation">)</span> <span class="token operator">+</span> WorksheetFunction<span class="token punctuation">.</span>CountIfs<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"E2:E"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"N2:N"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"VRAI"</span><span class="token punctuation">)</span>
        <span class="token comment">'Le compte des légendaires ne marche pas (soucis sur la condition true) à réparer</span>
    <span class="token keyword">Next</span>
        
    <span class="token comment">'On remplit les moyennes</span>
    <span class="token keyword">Dim</span> col <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    col <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>
 
    <span class="token keyword">For</span> l <span class="token operator">=</span> ind <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">To</span> ind <span class="token operator">+</span> <span class="token number">18</span>
        <span class="token keyword">For</span> <span class="token keyword">Each</span> c <span class="token keyword">In</span> col
            Range<span class="token punctuation">(</span>c <span class="token operator">&amp;</span> l<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>SumIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"D2:D"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span>c <span class="token operator">&amp;</span> <span class="token string">"2:"</span> <span class="token operator">&amp;</span> c <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> WorksheetFunction<span class="token punctuation">.</span>SumIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"E2:E"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span>c <span class="token operator">&amp;</span> <span class="token string">"2:"</span> <span class="token operator">&amp;</span> c <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> Range<span class="token punctuation">(</span><span class="token string">"D"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
        
    <span class="token comment">'Meilleur et pire pokémon : à trouver car formule trop complexe</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p><img src="tableau_types_gen2.jpg" alt="image"></p>
<h4>Automatisation 5 : Création d'un graphe</h4>
<p>Ne me restant plus beaucoup de temps à accorder à la visualisation de mes données dans la macro, j'ai décidé d'écourter l'analyse des données incomplète pour avoir au moins un résultat de graphique avec VBA.</p>
<p>J'ai tenté la réalisation du graphique radar représentant les comparaisons des différents types sur chaque atribut, mais me suis rendue compte que ce graphe était d'une complexité trop grande (du moins pour commencer), et me suis vite retrouvée dans l'impasse. J'ai donc décidé de faire uniquement le graphe de la répartition des types :</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure graphe</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> graphe<span class="token punctuation">(</span>ind <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> graph <span class="token keyword">As</span> ChartObject
    <span class="token keyword">Set</span> graph <span class="token operator">=</span> ActiveSheet<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>Left<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> Width<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> Top<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">17</span> <span class="token operator">*</span> ind<span class="token punctuation">,</span> Height<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    graph<span class="token punctuation">.</span>Chart<span class="token punctuation">.</span>SetSourceData Source<span class="token punctuation">:</span><span class="token operator">=</span>ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">"C"</span> <span class="token operator">&amp;</span> ind <span class="token operator">&amp;</span> <span class="token string">":D"</span> <span class="token operator">&amp;</span> ind <span class="token operator">+</span> <span class="token number">18</span><span class="token punctuation">)</span>
    graph<span class="token punctuation">.</span>Chart<span class="token punctuation">.</span>ChartType <span class="token operator">=</span> xlBarStacked
    graph<span class="token punctuation">.</span>Chart<span class="token punctuation">.</span>ChartTitle<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"Répartition des types"</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p>Ce graphique comporte les paramètres élémentaires dont j'avais besoin mais je pourrais le peaufiner plus tard pour le rendre plus joli.</p>
<p><img src="Graphe_rep_auto.jpg" alt="image"></p>
<h4>Réunion de toutes les procédures en une</h4>
<p>J'ai simplement regroupé toutes les procédures créés en une seule pour n'avoir à cliquer que sur un seul bouton pour avoir toute l'analyse :</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure globale AnalyseParGen</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> AnalyseParGen<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">'Je crée la nouvelle feuille</span>
    FeuillesParGen
    
    <span class="token comment">'Je récupère le nombre de pokémon sur la nouvelle feuille active</span>
    <span class="token keyword">Dim</span> nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    nb_lignes <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"A:A"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Je définis l'endroit où je place mes calculs</span>
    <span class="token keyword">Dim</span> ind <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    ind <span class="token operator">=</span> nb_lignes <span class="token operator">+</span> <span class="token number">5</span>
    
    <span class="token comment">'J'affiche le nombre de types</span>
    affiche_nb_type nb_lignes
    
    <span class="token comment">'J'initialise mon tableau par type</span>
    initialisation_tableau nb_lignes<span class="token punctuation">,</span> ind
    
    <span class="token comment">'Je rajoute mes valeurs calculées à l'intérieur</span>
    calcul_valeurs nb_lignes<span class="token punctuation">,</span> ind
    
    <span class="token comment">'Je trie du plus grand au plus petit</span>

    Range<span class="token punctuation">(</span><span class="token string">"D141"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Selection<span class="token punctuation">.</span>AutoFilter
    ActiveWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">"Gen3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AutoFilter<span class="token punctuation">.</span>Sort<span class="token punctuation">.</span>SortFields<span class="token punctuation">.</span>Clear
    ActiveWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">"Gen3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AutoFilter<span class="token punctuation">.</span>Sort<span class="token punctuation">.</span>SortFields<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span>Range<span class="token punctuation">(</span> <span class="token operator">_</span>
        <span class="token string">"D141:D159"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SortOn<span class="token punctuation">:</span><span class="token operator">=</span>xlSortOnValues<span class="token punctuation">,</span> Order<span class="token punctuation">:</span><span class="token operator">=</span>xlAscending<span class="token punctuation">,</span> DataOption<span class="token punctuation">:</span><span class="token operator">=</span> <span class="token operator">_</span>
        xlSortNormal
    <span class="token keyword">With</span> ActiveWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">"Gen3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AutoFilter<span class="token punctuation">.</span>Sort
        <span class="token punctuation">.</span>Header <span class="token operator">=</span> xlYes
        <span class="token punctuation">.</span>MatchCase <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>Orientation <span class="token operator">=</span> xlTopToBottom
        <span class="token punctuation">.</span>SortMethod <span class="token operator">=</span> xlPinYin
        <span class="token punctuation">.</span>Apply
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    <span class="token comment">'Je trace le graphique de répartition des types</span>
    graphe ind
    
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<h3>Conclusion Sprint 2</h3>
<p>Il est clair qu'un petit soucis s'est opéré au niveau de l'estimation du temps des tâches, car à la fin du sprint 2, je suis loin d'être arrivée là où je l'imaginais.</p>
<ul>
<li>
<p>Premièrement, j'ai pris du <strong>retard sur le sprint 1</strong> en sous-estimant le temps que nécessiterait la structuration des données. C'est un retard que j'ai du un peu rattraper au début du sprint 2.</p>
</li>
<li>
<p>Puis le deuxième problème est que j'ai probablement surestimé mes capacités à appliquer ce que j'ai appris sur VBA à mon cas particulier : j'ai passé <strong>beaucoup de temps (trop) à débugger des choses dont je ne savais même pas si elles étaient utiles ou pas</strong>.</p>
</li>
<li>
<p>Le troisième problème est que j'ai peut-être voulu faire trop compliqué pour l'instant : j'ai été <strong>très rapidement bloquée dès lors que je voulais faire des graphes</strong> (j'aurais quand même pu mais j'ai vu que cela me prendrait beaucoup trop de temps) alors j'ai du abandonner la dernière partie sur la visualisation des données automatisée (je ne suis même pas sûre que cette partie était si intéressante que ça à automatiser).</p>
</li>
</ul>
<p>Mais il n'empêche qu'avec tous ces problèmes cela m'a permis de me plonger <strong>à fond dans la réflexion</strong> et de découvrir <strong>beaucoup de fonctionnalités de VBA</strong> ce qui était finalement le <strong>but</strong> du POK ! J'ai appris énormément de choses à travers ces deux premiers sprints qui me seront forcément utiles, et j'ai décidé de continuer à parfaire mon fichier sur mon temps libre pour m'approcher quand même de ce que je voulais faire.</p>
<h2>Pour aller plus loin : sur mon temps personnel</h2>
<h3>Amélioration du code et débuggage</h3>
<p>Première chose à améliorer était la <strong>lisibilité du code</strong> et de refaire <strong>certaines fonctions qui ne marchaient pas</strong> comme celle qui devait <strong>compter le nombre de légendaires</strong> : il m'était impossible d'utiliser la formule COUNTIF avec pour condition des cellules contenant <code>true</code> et <code>false</code> peu importe comment je les remaniais... il existe peut-être une solution, mais je me suis débrouillée en faisant une fonction certes plus longue mais qui cette fois marche :</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure nombre_légendaire</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> nombre_legendaire<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> poktype <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> ligne <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token comment">'Définir les variables</span>
    <span class="token keyword">Dim</span> leg <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> compteur <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    compteur <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">For</span> l <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> nb_lignes<span class="token punctuation">:</span>
        leg <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">"N"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">If</span> leg <span class="token keyword">Then</span>
            <span class="token keyword">If</span> <span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"D"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span> <span class="token operator">=</span> poktype <span class="token keyword">Or</span> Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span> <span class="token operator">=</span> poktype<span class="token punctuation">)</span> <span class="token keyword">Then</span>
                compteur <span class="token operator">=</span> compteur <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> ligne<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> compteur

<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p>Puis j'ai utilisé le même principe pour écrire la fonction qui permet de <strong>comparer les moyennes de points totales pour les légendaires ou non</strong>, que je n'avais pas eu le temps de faire (de toute façon ça n'allait pas marcher tel que je l'avais commencé).</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure influence_legendaire</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> influence_legendaire<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> ind3 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Style</span>
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"J"</span> <span class="token operator">&amp;</span> ind3<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">50</span>
        <span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Influence légendaire"</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"K"</span> <span class="token operator">&amp;</span> ind3<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">36</span>
        <span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Moyenne TOTAL"</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"J"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"Légendaires"</span>
    Range<span class="token punctuation">(</span><span class="token string">"J"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"Normaux"</span>
    Range<span class="token punctuation">(</span><span class="token string">"J"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">&amp;</span> <span class="token string">":K"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>Weight <span class="token operator">=</span> xlThick
    
    <span class="token comment">'On calcule les valeurs</span>

    <span class="token comment">'Définir les variables</span>
    <span class="token keyword">Dim</span> leg <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> compteur <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    compteur <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">Dim</span> total <span class="token keyword">As</span> <span class="token keyword">Double</span>
    total <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">For</span> l <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> nb_lignes<span class="token punctuation">:</span>
        leg <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">"N"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">If</span> leg <span class="token keyword">Then</span>
            compteur <span class="token operator">=</span> compteur <span class="token operator">+</span> <span class="token number">1</span>
            total <span class="token operator">=</span> total <span class="token operator">+</span> Range<span class="token punctuation">(</span><span class="token string">"F"</span> <span class="token operator">&amp;</span> l<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"K"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Round<span class="token punctuation">(</span>total <span class="token operator">/</span> compteur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    Range<span class="token punctuation">(</span><span class="token string">"K"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Round<span class="token punctuation">(</span><span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>Sum<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"F2:F"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> total<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>nb_lignes <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> compteur<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p>De même, j'ai ensuite fait la fonction similaire qui devait permettre de <strong>comparer les moyennes de points totales pour des pokémon possédant 1 type ou 2 types</strong>.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure influence_type</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> influence_type<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> ind3 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Style</span>
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"G"</span> <span class="token operator">&amp;</span> ind3<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">50</span>
        <span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Influence nb type"</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"H"</span> <span class="token operator">&amp;</span> ind3<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">36</span>
        <span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Moyenne TOTAL"</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"G"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"1 type"</span>
    Range<span class="token punctuation">(</span><span class="token string">"G"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"2 types"</span>
    
    Range<span class="token punctuation">(</span><span class="token string">"G"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">&amp;</span> <span class="token string">":H"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>Weight <span class="token operator">=</span> xlThick
    
    <span class="token comment">'On remplit les valeurs</span>
    Range<span class="token punctuation">(</span><span class="token string">"H"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Round<span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>SumIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"O2:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"F2:F"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> WorksheetFunction<span class="token punctuation">.</span>CountIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"O2:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    Range<span class="token punctuation">(</span><span class="token string">"H"</span> <span class="token operator">&amp;</span> ind3 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Round<span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>SumIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"O2:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">"F2:F"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> WorksheetFunction<span class="token punctuation">.</span>CountIf<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"O2:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    

<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p>Enfin, j'ai également rajouté l'automatisation du calcul du tableau des <strong>pokémon à chaque fois meilleurs et pires pour chaque attribut</strong>, qui existait déjà à la fin du premier sprint.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Code de la procédure records</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> records<span class="token punctuation">(</span>nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> ind2 <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token comment">'Reprise des attributs de la 1e ligne du dataset</span>
    <span class="token keyword">Dim</span> rg <span class="token keyword">As</span> Range
    <span class="token keyword">For</span> <span class="token keyword">Each</span> rg <span class="token keyword">In</span> Range<span class="token punctuation">(</span><span class="token string">"F1:L1"</span><span class="token punctuation">)</span>
        Cells<span class="token punctuation">(</span>ind2<span class="token punctuation">,</span> rg<span class="token punctuation">.</span>Column<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rg<span class="token punctuation">.</span>Value
    <span class="token keyword">Next</span> rg
    
    <span class="token comment">'Style</span>
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> ind2<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">50</span>
        <span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Pokemon records"</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    <span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">"F"</span> <span class="token operator">&amp;</span> ind2 <span class="token operator">&amp;</span> <span class="token string">":L"</span> <span class="token operator">&amp;</span> ind2<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Interior<span class="token punctuation">.</span>ColorIndex <span class="token operator">=</span> <span class="token number">36</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>

    Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> ind2 <span class="token operator">&amp;</span> <span class="token string">":L"</span> <span class="token operator">&amp;</span> ind2 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>Weight <span class="token operator">=</span> xlThick
    
    <span class="token comment">'titre des lignes</span>
    Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> ind2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Meilleur"</span>
    Range<span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ind2 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"Moins bon"</span>
    
    <span class="token comment">'On remplit les pokémon</span>
    <span class="token keyword">Dim</span> col <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    col <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>
 
    <span class="token keyword">For</span> <span class="token keyword">Each</span> C <span class="token keyword">In</span> col
        Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> ind2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Index<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"A1:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> WorksheetFunction<span class="token punctuation">.</span>Match<span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>Max<span class="token punctuation">(</span>Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> <span class="token string">"1:"</span> <span class="token operator">&amp;</span> C <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> <span class="token string">"1:"</span> <span class="token operator">&amp;</span> C <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> ind2 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Index<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"A1:O"</span> <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> WorksheetFunction<span class="token punctuation">.</span>Match<span class="token punctuation">(</span>WorksheetFunction<span class="token punctuation">.</span>Min<span class="token punctuation">(</span>Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> <span class="token string">"1:"</span> <span class="token operator">&amp;</span> C <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">(</span>C <span class="token operator">&amp;</span> <span class="token string">"1:"</span> <span class="token operator">&amp;</span> C <span class="token operator">&amp;</span> nb_lignes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<p>En ce qui concerne les meilleurs pokémon et pires pokémon pour chaque type, étant donné la complexité déjà rencontrée sans VBA, je ne m'y suis pas aventurée (peut-être que si un petit peu mais j'ai du vite renoncer).</p>
<p>Après <strong>amélioration du design</strong> des tableaux créés et <strong>ajout des dernières fonctions</strong> mentionnées, voici ce que l'on obtenait lors de l'activation de la macro :</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Voir code</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-vb"><code class="language-vb"><span class="token keyword">Sub</span> AnalyseParGen<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">'Je crée la nouvelle feuille</span>
    FeuillesParGen
    
    <span class="token comment">'Je récupère le nombre de pokémon sur la nouvelle feuille active</span>
    <span class="token keyword">Dim</span> nb_lignes <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    nb_lignes <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"A:A"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Je définis l'endroit où je place mes calculs</span>
    <span class="token keyword">Dim</span> ind <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    ind <span class="token operator">=</span> nb_lignes <span class="token operator">+</span> <span class="token number">5</span>
    
    <span class="token keyword">Dim</span> ind2 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    ind2 <span class="token operator">=</span> ind <span class="token operator">+</span> <span class="token number">20</span>
    
    <span class="token keyword">Dim</span> ind3 <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    ind3 <span class="token operator">=</span> ind2 <span class="token operator">+</span> <span class="token number">4</span>
    
    <span class="token comment">'J'affiche le nombre de types</span>
    affiche_nb_type nb_lignes
    
    <span class="token comment">'J'initialise mon tableau par type</span>
    initialisation_tableau nb_lignes<span class="token punctuation">,</span> ind
    
    <span class="token comment">'Je rajoute mes valeurs calculées à l'intérieur</span>
    calcul_valeurs nb_lignes<span class="token punctuation">,</span> ind
    
    <span class="token comment">'Je trie du plus grand au plus petit</span>
    tri ind

    <span class="token comment">'Je trace le graphique de répartition des types</span>
    graphe ind
    
    <span class="token comment">'Je mets les pokémon records</span>
    records nb_lignes<span class="token punctuation">,</span> ind2
    
    <span class="token comment">'Je mets l'influence du type</span>
    influence_type nb_lignes<span class="token punctuation">,</span> ind3
    
    <span class="token comment">'Influence du nomre de legendaires</span>
    influence_legendaire nb_lignes<span class="token punctuation">,</span> ind3
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span></code></pre>
</div>
</details>     
</div>
<table>
<thead>
<tr>
<th style="text-align:center">étape 1</th>
<th style="text-align:center">Résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="exemple_macro.jpg" alt="image"></td>
<td style="text-align:center"><img src="resultat_macro.jpg" alt="image"></td>
</tr>
</tbody>
</table>
<h3>Création du rapport d'une génération</h3>
<p>Une fois arrivée là, le travail ne semble toujours pas fini. Il reste en effet à faire des visualisations pour les autres générations que je n'ai pas réussi à automatiser, mais surtout je voulais pouvoir <strong>regrouper toutes mes analyses en un seul endroit qui me ferait une sorte de résumé de la génération</strong>.</p>
<p>Par manque de temps, je l'ai donc fait manuellement sur la première génération.</p>
<h4>Import photos pokémon</h4>
<p>Pour faire un visuel sympathique, je tenais à introduire des photos de pokémon sur mon rapport final. J'ai donc téléchargé un dossier contenant des photos de chaque pokémon très pratique car le nom de l'image se résume au numéro de pokédex de chaque pokémon (correspondant aussi à mes index dans Excel).</p>
<p>Vous pouvez retrouver les images ici : <a href="https://www.kaggle.com/datasets/kvpratama/pokemon-images-dataset">pokemon images</a></p>
<p>J'ai rajouté des lignes dans mon tableau pour indiquer les numéros de pokédex de chaque pokémon &quot;record&quot; pour pouvoir ensuite retrouver plus facilement leur image dans le dossier et importer toutes les photos.</p>
<h4>Assemblage</h4>
<p>Pour cette étape finale j'ai donc usé de ma créativité afin de faire quelque chose de joli avec tous les éléments à ma disposition.</p>
<p>Voici le résultat final pour la génération 1 :</p>
<p><img src="feuille1.jpg" alt="image"> <img src="feuille2.jpg" alt="image"></p>
<h2>Conclusion POK</h2>
<p>Ce fut un POK beaucoup plus long à faire que prévu mais j'y ai pris <strong>beaucoup de plaisir</strong> ce qui m'a permis de rester <strong>investie</strong> tout du long même si les résultats vis-à-vis du planning étaient <strong>décevants</strong>.</p>
<p>Il y a encore du travail, des fonctions qui ne marchent pas, des visualisations à automatiser, des codes à optimiser...</p>
<p>Je suis peut-être pas passée par les bons chemins, j'ai utilisé des méthodes plutôt naïves, je boucle plein de fois sur toute la liste des pokémon, mais je suis quand même contente d'avoir produit ça étant donné le niveau d'où je suis partie.</p>
<h2>Sources</h2>
<ul>
<li>Openclassrooms : <a href="https://openclassrooms.com/fr/courses/7139456-perfectionnez-vous-sur-excel">Perfectionnez vous sur Excel</a></li>
<li>Excel-pratique : <a href="https://excel-pratique.com/fr/vba/">VBA</a></li>
<li>Support Microsoft : <a href="https://learn.microsoft.com/fr-fr/">Microsoft</a></li>
</ul>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>
        <script src="/do-it/assets/node_modules/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    </body>
</html>
