
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MON 2.1 - VBA</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">MON 2.1 - VBA</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2023-2024</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 2</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">VBA</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">excel</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Schultz Mathis</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Découverte du langage VBA

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/">2023-2024</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Mathis Schultz/">Schultz Mathis</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Mathis Schultz/mon/">MON de Schultz Mathis</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Mathis Schultz/mon/temps-2.1/">MON 2.1 - VBA</a>

</div></div>




<h2 id="h1"> Introduction </h2>
<h2 id="toc"> Table des matières </h2>
<ul>
<li><a href="#h1">Introduction</a></li>
<li><a href="#toc">Table des matières</a></li>
<li><a href="#h2">Présentation d'excel</a></li>
<li><a href="#h3">Les limites d'excel</a></li>
<li><a href="#h4">Le langage VBA</a></li>
<li><a href="#h5">Google sheet</a></li>
<li><a href="#h6">Conclusion</a></li>
<li><a href="#liens">Liens utiles</a></li>
</ul>
<h2 id="h2"> Présentation d'excel </h2>
<p>Microsoft Excel est une application de logiciel de tableur utilisée pour stocker, organiser et analyser des données. Lancé en 1985, il est devenu l'un des programmes informatiques les plus importants dans les entreprises du monde entier.</p>
<p>Excel est un outil puissant qui s'est solidement ancré dans les processus commerciaux à travers le monde, que ce soit pour l'analyse des actions ou des émetteurs, la budgétisation, ou l'organisation des listes de ventes clients. La capacité qu'a excel à répondre à l'ensemble des besoins des clients lui a permis de s'imposer sur le marché, en effet, sa simplicité combiné à son ensemble de fonctions comme le langage VBA lui a permis de devenir essentiel.</p>
<p><strong>Finance et Comptabilité :</strong>
Les services financiers et la comptabilité sont des domaines de la finance qui dépendent le plus des tableurs Excel. Dans les années 1970 et au début des années 1980, les analystes financiers passaient des semaines à exécuter des formules avancées manuellement. Aujourd'hui, Excel permet d'effectuer des modélisations complexes en quelques minutes. Les départements financiers et comptables utilisent intensivement Excel pour analyser les résultats financiers, créer des budgets et des prévisions, et prendre des décisions commerciales importantes.</p>
<p><strong>Marketing et Gestion de Produits :</strong>
Les professionnels du marketing et de la gestion de produits utilisent également Excel pour la gestion des cibles clients, la planification des stratégies marketing futures.</p>
<p><strong>Planification des Ressources Humaines :</strong>
Bien que des systèmes de base de données comme Oracle, SAP et Quickbooks soient utilisés pour gérer la paie et les informations sur les employés, l'exportation des données dans Excel permet d'analyser les tendances, de résumer les dépenses et les heures par période de paie, mois ou année, et de mieux comprendre la répartition de la main-d'œuvre par fonction ou niveau de salaire.</p>
<p><strong>Polyvalence des Tableurs Excel :</strong>
Excel est un outil polyvalent utilisé dans de nombreuses applications commerciales, telles que le suivi des listes d'invités et des coûts pour les événements d'entreprise, la création de modèles de croissance des revenus, la planification éditoriale, la budgétisation des produits, le suivi des dépenses, le calcul des remises clients...</p>
<p><strong>Persistance d'Excel dans le Monde des Affaires :</strong>
Excel reste un outil essentiel dans le monde des affaires, avec des applications allant des projets informatiques aux pique-niques d'entreprise. La maîtrise d'Excel est cruciale pour de nombreux professionnels de bureau, et des compétences plus avancées peuvent ouvrir des opportunités de promotion et de leadership. Bien que puissant, Excel nécessite un utilisateur compétent pour tirer le meilleur parti de ses fonctionnalités au profit de l'entreprise.</p>
<h2 id="h3"> Les limites d'excel </h2>
<p>Excel s'est imposé sur la marché avec une stratégie simple : un outil qui est modulable pour répondre aux besoins de tous. Il est rentré dans le quotidien de chaque entreprises et s'est rendu indispensable. Aujourd'hui le monde des finances est bloqué dans excel. Ce système conçu dans les années 80 est dépassé mais personne n'ose faire de transition vers d'autre système par peur de créer d'énormes problèmes. Voici quelques exemples de problème lié à des erreurs d'utilisation d'excel :</p>
<p><strong>Oubli du signe moins de 2,6 milliards de dollars :</strong>
En décembre 1994, un comptable du fonds commun de placement Magellan de Fidelity Investments a omis un signe moins (-), transformant une perte nette en capital de 1,3 milliard de dollars en un gain de 1,3 milliard de dollars. Cette erreur a entraîné le retrait de la distribution de fin d'année promise de 4,32 $ par action.</p>
<p><strong>La grande différence entre &quot;Masquer&quot; et &quot;Supprimer&quot; :</strong>
Lors de l'effondrement de Lehman Brothers en septembre 2008, Barclays Capital a failli acheter par accident 179 contrats de négociation de Lehman. En envoyant un fichier Excel à un tribunal de faillite, des lignes cachées au lieu d'être supprimées ont créé une confusion, détectée après l'approbation de l'accord.</p>
<p><strong>L'erreur de &quot;Couper&quot; et &quot;Coller&quot; de 24 millions de dollars :</strong>
En 2003, TransAlta Corp, une entreprise d'électricité canadienne, a subi une perte de 24 millions de dollars en raison d'une erreur de &quot;Couper&quot; et &quot;Coller&quot; lors de la soumission des offres pour des contrats de couverture de transmission d'électricité. Des prix de soumission plus élevés ont été attribués à des itinéraires à faible demande en raison d'une mauvaise alignation des lignes dans le fichier du tableur.</p>
<p>Voici donc des limites liées à l'utilisation d'excel qui nécessite qu'un autre outil mieux conçu prenne le relai.</p>
<h2 id="h4"> Le langage VBA </h2>
<p><strong>Pourquoi le langage VBA</strong></p>
<p>Que ce soit à titre personnel ou professionnel, il arrive parfois de faire plusieurs fois les mêmes actions dans un projet. Cela a peu de valeur ajoutée de refaire toujours la même chose. C'est là que le langage VBA fait sens : il permet de faire un code qui automatise la tâche, appelé Macro. VBA dépasse excel dans la mesure où les Macros peuvent s'utiliser sur d'autre applications : outlook, word...</p>
<p><strong>les principaux cas d'usages</strong></p>
<ul>
<li>Automatisation simple</li>
<li>Traitement automatique</li>
<li>Automatisation complète</li>
<li>ERP (Enterprise Resource Planning) professionnel complet.</li>
</ul>
<p><strong>Les Macros</strong></p>
<p>L'enregistreur de macros permet pour des cas simples de réaliser une suite d'action en très peu de temps : il reproduit les actions que vous lui montrez. Ce n'est pas une solution optimale car l'exécution n'est pas très rapide, et ne permet pas toutes les fonctionnalités : faire des boucles ou des teste.</p>
<p>Pour aller plus loin on peut ouvrir l'éditeur de Macros pour apporter des modifications à cette suite d'action : cela nécessite de coder les actions.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p>Attention</p>
</div><div class="pl-8 mr-8">
<p>Pour enregistrer les macros il faut que le fichier soit en .xlsm ou .xlsb</p>
</div></div>
<p>MsgBox :
Utilisée pour afficher des boîtes de dialogue avec des messages pour l'utilisateur.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb">MsgBox <span class="token string">"Hello, World!"</span>
</code></pre>
<p>InputBox :
Permet de demander à l'utilisateur d'entrer des données.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">Dim</span> userInput <span class="token keyword">As</span> <span class="token keyword">String</span>
userInput <span class="token operator">=</span> InputBox<span class="token punctuation">(</span><span class="token string">"Entrez quelque chose :"</span><span class="token punctuation">)</span>
</code></pre>
<p>Variables :
Pour stocker et manipuler des données.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">Dim</span> myNumber <span class="token keyword">As</span> <span class="token keyword">Integer</span>
myNumber <span class="token operator">=</span> <span class="token number">10</span>
</code></pre>
<p>Conditions (If...Then...Else) :
Utilisées pour exécuter des instructions en fonction d'une condition.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">If</span> myNumber <span class="token operator">></span> <span class="token number">5</span> <span class="token keyword">Then</span>
    MsgBox <span class="token string">"La variable est supérieure à 5."</span>
<span class="token keyword">Else</span>
    MsgBox <span class="token string">"La variable est inférieure ou égale à 5."</span>
<span class="token keyword">End</span> <span class="token keyword">If</span>
</code></pre>
<p>Boucles (For...Next, Do...Loop) :
Permettent d'exécuter des instructions de manière répétée.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">5</span>
    MsgBox <span class="token string">"Ceci est la itération "</span> <span class="token operator">&amp;</span> i
<span class="token keyword">Next</span> i
</code></pre>
<p>Fonctions intégrées :
Excel VBA offre également un large éventail de fonctions intégrées, similaires à celles d'Excel.</p>
<pre class="language-vb " style="counter-reset: linenumber 0"><code class="language-vb"><span class="token keyword">Dim</span> result <span class="token keyword">As</span> <span class="token keyword">Double</span>
result <span class="token operator">=</span> WorksheetFunction<span class="token punctuation">.</span>Sum<span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token string">"A1:A10"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>D'autre possibilités</strong></p>
<ul>
<li>La fonction  Dir  permet de lister les différents fichiers dans un dossier.</li>
<li>La fonction  MkDir  permet de créer des dossiers.</li>
<li>Il est possible de déplacer, supprimer, tester ou encore copier des fichiers avec l’objet &quot;FileSystemObject&quot;.</li>
<li>Certains événements liés à une feuille ou au classeur peuvent déclencher un sous-programme et faire des actions spécifiques.</li>
<li>On peut ajouter des paramètres afin que le programme sache lui-même s'il doit lancer les sous-programmes.</li>
<li>Pour automatiser le lancement du programme, on peut utiliser le planificateur de tâches de Windows par exemple.</li>
</ul>
<p><strong>Sécurité</strong></p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p>Attention</p>
</div><div class="pl-8 mr-8">
<p>Certaines fonctionnalités liés à l'exécution de code peut comporter des risques. Surtout lorsque l'on n'est pas auteur du code. Voici quelques démarches à suivre pour s'en protéger</p>
</div></div>
<ul>
<li>L’ajout d’un certificat à une macro permet d'authentifier en signant la macro avec un nom.</li>
<li>L’utilisation du &quot;Username&quot; permet de réduire l'exécution du code aux personnes qui y sont autorisées.</li>
<li>Pour une protection maximale, il est possible d’ajouter un mot de passe pour afficher le code dans le VBE.</li>
</ul>
<p><strong>La gestion de série temporelle</strong></p>
<ul>
<li>Les séries temporelles sont des graphiques qui permettent de comprendre l’évolution dans le temps d’une variable.</li>
<li>On peut décomposer une date en plusieurs variables comme les jours de la semaine, les semaines, les trimestres, des périodes spécifiques, des heures, etc.</li>
<li>Pour lisser les séries temporelles ou pour gommer les variations saisonnières, on utilise une moyenne mobile.</li>
<li>Les prévisions des séries temporelles se font sur les historiques en gardant les variations saisonnières.</li>
</ul>
<h2 id="h5"> Google sheet</h2>
<p>Pour travailler sur google sheet, le langage VBA ne fonctionne pas. Cependant, il y a un équivalent, le javascript.</p>
<h2 id="h6"> Conclusion </h2>
<p>J'ai suivit les cours d'Open Classroom qui prennent environ 4-5 heures chacuns. Ils permettent de se saisir des bases du vba et d'aller plus loin dans la gestion de fichier et de data. Il sont très bien fait, Louise a quand à elle suivit le tutoriel de microsoft qui se trouve dans les liens utiles, et qui selon elle est tout aussi bien.</p>
<h2 id="liens"> Liens utiles </h2>
<p>Microsoft propose beaucoup de ressource pour appréhender VBA, voici des liens qui renvoies vers :</p>
<ul>
<li><a href="https://www.excel-pratique.com/fr/fonctions-vba">Les Fonction VBA</a></li>
<li><a href="https://www.excel-pratique.com/fr/vba">Le tutoriel Microsoft</a></li>
</ul>
<p>Le premier cours d'<a href="https://openclassrooms.com/fr/courses/8039296-decouvrez-les-fondamentaux-vba">Open Classroom</a>
Le second cours d'<a href="https://openclassrooms.com/fr/courses/8017296-analysez-vos-donnees-avec-vba">Open Classroom</a></p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
