
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Un site en Rust avec WebAssembly</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Un site en Rust avec WebAssembly</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">POK</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2023-2024</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">temps 1</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Assane Diouf</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Depuis 2019, la plupart des navigateurs intègrent WebAssembly (WASM). Il est donc possible de réaliser des applications web avec des performances proches d'applications natives en utilisant des langages de programmation variés (C++, python, Rust, etc...). Réalisons une application de ce type avec Rust dans ce POK.

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/">2023-2024</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Diouf-Asssane/">Assane DIOUF</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Diouf-Asssane/pok/">POK d&#39;Assane Diouf</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Diouf-Asssane/pok/temps-1/">Un site en Rust avec WebAssembly</a>

</div></div>




<h2>C'est quoi le WebAssembly ?</h2>
<p><img src="webassembly.svg" alt="logo WebAssembly"></p>
<blockquote>
<p>WebAssembly (abbreviated Wasm) is a binary instruction format for a stack-based virtual machine. Wasm is designed as a portable compilation target for programming languages, enabling deployment on the web for client and server applications.</p>
</blockquote>
<p><em>Cette définition est tirée de <a href="https://webassembly.org">webassembly.org</a></em></p>
<p>WebAssembly est un langage qui est executé par une machine virtuelle et ceci directement dans le navigateur. De plus, de nombreux langages, comme le C/C++, peuvent être compilés en WebAssembly.</p>
<p>La majeur partie des navigateurs sont capables d'exécuter ce WebAssembly depuis quelques années. Il est donc possible d'écrire un programme dans un autre langage que le javascript, de porter celui-ci en WebAssembly et de faire appel à ce code depuis votre javascript. Le code ainsi réalisé est alors très rapide et offre des performances proches d'applications natives.</p>
<h2>Ce que j'ai prévu pour le 1er point POK</h2>
<ul>
<li>Me former sur Rust (voir mon <a href="../../mon/Rust/">premier MON</a>)</li>
<li>Compiler le Rust en WebAssembly et l'utiliser dans un site</li>
<li>Trouver une idée plus précise du site que je vais réaliser</li>
<li>Ajouter les fichiers HTML/CSS/etc... primordiaux au site</li>
</ul>
<h2>Ce que j'ai fait</h2>
<h3>Découvrir le WebAssembly</h3>
<p>J'ai commencé par découvrir le WebAssembly. Pour ce faire, je suis allé sur leur site et j'ai visionné quelques vidéos youtube comme :</p>
<ul>
<li>Une présentation de WebAssembly par Fireship (<a href="https://youtu.be/cbB3QEwWMlA?si=ueUqehMnqwMaQCWD">lien</a>)</li>
<li>Une introduction intéressante au WebAssembly (<a href="https://youtu.be/3sU557ZKjUs?si=YLLlOl5MAQwoTh27">lien</a>)</li>
<li>Une autre vidéo de Fireship avec un exemple d'application (<a href="https://youtu.be/-OTc0Ki7Sv0?si=zvRBlrsuw_4xKhbY">lien</a>)</li>
</ul>
<p>Ces informations m'ont permis de mieux saisir ce qu'est le WebAssembly. Elles ont aussi considérablement renforcés mon envie de le tester.</p>
<h3>Du C++ au WebAssembly</h3>
<p>J'ai donc décidé d'essayer wasm. J'ai commencé par un autre langage que Rust car je ne le connaissais pas encore assez. Il est cependant possible de cibler le WebAssembly depuis plusieurs langages comme le C et le C++ par exemple, j'ai donc commencé par là.</p>
<p>Pour créer un code wasm avec du C++, il faut utiliser <a href="https://emscripten.org">emscripten</a>. Emscripten va prendre les fichiers sources et sortir un fichier en WebAssembly (.wasm), un fichier javascript et un fichier en HTML. Le javascript va automatiquement appelé le WebAssembly et définir les fonctions nécessaires pour que nos méthodes puissent être appelées depuis le javascript. Le HTML est alors une page générée automatiquement pour appeler ce javascript (en tout cas sa fonction main). J'ai pu obtenir le résultat suivant en utilisant emscripten sur un programme en C++/SDL :
<img src="emscripten.png" alt="Affichage avec emscripten"></p>
<h3>Rust et WebAssembly</h3>
<p>J'ai ensuite suivi le tutoriel fournit par Rust sur le WebAssembly accessible <a href="https://rustwasm.github.io/docs/book/introduction.html">ici</a>.</p>
<p>Après cette étape, la majorité de mes questions sur le WebAssembly avaient trouvées leur réponses.</p>
<h3>Des équations croisées</h3>
<p>Ensuite, il me fallait appliquer ce que je venais d'apprendre sur le WebAssembly et produire un livrable pour mon POK. Je me suis donc lancé le défi de réaliser un jeu d'équations croisées. Le résultat final, ressemblerait à ça :
<img src="crossmath.png" alt="Crossmath">
<em>Cette image a été tirée du jeu Crossmath</em></p>
<p>Je n'ai pas d'affichage pour l'instant, cependant voici ma progression jusqu'à présent :</p>
<ul>
<li>Création du code de génération d'équations</li>
<li>Création des fichiers HTML de base</li>
<li>Test de mes méthodes existantes jusqu'à présent</li>
</ul>
<p>J'ai donc pu en arriver au point que je visais à la fin de ce premier point POK !</p>
<h2>Ce que j'ai prévu pour le second point POK</h2>
<p>Pour la suite, voici les taches que je souhaite terminer :</p>
<ul>
<li>Terminer l'algorithme de génération des grilles <em>(difficulté estimée : 5)</em></li>
<li>Envoyer une grille avec des cases non complétées ainsi que les indices associés <em>(difficulté estimée : 2)</em></li>
<li>Afficher la grille dans la page <em>(difficulté estimée : 1)</em></li>
<li>Gérer le remplissage de la grille par le joueur <em>(difficulté estimée : 3)</em></li>
<li>Gérer la validation de la grille remplie par le joueur <em>(difficulté estimée : 1)</em></li>
</ul>
<h2>Ce que j'ai fait à la fin du temps 1</h2>
<p><img src="crossmath_final.png" alt="Le résultat après 20h de travail"></p>
<p><a href="https://crossmath.assanediouf.com/">Jouez au jeu en cliquant ici !</a></p>
<h3>Les péripéties</h3>
<p>Comme je l'avais estimé, le plus difficile a été l'algorithme de génération de la grille. Je l'ai fait un bon coup un soir puis j'ai commencé à mettre en place le js pour l'afficher. Seulement, cet affichage m'a juste montrer à quelle point je passais à côté de plein de cas : mon implémentation n'allait pas. J'ai donc modifié mon algorithme, pour ensuite m'apercevoir que j'avais encore oublié quelque chose. Ca a continuer comme ça encore une ou deux fois avant que j'ai quelque chose qui fonctionne pour de bon !</p>
<p>Il me restait ensuite assez peu de temps pour mettre en place mon CSS.</p>
<h3>Rétrospectives</h3>
<p>Je pense que le code que j'ai écris pourrait être amélioré (ou au moins écrit de façon plus lisible). J'ai utilisé des tests en Rust, je pense que les tests relatifs à la création de la grille pourraient être améliorés. En effet, tous les tests des fonctions qui interviennent dans le processus étaient convaincants mais pas celui du tout.</p>
<p>Ensuite, je suis sûr qu'il est possible de rendre mon implémentation encore plus rapide en utilisant des éléments de Rust que je ne connaissais pas encore.</p>
<p>Je suis tout de même assez satisfait du résultat, je trouve assez incroyable que le tout se déroule uniquement en front.</p>
<h3>Et ensuite ?</h3>
<p>Plein d'améliorations et de prolongements sont possibles, comme par exemple :</p>
<ul>
<li>améliorer le style (rendre la page responsive, équilibrer le design car on dirait qu'il y a un vide à gauche, etc..)</li>
<li>ajouter des opérations comme les divisions et les multiplications</li>
<li>optimiser l'algorithme de création de la grille</li>
<li>rendre le remplissage de la grille plus intuitif (par exemple, griser une option si l'utilisateur a déjà placé la valeur)</li>
<li>et biensûr, publier le site</li>
</ul>
<h2>Conclusion</h2>
<p>J'ai pu découvrir le webassembly avec Rust et réaliser cette application. Le webassembly est une très belle découverte, il ouvre de toutes nouvelles possibilités à mon sens. Je souhaite toutefois noter qu'il y a des façons différentes de faire du web avec Rust. Ces autres méthodes vont un peu masquer le côté web mais se basent aussi sur le webassembly (voir <a href="https://trunkrs.dev">Trunk</a>).
Enfin, le code est disponible dans mon <a href="https://github.com/assanediouf18/Crossmath">github</a>.</p>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
