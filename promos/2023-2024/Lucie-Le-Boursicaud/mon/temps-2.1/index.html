
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Découverte du fonctionnement du Machine Learning</title>

        <link href="/do-it/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="/do-it/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <link href="/do-it/assets/stylesheets/main.css" rel="stylesheet">
    </head>
    <body>
        <script>
        window.MathJax = {
            tex: {
            inlineMath: [
                [
                '$', '$'
                ],
                [
                '\\(', '\\)'
                ]
            ]
            },
            svg: {
            fontCache: 'global'
            }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" src="/do-it/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

        <header class="border-b-2 border-gray-200 mb-4">
        <div class="max-w-[1000px] mx-auto px-4">
            <div class="min-h-[50px] flex justify-between items-center">
                <a class="mx-2" href="/do-it/">Home</a>
                <div class="flex items-center gap-4 sm:gap-6 ">
                    <a class="" href="/do-it/cs">CS</a>
                    <a class="" href="/do-it/pok">POK</a>
                    <a class="" href="/do-it/mon">MON</a>
                    <a class="" href="/do-it/projets">Projets</a>
                    <a class="hidden sm:block" href="/do-it/promos">Promos</a>
                    <a href="/do-it/search">
                        <svg class="h-5 aspect-square" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                        </svg>
                    </a>
                    <a class="hidden sm:block" href="https://github.com/FrancoisBrucker/do-it" target="_blank">
                        <svg class="h-5 aspect-square" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                    </a>
                </div>
            </div>
        </div>
        </header>

        <main class="max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Découverte du fonctionnement du Machine Learning</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            
                <div class="font-bold">Tags : </div>
            
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">2023-2024</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Intelligence Artificielle</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Machine Learning</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Découverte</li>
                
                    <li class="bg-yellow-200 rounded-full px-2" data-pagefind-filter="Tags">Kaggle</li>
                

            </ul>
            
            
            <div class="hidden" data-pagefind-meta="Type">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteurs : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2" data-pagefind-filter="Auteurs">Lucie Le Boursicaud</li>
                
            </ul>
        </div>
    

    
</div>

        <p class="mb-4 text-lg">

                Ce MON a pour objectif de se familiariser un peu plus avec l'IA et le Machine Learning, d'en comprendre les concept et de faire de petits exercices d'application à l'aide de Kaggle. 

        </p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/do-it/promos/">Promotions</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/">2023-2024</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Lucie-Le-Boursicaud/">Lucie Le Boursicaud</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Lucie-Le-Boursicaud/mon/">MON de Lucie Le Boursicaud</a><span class="px-1">/</span><a href="/do-it/promos/2023-2024/Lucie-Le-Boursicaud/mon/temps-2.1/">Découverte du fonctionnement du Machine Learning</a>

</div></div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p>Niveau débutant</p>
</div><div class="pl-8 mr-8">
<p>Savoir un peu coder en python.</p>
</div></div>
<h3>Sommaire</h3>
<ol>
<li>Qu'est-ce que le Machine Learning ?</li>
<li>Début de l'apprentissage avec Kaggle.</li>
<li>Résolution de problèmes classiques à l'aide du ML.</li>
</ol>
<h3>Qu'est-ce que le Machine Learning</h3>
<p>Le Machine Learning est une sous-discipline de l'intelligence artificielle qui permet le développement de techniques permettant aux ordinateurs d'apprendre à partir de certaines données. Son objectif principal est de créer des modèles capables de généraliser des schémas à partir de données passées afin de prendre des décisions ou de faire des prédictions sur de nouvelles données sans être explicitement programmés.</p>
<h5>Les différentes étapes</h5>
<ol>
<li><strong>Entrainement : </strong> Un modèle de Machine Learning est formé à l'aide d'un sensemble de données d'entraînement. Ce jeu de données est composé d'exemples, généralement sous la forme de paires d'entrées et de résultats attendus.</li>
<li><strong>Modèle : </strong> Un modèle de Machine Learning est une représentation mathématique ou statistique qui capture les relations entre les entrées eet les sorties dans les données d'entrainement. Le modèle est ajusté pendant le processus d'entraînement pour minimiser les erreurs entre les prédictions et les résultats réels.</li>
<li><strong>Prédiction : </strong> Une fois que le modèle a été entrainé, il peut être utilisé pour faire des prédictions sur de nouvelles données pour lesquelles les résultats ne sont pas connus.</li>
<li><strong>Evaluation : </strong> Une fois le modèle entraîné, il est évaluer sur des données de validations qu'il n'a pas vu avant pour s'assurer de sa capacité à généraliser correctement et à faire des prédictions précises.</li>
</ol>
<h5>Types de Machine Learning</h5>
<p>Il existe plusieurs types de Machine Learning :</p>
<ul>
<li><strong>Apprentissage supervisé : </strong> Le modèle est formé sur un ensemble de données qui contient à la fois des entrées et des résultats attendus. Le modèle apprend à faire des prédictions en se basant sur cette corresponsance entre les entrées et les sorties.</li>
<li><strong>Apprentissage non supervisé : </strong> Le modèle est formé sur un ensemble de données qui ne contient que des entrées, sans indications sur les résultats attendus. Le modèle cherche à découvrir des structures ou des patterns intrinsèques aux données.</li>
<li><strong>Apprentissage par renforcement : </strong> Le modèle apprend à prendre des décisions en interagissant avec un environnement. Il reçoit des récompenses ou des pénalités en fonction des actions qu'il entreprend, ce qui lui permet d'ajuster son comportement au fil du temps.</li>
</ul>
<h5>Comprendre le fonctionnement du Machine Learning</h5>
<p>Pour cette partie j'ai surtout regardé les vidéos de la chaîne <a href="https://www.youtube.com/c/machinelearnia">Machine Learnia</a> au sujet du Machine Learning. J'ai commencé par la playlist <a href="https://www.youtube.com/playlist?list=PLO_fdPEVlfKqUF5BPKjGSh7aV9aBshrpY">Initiation au Machine Learning</a> pour continuer avec <a href="https://www.youtube.com/watch?v=82KLS2C_gNQ&amp;list=PLO_fdPEVlfKqMDNmCFzQISI2H_nJcEDJq">Python Spécial Machine Learning</a> à partir de la 20ème vidéo (avant les vidéos ne concerne pas vraiment le ML mais des bibliothèques python tel que Pandas et Matplotlib qui sont important pour traiter le ML).</p>
<p>Concrétement voici comment procédé lorsque l'on veut faire du Machine Learning avec Python :</p>
<h5>Importer les bibliothèques nécessaires</h5>
<p>Avant de commencer, il est nécessaire <strong>d'importer les bibliothèques nécessaires</strong>, y compris scikit-learn pour les algorithmes de machine learning.</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">import pandas as pd 
import seaborn as sns
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_val_score
from sklearn.neighbors import KNeighborsClassifier
</code></pre>
<h5>Charger les données</h5>
<p>Pour avoir avoir accès aux données on utilise la fonction suivante :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">data = pd.read_csv('chemin/vers/votre/fichier.csv')
</code></pre>
<h5>Explorez les données pour mieux les comprendre</h5>
<p>Il est important de connaitre <strong>la structure des données</strong> que l'on a à disposition avant de se lancer dans les opérations de ML, pour ça on utilise ces trois fonctions :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">print(data.head())
</code></pre>
<p>Cette fonction permt de retrouner les informations suivantes :</p>
<div stype="display:flex"><img src="datahead.png"></div>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">print(data.info())
</code></pre>
<p>Cette fonction permt de retrouner les informations suivantes :</p>
<div stype="display:flex"><img src="datainfo.png"></div>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">print(data.describe())
</code></pre>
<p>Cette fonction permet de retrouner les informations suivantes :</p>
<div stype="display:flex"><img src="datadescribes.png"></div>
<h5>Traitement des données</h5>
<p>Pour ne pas amoindrir l'efficacité de notre modèle il est important de vérifier que les données ont du sens et d'éliminer celles dont des informations primordiales manquent ou semble trop extrême.
Pour cela on utilise la fonction suivante :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">data = data.dropna()
</code></pre>
<h5>Séparation des données</h5>
<p>On va diviser les données en deux ensembles : un ensemble d'entrainement et un ensemble de test.</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">X = data.drop('variable_cible', axis=1)
y = data['variable_cible']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
</code></pre>
<p>Une fois que la fonction <em>train_test_split</em> est utilisée, elle génère deux ensembles distincts : l'ensemble d'entraînement (train) et l'ensemble de test. Ce découpage des données offre la possibilité <strong>d'évaluer un modèle de Machine Learning sous deux perspectives distinctes.</strong></p>
<p>Initialement, le modèle est formé en utilisant <strong>l'ensemble d'entraînement </strong> fourni par la fonction. Ensuite, ses capacités prédictives sont évaluées en utilisant <strong>l'ensemble de test </strong>également fourni par la fonction. Cette approche permet de tester la performance du modèle sur des données qu'il n'a pas vues pendant l'entraînement, offrant ainsi un aperçu de sa généralisation à de nouvelles données.</p>
<h5>Normalisation/Standardisation des données</h5>
<p>Cette étape n'est pas obligatoire mais elle peut permettre de gagner quelques pourcentage en plus leur de l'évaluation de notre modèle.  Elle vise à mettre toutes les variables (features) des données sur une échelle commune, ce qui peut être particulièrement important pour certains algorithmes et modèles.</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)
</code></pre>
<p>Globalement normaliser ou standardiser les données à pour but de <strong>garantir que le modèle utilisé fonctionne de manière optimale</strong>, en particulière lorsque l'on travaille avec des <strong>algortihmes sensibles aux échelles des variables</strong>. Le choix entre la normalisation et la standardisation dépend du contaxte spécifique des données utilisées et des exigences associées au modèle utilisé.</p>
<h5>Choix du modèle</h5>
<p>Dans cette étape on décide du modèle que l'on va utiliser en fonction de nos données.
Les modèles de machine learning sont classés en différentes catégories en fonction du type de données sur lesquelles ils sont appliqués et du type de tâche qu'ils accomplissent. On utilise donc pas le même modèle pour chaque problématique. Les deux plus simples à comprendre sont :</p>
<ul>
<li>Modèles de <strong>Régression</strong> : <em>Utilisés lorsque la variable cible (output) est continue.</em></li>
</ul>
<p>Par exemple on peut utiliser le modèle <em>LinearRegression</em> qui permet de modéliser la relation linéaire entre une variable dépendante et une variable indépendante. Il existe aussi des modèles de régression linéaire multiple, polynomiale et encore bien d'autres...</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">from sklearn.linear_model import LinearRegression
model = LinearRegression()
</code></pre>
<ul>
<li>Modèles de <strong>Classification</strong> : <em>Utilisés lorsque la variable cible est une classe ou une catégorie.</em></li>
</ul>
<p>Dans cette catégorie de modèle on retrouve plusieurs modèles. Par exemple le modèle <em>KNeighborsClassifier</em> regarde les plus proches voisins (le nombre est déterminer en hyperparamètre <em>n_neighbors</em>) de l'élément qu'il souhaite classer et choisis la catégorie à la majorité. Tandis que le modèle <em>RandomForestClassifier</em> fonctionne à l'aide d'arbre de décision dont les dernières feuilles sont les différentes catégories possibles. Il existe encore tout plein d'autres modèle dans la même catégorie mais qui ne fonctionne pas de la même manière et à chaque problème un modèle est plus adapté qu'un autre.</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier()

from sklearn.neighbors import KNeighborsClassifier
model = KNeighborsClassifier(n_neighbors=5)

</code></pre>
<h5>Entraînement du modèle</h5>
<p>Ici, on va <strong>entrainer notre modèle</strong> sur l'ensemble des données d'entrainements qu'on a déterminer lors de la séparation des données. Pour ce faire on utilise la fonction suivante :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">model.fit(X_train, y_train)
</code></pre>
<h5>Evaluation du modèle</h5>
<p>Une fois notre modèle entraîné on va s'intéresser à <strong>ces performances sur des données qu'il n'a jamais vu </strong> (l'ensemble des données test). Concrétement on veut répondre à la question &quot;A-t-il bien appris ?&quot;. Pour ce faire on utilise la fonction suivante :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">y_pred = model.predict(X_test)
print("Accuracy:", accuracy_score(y_test, y_pred))
print("Confusion Matrix:\n", confusion_matrix(y_test, y_pred))
print("Classification Report:\n", classification_report(y_test, y_pred))
</code></pre>
<h5>Cross-Validation</h5>
<p>La Cross-Validation permet de <strong>s'assurer de la stabilité du modèle</strong>. Elle permet d'évaluer la performance d'un modèle sur un ensemble de données de manière plus robuste que l'utilisation d'une seule division en ensemble d'entraînement et ensemble de test. Elle aide à <strong>estimer comment le modèle généralise aux données non vues</strong>. La procédure de validation croisée implique de diviser l'ensemble de données en plusieurs sous-ensembles, puis de former et évaluer le modèle plusieurs fois. Il existe différentes variantes de la validation croisée, la plus courante étant la validation croisée k-fold. Elle fonctionne de cette façon :</p>
<ul>
<li><strong>Division en k-Folds : </strong>
L'ensemble de données est divisé en k sous-ensembles (ou &quot;folds&quot;) de taille égale.</li>
<li><strong>Itérations : </strong>
Pour chaque itération, l'un des k sous-ensembles est utilisé comme ensemble de test, tandis que les k-1 autres sous-ensembles sont utilisés comme ensemble d'entraînement.</li>
<li><strong>Entraînement et Évaluation : </strong>
Le modèle est formé sur l'ensemble d'entraînement et évalué sur l'ensemble de test.</li>
<li><strong>Répétition : </strong>
Ces étapes sont répétées k fois, chaque sous-ensemble étant utilisé comme ensemble de test exactement une fois.</li>
<li><strong>Moyenne des Performances : </strong>
Les performances (mesures d'évaluation telles que la précision, le F-score, etc.) de chaque itération sont généralement moyennées pour obtenir une estimation plus stable et représentative de la performance du modèle.</li>
</ul>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">cv_scores = cross_val_score(model, X, y, cv=5)
print("Cross-Validation Scores:", cv_scores)
print("Mean CV Score:", cv_scores.mean())
</code></pre>
<h5>Optimisation des hyperparamètres du modèle</h5>
<p>On a vu que les modèles peuvent avoir des <strong>hyperparramètres</strong>. En fonction de leur valeur, le modèle est plus ou moins efficace, le but est donc de trouver les hyperparamètres optimaux pour que notre modèle soit le plus précis possible.
Pour ça on utilise la fonction suivante à adapter en fonction des hyperparamètres de notre modèle :</p>
<pre class="language-html " style="counter-reset: linenumber 0"><code class="language-html">from sklearn.model_selection import GridSearchCV

param_grid = {'n_estimators': [50, 100, 200], 'max_depth': [None, 10, 20]}
grid_search = GridSearchCV(RandomForestClassifier(), param_grid, cv=5)
grid_search.fit(X, y)
best_model = grid_search.best_estimator_
</code></pre>
<h3>Apprentissage avec Kaggle</h3>
<p>J'ai tout d'abord suivi le cours <strong><em>Learn Intro to Machine Learning</em></strong> sur la plateforme <a href="https://www.kaggle.com/">Kaggle</a>. Puis je me suis lancé dans le challenge <em>House Price Prediction</em> sur ce Jupyter Notebook <a href="MONMachineLearning.ipynb">MON : Machine Learning</a>.
J'ai essayé plusieurs modèles d'abord un peu naïvement puis en cherchant à avoir les meilleurs hyperparamètres possibles. J'ai obtenue les résultats suivants :</p>
<table>
<thead>
<tr>
<th>Modèle</th>
<th>Erreur absolue minimale</th>
</tr>
</thead>
<tbody>
<tr>
<td>DesicionTreeRegressor</td>
<td>26322 €</td>
</tr>
<tr>
<td>RandomForestRegressor</td>
<td>19655 €</td>
</tr>
<tr>
<td>GradientBoostingRegressor</td>
<td>21205 €</td>
</tr>
</tbody>
</table>
<p>La moyenne des prix des maisons étant de 180 921 € la meilleur erreure que j'ai obtenue est d'environ 10.87%.
Pour un premier travail sur le Machine Learning c'est une erreur qui me semble correcte même si on peut surement descendre en dessous.</p>
<h3>Horodateur</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Heures passées</th>
<th>Indications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Vendredi 17/11</td>
<td>1H</td>
<td>Choix des sources/cours à suivre et début de l'apprentissage</td>
</tr>
<tr>
<td>Dimanche 20/11</td>
<td>1H</td>
<td>Kaggle : <em>Learn Intro to Machine Learning</em></td>
</tr>
<tr>
<td>Lundi 21/11</td>
<td>1H30</td>
<td>Videos Explicatives de Machine Learnia : <em>Machine Learning Formation Complète</em> Partie 1</td>
</tr>
<tr>
<td>Vendredi 24/11</td>
<td>2H30</td>
<td>Videos Explicatives de Machine Learnia : <em>Machine Learning Formation Complète</em> Partie 2 + <em>Python Spécial Machine Learning</em> Vidéo 20, 21 et 22</td>
</tr>
<tr>
<td>Jeudi 30/11</td>
<td>3H</td>
<td>Exercice House Pricing avec différents modèles</td>
</tr>
<tr>
<td>Jeudi 7/11</td>
<td>2H</td>
<td>Finalisation House Pricing</td>
</tr>
</tbody>
</table>


</article>

        </main>


        <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        <span style="font-family: Consolas, sans-serif;">Do_<span style="color: #4a86e8">It</span></span> : Développent et Organisation en IT
                    </p>
                </div>
            </div>
        </footer>

        <script>
        MathJax
            .startup
            .document
            .getMathItemsWithin(document.body);
        </script>

    </body>
</html>
